<!DOCTYPE html>
<!-- Generated by Cython 0.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21</p>
<p>Raw output: <a href="resonance.c">resonance.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: import cython</pre>
<pre class='cython code score-11'>  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+003: import rmgpy.molecule.generator as generator</pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_molecule_generator, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_generator, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+004: import rmgpy.molecule.parser as parser</pre>
<pre class='cython code score-16'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_molecule_parser, __pyx_t_4, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_parser, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;005: </pre>
<pre class='cython line score-25' onclick='toggleDiv(this)'>+006: from .graph import Vertex, Edge, Graph, getVertexConnectivityValue</pre>
<pre class='cython code score-25'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Vertex);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_Vertex);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Vertex);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Edge);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_Edge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Edge);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Graph);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_Graph);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Graph);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_getVertexConnectivityValue);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_getVertexConnectivityValue);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_getVertexConnectivityValue);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_graph, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_getVertexConnectivityValue);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_getVertexConnectivityValue, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-15' onclick='toggleDiv(this)'>+007: from .molecule import Atom, Bond, Molecule</pre>
<pre class='cython code score-15'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Atom);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_Atom);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Atom);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Bond);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_n_s_Bond);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Bond);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Molecule);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_n_s_Molecule);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Molecule);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_molecule, __pyx_t_4, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+008: import rmgpy.molecule.pathfinder as pathfinder</pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_molecule_pathfinder, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pathfinder, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;009: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+010: def generateResonanceIsomers(mol):</pre>
<pre class='cython code score-19'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_1generateResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generateResonanceIsomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_isomers = 0;
  PyObject *__pyx_v_newIsomers = 0;
  int __pyx_v_index;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_newIsomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isom = 0;
  PyObject *__pyx_v_algo = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_newIsomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_newIsomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_algo);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_1generateResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_generateResonanceIsomers[] = "\n    Generate and return all of the resonance isomers of this molecule.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_1generateResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateResonanceIsomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_generateResonanceIsomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_generateResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateResonanceIsomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generateResonanceIsomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;011:     """</pre>
<pre class='cython line score-0'>&#xA0;012:     Generate and return all of the resonance isomers of this molecule.</pre>
<pre class='cython line score-0'>&#xA0;013:     """</pre>
<pre class='cython line score-0'>&#xA0;014:     cython.declare(isomers=list, newIsomers=list, index=cython.int, atom=Atom)</pre>
<pre class='cython line score-0'>&#xA0;015:     cython.declare(isomer=Molecule, newIsomer=Molecule, isom=Molecule)</pre>
<pre class='cython line score-0'>&#xA0;016: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+017:     isomers = [mol]</pre>
<pre class='cython code score-7'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_mol));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_mol));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_mol));
  __pyx_v_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;018: </pre>
<pre class='cython line score-0'>&#xA0;019:     # Iterate over resonance isomers</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+020:     index = 0</pre>
<pre class='cython code score-0'>  __pyx_v_index = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+021:     while index &lt; len(isomers):</pre>
<pre class='cython code score-1'>  while (1) {
    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_isomers);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = ((__pyx_v_index &lt; __pyx_t_2) != 0);
    if (!__pyx_t_3) break;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+022:         isomer = isomers[index]</pre>
<pre class='cython code score-5'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomers, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;023: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+024:         newIsomers = []</pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_newIsomers, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+025:         for algo in populate_resonance_generation_algorithm():</pre>
<pre class='cython code score-13'>    __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_populate_resonance_generation_algorithm(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(__pyx_t_1 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_algo, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+026:             newIsomers.extend(algo(isomer))</pre>
<pre class='cython code score-28'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_algo);
      __pyx_t_5 = __pyx_v_algo; __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_isomer));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, ((PyObject *)__pyx_v_isomer));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_isomer));
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v_newIsomers, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;027: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+028:         for newIsomer in newIsomers:</pre>
<pre class='cython code score-9'>    __pyx_t_4 = __pyx_v_newIsomers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    for (;;) {
      if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_newIsomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_1));
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;029:             # Append to isomer list if unique</pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+030:             for isom in isomers:</pre>
<pre class='cython code score-9'>      __pyx_t_1 = __pyx_v_isomers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
      for (;;) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
        if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_5));
        __pyx_t_5 = 0;
/* … */
      }
      /*else*/ {
/* … */
      __pyx_L10_break:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+031:                 if isom.isIsomorphic(newIsomer):</pre>
<pre class='cython code score-0'>        __pyx_t_3 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isom-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.isIsomorphic(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_isom), ((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_newIsomer), 0, NULL);<span class='error_goto'> if (unlikely(__pyx_t_3 == -2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = (__pyx_t_3 != 0);
        if (__pyx_t_10) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+032:                     break</pre>
<pre class='cython code score-0'>          goto __pyx_L10_break;
        }
</pre><pre class='cython line score-0'>&#xA0;033:             else:</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+034:                 isomers.append(newIsomer)</pre>
<pre class='cython code score-2'>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_newIsomer));<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
</pre><pre class='cython line score-0'>&#xA0;035: </pre>
<pre class='cython line score-0'>&#xA0;036:         # Move to next resonance isomer</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+037:         index += 1</pre>
<pre class='cython code score-0'>    __pyx_v_index = (__pyx_v_index + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;038: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+039:     return isomers</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomers);
  __pyx_r = __pyx_v_isomers;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;040: </pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+041: def generateAdjacentResonanceIsomers(mol):</pre>
<pre class='cython code score-28'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_3generateAdjacentResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generateAdjacentResonanceIsomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_isomers = 0;
  PyObject *__pyx_v_paths = 0;
  int __pyx_v_index;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom1 = 0;
  CYTHON_UNUSED struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom2 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom3 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *__pyx_v_bond12 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *__pyx_v_bond23 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v2 = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateAdjacentResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateAdjacentResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_paths);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bond12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bond23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_3generateAdjacentResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_2generateAdjacentResonanceIsomers[] = "\n    Generate all of the resonance isomers formed by one allyl radical shift.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_3generateAdjacentResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateAdjacentResonanceIsomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_2generateAdjacentResonanceIsomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_2generateAdjacentResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateAdjacentResonanceIsomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generateAdjacentResonanceIsomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateAdjacentResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;042:     """</pre>
<pre class='cython line score-0'>&#xA0;043:     Generate all of the resonance isomers formed by one allyl radical shift.</pre>
<pre class='cython line score-0'>&#xA0;044:     """</pre>
<pre class='cython line score-0'>&#xA0;045:     cython.declare(isomers=list, paths=list, index=cython.int, isomer=Molecule)</pre>
<pre class='cython line score-0'>&#xA0;046:     cython.declare(atom=Atom, atom1=Atom, atom2=Atom, atom3=Atom, bond12=Bond, bond23=Bond)</pre>
<pre class='cython line score-0'>&#xA0;047:     cython.declare(v1=Vertex, v2=Vertex)</pre>
<pre class='cython line score-0'>&#xA0;048: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+049:     isomers = []</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;050: </pre>
<pre class='cython line score-0'>&#xA0;051:     # Radicals</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+052:     if mol.isRadical():</pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;isRadical(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == -2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;053:         # Iterate over radicals in structure</pre>
<pre class='cython line score-14' onclick='toggleDiv(this)'>+054:         for atom in mol.vertices:</pre>
<pre class='cython code score-14'>    if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_v_mol-&gt;__pyx_base.vertices; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    for (;;) {
      if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_5));
      __pyx_t_5 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+055:             paths = pathfinder.findAllDelocalizationPaths(atom)</pre>
<pre class='cython code score-40'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pathfinder);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_findAllDelocalizationPaths);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_atom));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_atom));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, ((PyObject *)__pyx_v_atom));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_atom));
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_paths, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-81' onclick='toggleDiv(this)'>+056:             for atom1, atom2, atom3, bond12, bond23 in paths:</pre>
<pre class='cython code score-81'>      if (unlikely(__pyx_v_paths == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_5 = __pyx_v_paths; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9 = 0;
      for (;;) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
          PyObject* sequence = __pyx_t_7;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
          #endif
          if (unlikely(size != 5)) {
            if (size &gt; 5) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(5);
            else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
            __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
            __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
            __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
          } else {
            __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
            __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
            __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
            __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          #else
          {
            Py_ssize_t i;
            PyObject** temps[5] = {&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
            for (i=0; i &lt; 5; i++) {
              PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(item);
              *(temps[i]) = item;
            }
          }
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        } else {
          Py_ssize_t index = -1;
          PyObject** temps[5] = {&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
          __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_14 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
          for (index=0; index &lt; 5; index++) {
            PyObject* item = __pyx_t_14(__pyx_t_13); if (unlikely(!item)) goto __pyx_L8_unpacking_failed;
            <span class='refnanny'>__Pyx_GOTREF</span>(item);
            *(temps[index]) = item;
          }
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_13), 5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_14 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          goto __pyx_L9_unpacking_done;
          __pyx_L8_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_14 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_L9_unpacking_done:;
        }
        if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        if (!(likely(((__pyx_t_10) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_10, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5rmgpy_8molecule_8molecule_Bond))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        if (!(likely(((__pyx_t_12) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_12, __pyx_ptype_5rmgpy_8molecule_8molecule_Bond))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom1, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_8));
        __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom2, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_6));
        __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom3, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_10));
        __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bond12, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *)__pyx_t_11));
        __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bond23, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *)__pyx_t_12));
        __pyx_t_12 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;057:                 # Adjust to (potentially) new resonance isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+058:                 atom1.decrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;decrementRadical(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+059:                 atom3.incrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;incrementRadical(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+060:                 bond12.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+061:                 bond23.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond23-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond23, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;062:                 # Make a copy of isomer</pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+063:                 isomer = mol.copy(deep=True)</pre>
<pre class='cython code score-3'>        __pyx_t_15.__pyx_n = 1;
        __pyx_t_15.deep = 1;
        __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_mol), 0, &amp;__pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_7));
        __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;064:                 # Also copy the connectivity values, since they are the same</pre>
<pre class='cython line score-0'>&#xA0;065:                 # for all resonance forms</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+066:                 for index in range(len(mol.vertices)):</pre>
<pre class='cython code score-8'>        __pyx_t_7 = __pyx_v_mol-&gt;__pyx_base.vertices;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        if (unlikely(__pyx_t_7 == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_16 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
          __pyx_v_index = __pyx_t_17;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+067:                     v1 = mol.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_mol-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v1, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_7));
          __pyx_t_7 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+068:                     v2 = isomer.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_isomer-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomer-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v2, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_7));
          __pyx_t_7 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+069:                     v2.connectivity1 = v1.connectivity1</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity1;
          __pyx_v_v2-&gt;connectivity1 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+070:                     v2.connectivity2 = v1.connectivity2</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity2;
          __pyx_v_v2-&gt;connectivity2 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+071:                     v2.connectivity3 = v1.connectivity3</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity3;
          __pyx_v_v2-&gt;connectivity3 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+072:                     v2.sortingLabel = v1.sortingLabel</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;sortingLabel;
          __pyx_v_v2-&gt;sortingLabel = __pyx_t_18;
        }
</pre><pre class='cython line score-0'>&#xA0;073:                 # Restore current isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+074:                 atom1.incrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;incrementRadical(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+075:                 atom3.decrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;decrementRadical(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+076:                 bond12.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+077:                 bond23.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond23-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond23, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;078:                 # Append to isomer list if unique</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+079:                 isomer.updateAtomTypes()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isomer-&gt;__pyx_base.__pyx_vtab)-&gt;updateAtomTypes(__pyx_v_isomer, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+080:                 isomers.append(isomer)</pre>
<pre class='cython code score-2'>        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(__pyx_t_19 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;081: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+082:     return isomers</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomers);
  __pyx_r = __pyx_v_isomers;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;083: </pre>
<pre class='cython line score-22' onclick='toggleDiv(this)'>+084: def generateLonePairRadicalResonanceIsomers(mol):</pre>
<pre class='cython code score-22'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_5generateLonePairRadicalResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generateLonePairRadicalResonanceIsomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_isomers = 0;
  PyObject *__pyx_v_paths = 0;
  int __pyx_v_index;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom2 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v2 = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateLonePairRadicalResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateLonePairRadicalResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_paths);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_5generateLonePairRadicalResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_4generateLonePairRadicalResonanceIsomers[] = "\n    Generate all of the resonance isomers formed by lone electron pair - radical shifts.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_5generateLonePairRadicalResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateLonePairRadicalResonanceIsomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_4generateLonePairRadicalResonanceIsomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_4generateLonePairRadicalResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateLonePairRadicalResonanceIsomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generateLonePairRadicalResonanceIsomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateLonePairRadicalResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;085:     """</pre>
<pre class='cython line score-0'>&#xA0;086:     Generate all of the resonance isomers formed by lone electron pair - radical shifts.</pre>
<pre class='cython line score-0'>&#xA0;087:     """</pre>
<pre class='cython line score-0'>&#xA0;088:     cython.declare(isomers=list, paths=list, index=cython.int, isomer=Molecule)</pre>
<pre class='cython line score-0'>&#xA0;089:     cython.declare(atom=Atom, atom1=Atom, atom2=Atom)</pre>
<pre class='cython line score-0'>&#xA0;090:     cython.declare(v1=Vertex, v2=Vertex)</pre>
<pre class='cython line score-0'>&#xA0;091: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+092:     isomers = []</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;093: </pre>
<pre class='cython line score-0'>&#xA0;094:     # Radicals</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+095:     if mol.isRadical():</pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;isRadical(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == -2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0'>&#xA0;096:         # Iterate over radicals in structure</pre>
<pre class='cython line score-14' onclick='toggleDiv(this)'>+097:         for atom in mol.vertices:</pre>
<pre class='cython code score-14'>    if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_v_mol-&gt;__pyx_base.vertices; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    for (;;) {
      if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_5));
      __pyx_t_5 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+098:             paths = pathfinder.findAllDelocalizationPathsLonePairRadical(atom)</pre>
<pre class='cython code score-40'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pathfinder);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_findAllDelocalizationPathsLonePa);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, ((PyObject *)__pyx_v_atom));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_atom));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, ((PyObject *)__pyx_v_atom));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_atom));
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_paths, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-64' onclick='toggleDiv(this)'>+099:             for atom1, atom2 in paths:</pre>
<pre class='cython code score-64'>      if (unlikely(__pyx_v_paths == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_5 = __pyx_v_paths; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9 = 0;
      for (;;) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
          PyObject* sequence = __pyx_t_7;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
            else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          } else {
            __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          #else
          __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_11 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
          index = 0; __pyx_t_8 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L8_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          index = 1; __pyx_t_6 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_6)) goto __pyx_L8_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_10), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_11 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          goto __pyx_L9_unpacking_done;
          __pyx_L8_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_11 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_L9_unpacking_done:;
        }
        if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom1, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_8));
        __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom2, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_6));
        __pyx_t_6 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;100:                 # Adjust to (potentially) new resonance isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+101:                 atom1.decrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;decrementRadical(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+102:                 atom1.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+103:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+104:                 atom2.incrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;incrementRadical(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+105:                 atom2.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+106:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;107:                 # Make a copy of isomer</pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+108:                 isomer = mol.copy(deep=True)</pre>
<pre class='cython code score-3'>        __pyx_t_12.__pyx_n = 1;
        __pyx_t_12.deep = 1;
        __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_mol), 0, &amp;__pyx_t_12));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_7));
        __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;109:                 # Also copy the connectivity values, since they are the same</pre>
<pre class='cython line score-0'>&#xA0;110:                 # for all resonance forms</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+111:                 for index in range(len(mol.vertices)):</pre>
<pre class='cython code score-8'>        __pyx_t_7 = __pyx_v_mol-&gt;__pyx_base.vertices;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        if (unlikely(__pyx_t_7 == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_13 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_index = __pyx_t_14;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+112:                     v1 = mol.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_mol-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v1, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_7));
          __pyx_t_7 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+113:                     v2 = isomer.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_isomer-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomer-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v2, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_7));
          __pyx_t_7 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+114:                     v2.connectivity1 = v1.connectivity1</pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_v1-&gt;connectivity1;
          __pyx_v_v2-&gt;connectivity1 = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+115:                     v2.connectivity2 = v1.connectivity2</pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_v1-&gt;connectivity2;
          __pyx_v_v2-&gt;connectivity2 = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+116:                     v2.connectivity3 = v1.connectivity3</pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_v1-&gt;connectivity3;
          __pyx_v_v2-&gt;connectivity3 = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+117:                     v2.sortingLabel = v1.sortingLabel</pre>
<pre class='cython code score-0'>          __pyx_t_15 = __pyx_v_v1-&gt;sortingLabel;
          __pyx_v_v2-&gt;sortingLabel = __pyx_t_15;
        }
</pre><pre class='cython line score-0'>&#xA0;118:                 # Restore current isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+119:                 atom1.incrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;incrementRadical(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+120:                 atom1.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+121:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+122:                 atom2.decrementRadical()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;decrementRadical(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+123:                 atom2.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+124:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;125:                 # Append to isomer list if unique</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+126:                 isomer.updateAtomTypes()</pre>
<pre class='cython code score-1'>        __pyx_t_7 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isomer-&gt;__pyx_base.__pyx_vtab)-&gt;updateAtomTypes(__pyx_v_isomer, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+127:                 isomers.append(isomer)</pre>
<pre class='cython code score-2'>        __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;128: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+129:     return isomers</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomers);
  __pyx_r = __pyx_v_isomers;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;130: </pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+131: def generateN5dd_N5tsResonanceIsomers(mol):</pre>
<pre class='cython code score-30'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_7generateN5dd_N5tsResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generateN5dd_N5tsResonanceIsomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_isomers = 0;
  PyObject *__pyx_v_paths = 0;
  int __pyx_v_index;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom2 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom3 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *__pyx_v_bond12 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *__pyx_v_bond13 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *__pyx_v_v2 = 0;
  PyObject *__pyx_v_direction = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateN5dd_N5tsResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateN5dd_N5tsResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_paths);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bond12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bond13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_v2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_direction);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_7generateN5dd_N5tsResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_6generateN5dd_N5tsResonanceIsomers[] = "\n    Generate all of the resonance isomers formed by shifts between N5dd and N5ts.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_7generateN5dd_N5tsResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateN5dd_N5tsResonanceIsomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_6generateN5dd_N5tsResonanceIsomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_6generateN5dd_N5tsResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateN5dd_N5tsResonanceIsomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generateN5dd_N5tsResonanceIsomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateN5dd_N5tsResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;132:     """</pre>
<pre class='cython line score-0'>&#xA0;133:     Generate all of the resonance isomers formed by shifts between N5dd and N5ts.</pre>
<pre class='cython line score-0'>&#xA0;134:     """</pre>
<pre class='cython line score-0'>&#xA0;135:     cython.declare(isomers=list, paths=list, index=cython.int, isomer=Molecule)</pre>
<pre class='cython line score-0'>&#xA0;136:     cython.declare(atom=Atom, atom1=Atom, atom2=Atom, atom3=Atom)</pre>
<pre class='cython line score-0'>&#xA0;137:     cython.declare(bond12=Bond, bond13=Bond)</pre>
<pre class='cython line score-0'>&#xA0;138:     cython.declare(v1=Vertex, v2=Vertex)</pre>
<pre class='cython line score-0'>&#xA0;139: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+140:     isomers = []</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;141: </pre>
<pre class='cython line score-0'>&#xA0;142:     # Iterate over nitrogen atoms in structure</pre>
<pre class='cython line score-14' onclick='toggleDiv(this)'>+143:     for atom in mol.vertices:</pre>
<pre class='cython code score-14'>  if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_v_mol-&gt;__pyx_base.vertices; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_3));
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+144:         paths = pathfinder.findAllDelocalizationPathsN5dd_N5ts(atom)</pre>
<pre class='cython code score-40'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pathfinder);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_findAllDelocalizationPathsN5dd_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_atom));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_atom));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_atom));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_atom));
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_3)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_paths, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class='cython line score-85' onclick='toggleDiv(this)'>+145:         for atom1, atom2, atom3, bond12, bond13, direction in paths:</pre>
<pre class='cython code score-85'>    if (unlikely(__pyx_v_paths == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_3 = __pyx_v_paths; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_7++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        PyObject* sequence = __pyx_t_5;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 6)) {
          if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
          __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        } else {
          __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
          __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        #else
        {
          Py_ssize_t i;
          PyObject** temps[6] = {&amp;__pyx_t_6,&amp;__pyx_t_4,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11};
          for (i=0; i &lt; 6; i++) {
            PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(item);
            *(temps[i]) = item;
          }
        }
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else {
        Py_ssize_t index = -1;
        PyObject** temps[6] = {&amp;__pyx_t_6,&amp;__pyx_t_4,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11};
        __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_13 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
        for (index=0; index &lt; 6; index++) {
          PyObject* item = __pyx_t_13(__pyx_t_12); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[index]) = item;
        }
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_12), 6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_13 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L8_unpacking_done;
        __pyx_L7_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_13 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L8_unpacking_done:;
      }
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5rmgpy_8molecule_8molecule_Bond))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (!(likely(((__pyx_t_10) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_10, __pyx_ptype_5rmgpy_8molecule_8molecule_Bond))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom1, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_6));
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom2, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_4));
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom3, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_8));
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bond12, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *)__pyx_t_9));
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bond13, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *)__pyx_t_10));
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_direction, __pyx_t_11);
      __pyx_t_11 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;146:             # from N5dd to N5ts</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+147:             if direction == 1:</pre>
<pre class='cython code score-8'>      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_direction, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_14 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_14) {
</pre><pre class='cython line score-0'>&#xA0;148:                 # Adjust to (potentially) new resonance isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+149:                 bond12.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+150:                 bond13.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond13-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond13, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+151:                 atom2.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+152:                 atom3.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+153:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+154:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+155:                 atom3.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;156:                 # Make a copy of isomer</pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+157:                 isomer = mol.copy(deep=True)</pre>
<pre class='cython code score-3'>        __pyx_t_15.__pyx_n = 1;
        __pyx_t_15.deep = 1;
        __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_mol), 0, &amp;__pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_5));
        __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;158:                 # Also copy the connectivity values, since they are the same</pre>
<pre class='cython line score-0'>&#xA0;159:                 # for all resonance forms</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+160:                 for index in range(len(mol.vertices)):</pre>
<pre class='cython code score-8'>        __pyx_t_5 = __pyx_v_mol-&gt;__pyx_base.vertices;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        if (unlikely(__pyx_t_5 == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_16 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
          __pyx_v_index = __pyx_t_17;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+161:                     v1 = mol.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_mol-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v1, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_5));
          __pyx_t_5 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+162:                     v2 = isomer.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_isomer-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomer-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v2, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_5));
          __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+163:                     v2.connectivity1 = v1.connectivity1</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity1;
          __pyx_v_v2-&gt;connectivity1 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+164:                     v2.connectivity2 = v1.connectivity2</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity2;
          __pyx_v_v2-&gt;connectivity2 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+165:                     v2.connectivity3 = v1.connectivity3</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity3;
          __pyx_v_v2-&gt;connectivity3 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+166:                     v2.sortingLabel = v1.sortingLabel</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;sortingLabel;
          __pyx_v_v2-&gt;sortingLabel = __pyx_t_18;
        }
</pre><pre class='cython line score-0'>&#xA0;167:                 # Restore current isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+168:                 bond12.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+169:                 bond13.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond13-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond13, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+170:                 atom2.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+171:                 atom3.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+172:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+173:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+174:                 atom3.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;175:                 # Append to isomer list if unique</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+176:                 isomer.updateAtomTypes()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isomer-&gt;__pyx_base.__pyx_vtab)-&gt;updateAtomTypes(__pyx_v_isomer, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+177:                 isomers.append(isomer)</pre>
<pre class='cython code score-2'>        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(__pyx_t_19 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L9;
      }
      __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;178: </pre>
<pre class='cython line score-0'>&#xA0;179:             # from N5ts to N5dd</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+180:             if direction == 2:</pre>
<pre class='cython code score-8'>      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_direction, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_14 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_14) {
</pre><pre class='cython line score-0'>&#xA0;181:                 # Adjust to (potentially) new resonance isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+182:                 bond12.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+183:                 bond13.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond13-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond13, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+184:                 atom2.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+185:                 atom3.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+186:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+187:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+188:                 atom3.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;189:                 # Make a copy of isomer</pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+190:                 isomer = mol.copy(deep=True)</pre>
<pre class='cython code score-3'>        __pyx_t_15.__pyx_n = 1;
        __pyx_t_15.deep = 1;
        __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_mol), 0, &amp;__pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_5));
        __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;191:                 # Also copy the connectivity values, since they are the same</pre>
<pre class='cython line score-0'>&#xA0;192:                 # for all resonance forms</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+193:                 for index in range(len(mol.vertices)):</pre>
<pre class='cython code score-8'>        __pyx_t_5 = __pyx_v_mol-&gt;__pyx_base.vertices;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        if (unlikely(__pyx_t_5 == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_16 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
          __pyx_v_index = __pyx_t_17;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+194:                     v1 = mol.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_mol-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_mol-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v1, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_5));
          __pyx_t_5 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+195:                     v2 = isomer.vertices[index]</pre>
<pre class='cython code score-10'>          if (unlikely(__pyx_v_isomer-&gt;__pyx_base.vertices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomer-&gt;__pyx_base.vertices, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_5graph_Vertex))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v2, ((struct __pyx_obj_5rmgpy_8molecule_5graph_Vertex *)__pyx_t_5));
          __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+196:                     v2.connectivity1 = v1.connectivity1</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity1;
          __pyx_v_v2-&gt;connectivity1 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+197:                     v2.connectivity2 = v1.connectivity2</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity2;
          __pyx_v_v2-&gt;connectivity2 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+198:                     v2.connectivity3 = v1.connectivity3</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;connectivity3;
          __pyx_v_v2-&gt;connectivity3 = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+199:                     v2.sortingLabel = v1.sortingLabel</pre>
<pre class='cython code score-0'>          __pyx_t_18 = __pyx_v_v1-&gt;sortingLabel;
          __pyx_v_v2-&gt;sortingLabel = __pyx_t_18;
        }
</pre><pre class='cython line score-0'>&#xA0;200:                 # Restore current isomer</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+201:                 bond12.incrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond12-&gt;__pyx_base.__pyx_vtab)-&gt;incrementOrder(__pyx_v_bond12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+202:                 bond13.decrementOrder()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Bond *)__pyx_v_bond13-&gt;__pyx_base.__pyx_vtab)-&gt;decrementOrder(__pyx_v_bond13, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+203:                 atom2.decrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;decrementLonePairs(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+204:                 atom3.incrementLonePairs()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;incrementLonePairs(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+205:                 atom1.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+206:                 atom2.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom2-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+207:                 atom3.updateCharge()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom3-&gt;__pyx_base.__pyx_vtab)-&gt;updateCharge(__pyx_v_atom3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;208:                 # Append to isomer list if unique</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+209:                 isomer.updateAtomTypes()</pre>
<pre class='cython code score-1'>        __pyx_t_5 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isomer-&gt;__pyx_base.__pyx_vtab)-&gt;updateAtomTypes(__pyx_v_isomer, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+210:                 isomers.append(isomer)</pre>
<pre class='cython code score-2'>        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(__pyx_t_19 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L12;
      }
      __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;211: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+212:     return isomers</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomers);
  __pyx_r = __pyx_v_isomers;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;213: </pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+214: def generateAromaticResonanceIsomers(mol):</pre>
<pre class='cython code score-36'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_9generateAromaticResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_8generateAromaticResonanceIsomers[] = "\n    Generate the aromatic form of the molecule.\n    \n    Returns it as a single element of a list.\n    If there's an error (eg. in RDKit) it just returns an empty list.\n    ";
static PyMethodDef __pyx_mdef_5rmgpy_8molecule_9resonance_9generateAromaticResonanceIsomers = {"generateAromaticResonanceIsomers", (PyCFunction)__pyx_pw_5rmgpy_8molecule_9resonance_9generateAromaticResonanceIsomers, METH_O, __pyx_doc_5rmgpy_8molecule_9resonance_8generateAromaticResonanceIsomers};
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_9generateAromaticResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateAromaticResonanceIsomers (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_8generateAromaticResonanceIsomers(__pyx_self, ((PyObject *)__pyx_v_mol));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_8generateAromaticResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_molecule = 0;
  PyObject *__pyx_v_rdAtomIndices = 0;
  int __pyx_v_aromatic;
  PyObject *__pyx_v_aromaticBonds = 0;
  PyObject *__pyx_v_rings = 0;
  PyObject *__pyx_v_ring0 = 0;
  int __pyx_v_i;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom1 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom2 = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *__pyx_v_bond = 0;
  PyObject *__pyx_v_BondType = NULL;
  PyObject *__pyx_v_AROMATIC = NULL;
  PyObject *__pyx_v_rdkitmol = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateAromaticResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateAromaticResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_molecule);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rdAtomIndices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aromaticBonds);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rings);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ring0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bond);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_BondType);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_AROMATIC);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rdkitmol);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_mol, __pyx_n_s_molecule, __pyx_n_s_rdAtomIndices, __pyx_n_s_aromatic, __pyx_n_s_aromaticBonds, __pyx_n_s_rings, __pyx_n_s_ring0, __pyx_n_s_i, __pyx_n_s_atom1, __pyx_n_s_atom2, __pyx_n_s_bond, __pyx_n_s_BondType, __pyx_n_s_AROMATIC, __pyx_n_s_rdkitmol);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_5rmgpy_8molecule_9resonance_9generateAromaticResonanceIsomers, 0, __pyx_n_s_generateAromaticResonanceIsomers, NULL, __pyx_n_s_rmgpy_molecule_resonance, __pyx_d, ((PyObject *)__pyx_codeobj__9));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_generateAromaticResonanceIsomers, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;215:     """</pre>
<pre class='cython line score-0'>&#xA0;216:     Generate the aromatic form of the molecule.</pre>
<pre class='cython line score-0'>&#xA0;217: </pre>
<pre class='cython line score-0'>&#xA0;218:     Returns it as a single element of a list.</pre>
<pre class='cython line score-0'>&#xA0;219:     If there's an error (eg. in RDKit) it just returns an empty list.</pre>
<pre class='cython line score-0'>&#xA0;220:     """</pre>
<pre class='cython line score-0'>&#xA0;221:     cython.declare(molecule=Molecule, rdAtomIndices=dict, aromatic=cython.bint, aromaticBonds=list)</pre>
<pre class='cython line score-0'>&#xA0;222:     cython.declare(rings=list, ring0=list, i=cython.int, atom1=Atom, atom2=Atom, bond=Bond)</pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+223:     from rdkit.Chem.rdchem import BondType</pre>
<pre class='cython code score-15'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_BondType);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_BondType);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_BondType);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rdkit_Chem_rdchem, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_BondType);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_BondType = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+224:     AROMATIC = BondType.AROMATIC</pre>
<pre class='cython code score-2'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_BondType, __pyx_n_s_AROMATIC);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_AROMATIC = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;225: </pre>
<pre class='cython line score-0'>&#xA0;226:     # Radicals</pre>
<pre class='cython line score-21' onclick='toggleDiv(this)'>+227:     if not mol.isCyclic():</pre>
<pre class='cython code score-21'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mol, __pyx_n_s_isCyclic);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = ((!__pyx_t_4) != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+228:         return []</pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;229: </pre>
<pre class='cython line score-18' onclick='toggleDiv(this)'>+230:     molecule = mol.copy(deep=True)</pre>
<pre class='cython code score-18'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mol, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_deep, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_molecule = ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;231: </pre>
<pre class='cython line score-0'>&#xA0;232:     # In RMG, only 6-member rings can be considered aromatic, so ignore all other rings</pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+233:     rings = [ring0 for ring0 in molecule.getSmallestSetOfSmallestRings() if len(ring0) == 6]</pre>
<pre class='cython code score-36'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_molecule-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.getSmallestSetOfSmallestRings(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_molecule), 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(__pyx_t_1 == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ring0, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
    if (unlikely(__pyx_v_ring0 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_7 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_ring0);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = ((__pyx_t_7 == 6) != 0);
    if (__pyx_t_5) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_v_ring0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_rings = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+234:     if not rings:</pre>
<pre class='cython code score-1'>  __pyx_t_5 = (__pyx_v_rings != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_rings) != 0);
  __pyx_t_4 = ((!__pyx_t_5) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+235:         return []</pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;236: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+237:     try:</pre>
<pre class='cython code score-0'>  {
    /*try:*/ {
</pre><pre class='cython line score-96' onclick='toggleDiv(this)'>+238:         rdkitmol, rdAtomIndices = generator.toRDKitMol(molecule, removeHs=False, returnMapping=True)</pre>
<pre class='cython code score-96'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generator);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_toRDKitMol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_molecule));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_v_molecule));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_molecule));
      __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_removeHs, Py_False) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_returnMapping, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
        PyObject* sequence = __pyx_t_11;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_12 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L16_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L16_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        __pyx_t_12 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L17_unpacking_done;
        __pyx_L16_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_12 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
        __pyx_L17_unpacking_done:;
      }
      if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_3)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L8_error;}</span>
      __pyx_v_rdkitmol = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_v_rdAtomIndices = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    goto __pyx_L15_try_end;
    __pyx_L8_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+239:     except ValueError:</pre>
<pre class='cython code score-9'>    __pyx_t_13 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_13) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateAromaticResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_11, &amp;__pyx_t_3, &amp;__pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+240:         return []</pre>
<pre class='cython code score-13'>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L10_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L11_except_return;
    }
    goto __pyx_L10_except_error;
    __pyx_L10_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
    goto __pyx_L1_error;
    __pyx_L11_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
    goto __pyx_L0;
    __pyx_L15_try_end:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+241:     aromatic = False</pre>
<pre class='cython code score-0'>  __pyx_v_aromatic = 0;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+242:     for ring0 in rings:</pre>
<pre class='cython code score-17'>  __pyx_t_1 = __pyx_v_rings; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6 = 0;
  for (;;) {
    if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_3)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ring0, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+243:         aromaticBonds = []</pre>
<pre class='cython code score-6'>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_aromaticBonds, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;244:         # Figure out which atoms and bonds are aromatic and reassign appropriately:</pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+245:         for i, atom1 in enumerate(ring0):</pre>
<pre class='cython code score-9'>    __pyx_t_13 = 0;
    __pyx_t_3 = __pyx_v_ring0; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_7++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom1, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_11));
      __pyx_t_11 = 0;
      __pyx_v_i = __pyx_t_13;
      __pyx_t_13 = (__pyx_t_13 + 1);
/* … */
    }
    /*else*/ {
/* … */
    __pyx_L23_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+246:             if not atom1.isCarbon():</pre>
<pre class='cython code score-0'>      __pyx_t_4 = ((!(((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Atom *)__pyx_v_atom1-&gt;__pyx_base.__pyx_vtab)-&gt;isCarbon(__pyx_v_atom1, 0) != 0)) != 0);
      if (__pyx_t_4) {
</pre><pre class='cython line score-0'>&#xA0;247:                 # all atoms in the ring must be carbon in RMG for our definition of aromatic</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+248:                 break</pre>
<pre class='cython code score-0'>        goto __pyx_L23_break;
      }
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+249:             for atom2 in ring0[i + 1:]:</pre>
<pre class='cython code score-17'>      if (unlikely(__pyx_v_ring0 == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyList_GetSlice</span>(__pyx_v_ring0, (__pyx_v_i + 1), PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_2 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      for (;;) {
        if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
        if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom2, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_11));
        __pyx_t_11 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+250:                 if molecule.hasBond(atom1, atom2):</pre>
<pre class='cython code score-0'>        __pyx_t_4 = (((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_molecule-&gt;__pyx_base.__pyx_vtab)-&gt;hasBond(__pyx_v_molecule, __pyx_v_atom1, __pyx_v_atom2, 0) != 0);
        if (__pyx_t_4) {
</pre><pre class='cython line score-58' onclick='toggleDiv(this)'>+251:                     if rdkitmol.GetBondBetweenAtoms(rdAtomIndices[atom1], rdAtomIndices[atom2]).GetBondType() is AROMATIC:</pre>
<pre class='cython code score-58'>          __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rdkitmol, __pyx_n_s_GetBondBetweenAtoms);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
          if (unlikely(__pyx_v_rdAtomIndices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_rdAtomIndices, ((PyObject *)__pyx_v_atom1));<span class='error_goto'> if (unlikely(__pyx_t_17 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
          if (unlikely(__pyx_v_rdAtomIndices == Py_None)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
            <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_rdAtomIndices, ((PyObject *)__pyx_v_atom2));<span class='error_goto'> if (unlikely(__pyx_t_18 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
          __pyx_t_19 = NULL;
          __pyx_t_20 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
            __pyx_t_19 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
            if (likely(__pyx_t_19)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_19);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
              __pyx_t_20 = 1;
            }
          }
          __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
          if (__pyx_t_19) {
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_19); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19); __pyx_t_19 = NULL;
          }
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+__pyx_t_20, __pyx_t_17);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1+__pyx_t_20, __pyx_t_18);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
          __pyx_t_17 = 0;
          __pyx_t_18 = 0;
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_GetBondType);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          __pyx_t_15 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
            __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
            if (likely(__pyx_t_15)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
            }
          }
          if (__pyx_t_15) {
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          } else {
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          __pyx_t_4 = (__pyx_t_11 == __pyx_v_AROMATIC);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_5 = (__pyx_t_4 != 0);
          if (__pyx_t_5) {
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+252:                         aromaticBonds.append(molecule.getBond(atom1, atom2))</pre>
<pre class='cython code score-3'>            __pyx_t_11 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_molecule-&gt;__pyx_base.__pyx_vtab)-&gt;getBond(__pyx_v_molecule, __pyx_v_atom1, __pyx_v_atom2, 0));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_aromaticBonds, __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_22 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            goto __pyx_L28;
          }
          __pyx_L28:;
          goto __pyx_L27;
        }
        __pyx_L27:;
</pre><pre class='cython line score-0'>&#xA0;253:         else:  # didn't break so all atoms are carbon</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+254:             if len(aromaticBonds) == 6:</pre>
<pre class='cython code score-1'>      __pyx_t_14 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_aromaticBonds);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_5 = ((__pyx_t_14 == 6) != 0);
      if (__pyx_t_5) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+255:                 aromatic = True</pre>
<pre class='cython code score-0'>        __pyx_v_aromatic = 1;
</pre><pre class='cython line score-0'>&#xA0;256:                 # Only change bonds if there are all 6 are aromatic.  Otherwise don't do anything</pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+257:                 for bond in aromaticBonds:</pre>
<pre class='cython code score-9'>        __pyx_t_2 = __pyx_v_aromaticBonds; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14 = 0;
        for (;;) {
          if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
          if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5rmgpy_8molecule_8molecule_Bond))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bond, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Bond *)__pyx_t_11));
          __pyx_t_11 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L30;
      }
      __pyx_L30:;
    }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+258:                     bond.order = 'B'</pre>
<pre class='cython code score-2'>          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_B);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_B);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_bond-&gt;order);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_bond-&gt;order);
          __pyx_v_bond-&gt;order = __pyx_n_s_B;
</pre><pre class='cython line score-0'>&#xA0;259: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+260:     if aromatic:</pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_aromatic != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+261:         try:</pre>
<pre class='cython code score-0'>    {
      /*try:*/ {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+262:             molecule.updateAtomTypes()</pre>
<pre class='cython code score-1'>        __pyx_t_1 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_molecule-&gt;__pyx_base.__pyx_vtab)-&gt;updateAtomTypes(__pyx_v_molecule, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L34_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      /*else:*/ {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+263:         except:</pre>
<pre class='cython code score-4'>      /*except:*/ {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateAromaticResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_3, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L36_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class='cython line score-0'>&#xA0;264:             # Something incorrect has happened, ie. 2 double bonds on a Cb atomtype</pre>
<pre class='cython line score-0'>&#xA0;265:             # Do not add the new isomer since it is malformed</pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+266:             return []</pre>
<pre class='cython code score-13'>        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L36_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        __pyx_r = __pyx_t_11;
        __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        goto __pyx_L37_except_return;
      }
      __pyx_L36_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      goto __pyx_L1_error;
      __pyx_L37_except_return:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      goto __pyx_L0;
    }
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;267:         else:</pre>
<pre class='cython line score-0'>&#xA0;268:             # nothing bad happened</pre>
<pre class='cython line score-18' onclick='toggleDiv(this)'>+269:             return [molecule]</pre>
<pre class='cython code score-18'>        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L36_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_molecule));
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_molecule));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_molecule));
        __pyx_r = __pyx_t_1;
        __pyx_t_1 = 0;
        goto __pyx_L37_except_return;
      }
      __pyx_L34_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;270:     else:</pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+271:         return []</pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;272: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+273: def generateKekulizedResonanceIsomers(mol):</pre>
<pre class='cython code score-16'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_11generateKekulizedResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generateKekulizedResonanceIsomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *__pyx_v_atom = 0;
  PyObject *__pyx_v_rdkitmol = NULL;
  PyObject *__pyx_v_isomer = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateKekulizedResonanceIsomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateKekulizedResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_atom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rdkitmol);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomer);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_11generateKekulizedResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_10generateKekulizedResonanceIsomers[] = "\n    Generate a kekulized (single-double bond) form of the molecule.\n    \n    Returns a single Kekule form, as an element of a list of length 1.\n    If there's an error (eg. in RDKit) then it just returns an empty list.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_11generateKekulizedResonanceIsomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateKekulizedResonanceIsomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_10generateKekulizedResonanceIsomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_10generateKekulizedResonanceIsomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateKekulizedResonanceIsomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generateKekulizedResonanceIsomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateKekulizedResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;274:     """</pre>
<pre class='cython line score-0'>&#xA0;275:     Generate a kekulized (single-double bond) form of the molecule.</pre>
<pre class='cython line score-0'>&#xA0;276: </pre>
<pre class='cython line score-0'>&#xA0;277:     Returns a single Kekule form, as an element of a list of length 1.</pre>
<pre class='cython line score-0'>&#xA0;278:     If there's an error (eg. in RDKit) then it just returns an empty list.</pre>
<pre class='cython line score-0'>&#xA0;279:     """</pre>
<pre class='cython line score-0'>&#xA0;280:     cython.declare(atom=Atom)</pre>
<pre class='cython line score-51' onclick='toggleDiv(this)'>+281:     for atom in mol.atoms:</pre>
<pre class='cython code score-51'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_mol), __pyx_n_s_atoms);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8molecule_8molecule_Atom))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_atom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Atom *)__pyx_t_1));
    __pyx_t_1 = 0;
/* … */
  }
  /*else*/ {
/* … */
  __pyx_L4_break:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+282:         if atom.atomType.label == 'Cb' or atom.atomType.label == 'Cbf':</pre>
<pre class='cython code score-4'>    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_atom-&gt;atomType-&gt;label, __pyx_n_s_Cb, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = (__pyx_t_6 != 0);
    if (!__pyx_t_7) {
      goto __pyx_L7_next_or;
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_L7_next_or:;
    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_atom-&gt;atomType-&gt;label, __pyx_n_s_Cbf, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = (__pyx_t_7 != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_5) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+283:             break</pre>
<pre class='cython code score-0'>      goto __pyx_L4_break;
    }
</pre><pre class='cython line score-0'>&#xA0;284:     else:</pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+285:         return []</pre>
<pre class='cython code score-7'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;286: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+287:     try:</pre>
<pre class='cython code score-0'>  {
    /*try:*/ {
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+288:         rdkitmol = generator.toRDKitMol(mol)  # This perceives aromaticity</pre>
<pre class='cython code score-29'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generator);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_toRDKitMol);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, ((PyObject *)__pyx_v_mol));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_mol));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, ((PyObject *)__pyx_v_mol));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_mol));
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_v_rdkitmol = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='cython line score-38' onclick='toggleDiv(this)'>+289:         isomer = parser.fromRDKitMol(Molecule(), rdkitmol)  # This step Kekulizes the molecule</pre>
<pre class='cython code score-38'>      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_parser);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_fromRDKitMol);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_8molecule_8molecule_Molecule)), __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = NULL;
      __pyx_t_3 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_3 = 1;
        }
      }
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (__pyx_t_1) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_3, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rdkitmol);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_3, __pyx_v_rdkitmol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rdkitmol);
      __pyx_t_11 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_v_isomer = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    goto __pyx_L16_try_end;
    __pyx_L9_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+290:     except ValueError:</pre>
<pre class='cython code score-9'>    __pyx_t_14 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_14) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generateKekulizedResonanceIsomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_2, &amp;__pyx_t_12, &amp;__pyx_t_13) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+291:         return []</pre>
<pre class='cython code score-13'>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_r = ((PyObject*)__pyx_t_11);
      __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L12_except_return;
    }
    goto __pyx_L11_except_error;
    __pyx_L11_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
    goto __pyx_L1_error;
    __pyx_L12_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
    goto __pyx_L0;
    __pyx_L16_try_end:;
  }
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+292:     isomer.updateAtomTypes()</pre>
<pre class='cython code score-19'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_isomer, __pyx_n_s_updateAtomTypes);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+293:     return [isomer]</pre>
<pre class='cython code score-8'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_13 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomer);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 0, __pyx_v_isomer);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_isomer);
  __pyx_r = ((PyObject*)__pyx_t_13);
  __pyx_t_13 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;294: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+295: def generate_isomorphic_isomers(mol):</pre>
<pre class='cython code score-20'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_13generate_isomorphic_isomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_generate_isomorphic_isomers(struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_isomorphic_isomers = 0;
  PyObject *__pyx_v_isomers = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_newIsomer = 0;
  struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_isom = 0;
  int __pyx_v_index;
  PyObject *__pyx_v_newIsomers = NULL;
  PyObject *__pyx_v_algo = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_isomorphic_isomers", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generate_isomorphic_isomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomorphic_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_isomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_newIsomer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_isom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_newIsomers);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_algo);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_13generate_isomorphic_isomers(PyObject *__pyx_self, PyObject *__pyx_v_mol); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_12generate_isomorphic_isomers[] = "\n    Select the resonance isomer that is isomorphic to the parameter isomer, with the lowest unpaired\n    electrons descriptor.\n\n    We generate over all resonance isomers (non-isomorphic as well as isomorphic) and retain isomorphic\n    isomers.\n\n    WIP: do not generate aromatic resonance isomers.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_13generate_isomorphic_isomers(PyObject *__pyx_self, PyObject *__pyx_v_mol) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_isomorphic_isomers (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mol), __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule, 1, "mol", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_12generate_isomorphic_isomers(__pyx_self, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_mol));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_12generate_isomorphic_isomers(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *__pyx_v_mol) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_isomorphic_isomers", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_generate_isomorphic_isomers(__pyx_v_mol, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.generate_isomorphic_isomers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;296:     """</pre>
<pre class='cython line score-0'>&#xA0;297:     Select the resonance isomer that is isomorphic to the parameter isomer, with the lowest unpaired</pre>
<pre class='cython line score-0'>&#xA0;298:     electrons descriptor.</pre>
<pre class='cython line score-0'>&#xA0;299: </pre>
<pre class='cython line score-0'>&#xA0;300:     We generate over all resonance isomers (non-isomorphic as well as isomorphic) and retain isomorphic</pre>
<pre class='cython line score-0'>&#xA0;301:     isomers.</pre>
<pre class='cython line score-0'>&#xA0;302: </pre>
<pre class='cython line score-0'>&#xA0;303:     WIP: do not generate aromatic resonance isomers.</pre>
<pre class='cython line score-0'>&#xA0;304:     """</pre>
<pre class='cython line score-0'>&#xA0;305: </pre>
<pre class='cython line score-0'>&#xA0;306:     cython.declare(isomorphic_isomers=list,\</pre>
<pre class='cython line score-0'>&#xA0;307:                    isomers=list,</pre>
<pre class='cython line score-0'>&#xA0;308:                     )</pre>
<pre class='cython line score-0'>&#xA0;309: </pre>
<pre class='cython line score-0'>&#xA0;310:     cython.declare(isomer=Molecule,\</pre>
<pre class='cython line score-0'>&#xA0;311:                    newIsomer=Molecule,\</pre>
<pre class='cython line score-0'>&#xA0;312:                    isom=Molecule</pre>
<pre class='cython line score-0'>&#xA0;313:                    )</pre>
<pre class='cython line score-0'>&#xA0;314: </pre>
<pre class='cython line score-0'>&#xA0;315:     cython.declare(index=int)</pre>
<pre class='cython line score-0'>&#xA0;316: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+317:     isomorphic_isomers = [mol]# resonance isomers that are isomorphic to the parameter isomer.</pre>
<pre class='cython code score-7'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_mol));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_mol));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_mol));
  __pyx_v_isomorphic_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;318: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+319:     isomers = [mol]</pre>
<pre class='cython code score-7'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_mol));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_mol));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_mol));
  __pyx_v_isomers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;320: </pre>
<pre class='cython line score-0'>&#xA0;321:     # Iterate over resonance isomers</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+322:     index = 0</pre>
<pre class='cython code score-0'>  __pyx_v_index = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+323:     while index &lt; len(isomers):</pre>
<pre class='cython code score-1'>  while (1) {
    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_isomers);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = ((__pyx_v_index &lt; __pyx_t_2) != 0);
    if (!__pyx_t_3) break;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+324:         isomer = isomers[index]</pre>
<pre class='cython code score-5'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_isomers, __pyx_v_index, int, 1, __Pyx_PyInt_From_int, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;325: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+326:         newIsomers = []</pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_newIsomers, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+327:         for algo in populate_resonance_generation_algorithm():</pre>
<pre class='cython code score-13'>    __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_populate_resonance_generation_algorithm(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(__pyx_t_1 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_algo, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+328:             newIsomers.extend(algo(isomer))</pre>
<pre class='cython code score-28'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_algo);
      __pyx_t_5 = __pyx_v_algo; __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)__pyx_v_isomer));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_isomer));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, ((PyObject *)__pyx_v_isomer));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_isomer));
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v_newIsomers, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;329: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+330:         for newIsomer in newIsomers:</pre>
<pre class='cython code score-9'>    __pyx_t_4 = __pyx_v_newIsomers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    for (;;) {
      if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
      if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_newIsomer, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_1));
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;331:             # Append to isomer list if unique</pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+332:             for isom in isomers:</pre>
<pre class='cython code score-9'>      __pyx_t_1 = __pyx_v_isomers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
      for (;;) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
        if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8molecule_8molecule_Molecule))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_isom, ((struct __pyx_obj_5rmgpy_8molecule_8molecule_Molecule *)__pyx_t_5));
        __pyx_t_5 = 0;
/* … */
      }
      /*else*/ {
/* … */
      __pyx_L10_break:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+333:                 if isom.copy(deep=True).isIsomorphic(newIsomer.copy(deep=True)):</pre>
<pre class='cython code score-2'>        __pyx_t_10.__pyx_n = 1;
        __pyx_t_10.deep = 1;
        __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_isom-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_isom), 0, &amp;__pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_10.__pyx_n = 1;
        __pyx_t_10.deep = 1;
        __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_5rmgpy_8molecule_8molecule_Molecule *)__pyx_v_newIsomer-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.copy(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_v_newIsomer), 0, &amp;__pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_3 = ((struct __pyx_vtabstruct_5rmgpy_8molecule_5graph_Graph *)((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_t_5)-&gt;__pyx_vtab)-&gt;isIsomorphic(((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_t_5), ((struct __pyx_obj_5rmgpy_8molecule_5graph_Graph *)__pyx_t_7), 0, NULL);<span class='error_goto'> if (unlikely(__pyx_t_3 == -2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_11 = (__pyx_t_3 != 0);
        if (__pyx_t_11) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+334:                     isomorphic_isomers.append(newIsomer)</pre>
<pre class='cython code score-2'>          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomorphic_isomers, ((PyObject *)__pyx_v_newIsomer));<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+335:                     break</pre>
<pre class='cython code score-0'>          goto __pyx_L10_break;
        }
</pre><pre class='cython line score-0'>&#xA0;336:             else:</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+337:                 isomers.append(newIsomer)</pre>
<pre class='cython code score-2'>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_isomers, ((PyObject *)__pyx_v_newIsomer));<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
</pre><pre class='cython line score-0'>&#xA0;338: </pre>
<pre class='cython line score-0'>&#xA0;339:         # Move to next resonance isomer</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+340:         index += 1</pre>
<pre class='cython code score-0'>    __pyx_v_index = (__pyx_v_index + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;341: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+342:     return isomorphic_isomers</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_isomorphic_isomers);
  __pyx_r = __pyx_v_isomorphic_isomers;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;343: </pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+344: def populate_resonance_generation_algorithm():</pre>
<pre class='cython code score-13'>static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_15populate_resonance_generation_algorithm(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_5rmgpy_8molecule_9resonance_populate_resonance_generation_algorithm(CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_algorithms = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("populate_resonance_generation_algorithm", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.populate_resonance_generation_algorithm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_algorithms);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_15populate_resonance_generation_algorithm(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5rmgpy_8molecule_9resonance_14populate_resonance_generation_algorithm[] = "\n    A list with the current set of resonance generation algorithms.\n    ";
static PyObject *__pyx_pw_5rmgpy_8molecule_9resonance_15populate_resonance_generation_algorithm(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("populate_resonance_generation_algorithm (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_8molecule_9resonance_14populate_resonance_generation_algorithm(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_8molecule_9resonance_14populate_resonance_generation_algorithm(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("populate_resonance_generation_algorithm", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_8molecule_9resonance_populate_resonance_generation_algorithm(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.molecule.resonance.populate_resonance_generation_algorithm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;345:     """</pre>
<pre class='cython line score-0'>&#xA0;346:     A list with the current set of resonance generation algorithms.</pre>
<pre class='cython line score-0'>&#xA0;347:     """</pre>
<pre class='cython line score-0'>&#xA0;348:     algorithms = (</pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+349:         generateAdjacentResonanceIsomers,</pre>
<pre class='cython code score-12'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generateAdjacentResonanceIsomers);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_v_algorithms = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+350:         generateLonePairRadicalResonanceIsomers,</pre>
<pre class='cython code score-2'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generateLonePairRadicalResonance);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+351:         generateN5dd_N5tsResonanceIsomers,</pre>
<pre class='cython code score-2'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generateN5dd_N5tsResonanceIsomer);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+352:         generateKekulizedResonanceIsomers,</pre>
<pre class='cython code score-2'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generateKekulizedResonanceIsomer);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+353:         generateAromaticResonanceIsomers,</pre>
<pre class='cython code score-2'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_generateAromaticResonanceIsomers);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class='cython line score-0'>&#xA0;354:     )</pre>
<pre class='cython line score-0'>&#xA0;355: </pre>
<pre class='cython line score-0'>&#xA0;356: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+357:     return algorithms</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_algorithms);
  __pyx_r = __pyx_v_algorithms;
  goto __pyx_L0;
</pre></div></body></html>
