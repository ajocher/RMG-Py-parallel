<!DOCTYPE html>
<!-- Generated by Cython 0.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21</p>
<p>Raw output: <a href="simple.c">simple.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: ################################################################################</pre>
<pre class='cython code score-11'>  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: #</pre>
<pre class='cython line score-0'>&#xA0;003: #   RMG - Reaction Mechanism Generator</pre>
<pre class='cython line score-0'>&#xA0;004: #</pre>
<pre class='cython line score-0'>&#xA0;005: #   Copyright (c) 2002-2010 Prof. William H. Green (whgreen@mit.edu) and the</pre>
<pre class='cython line score-0'>&#xA0;006: #   RMG Team (rmg_dev@mit.edu)</pre>
<pre class='cython line score-0'>&#xA0;007: #</pre>
<pre class='cython line score-0'>&#xA0;008: #   Permission is hereby granted, free of charge, to any person obtaining a</pre>
<pre class='cython line score-0'>&#xA0;009: #   copy of this software and associated documentation files (the 'Software'),</pre>
<pre class='cython line score-0'>&#xA0;010: #   to deal in the Software without restriction, including without limitation</pre>
<pre class='cython line score-0'>&#xA0;011: #   the rights to use, copy, modify, merge, publish, distribute, sublicense,</pre>
<pre class='cython line score-0'>&#xA0;012: #   and/or sell copies of the Software, and to permit persons to whom the</pre>
<pre class='cython line score-0'>&#xA0;013: #   Software is furnished to do so, subject to the following conditions:</pre>
<pre class='cython line score-0'>&#xA0;014: #</pre>
<pre class='cython line score-0'>&#xA0;015: #   The above copyright notice and this permission notice shall be included in</pre>
<pre class='cython line score-0'>&#xA0;016: #   all copies or substantial portions of the Software.</pre>
<pre class='cython line score-0'>&#xA0;017: #</pre>
<pre class='cython line score-0'>&#xA0;018: #   THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</pre>
<pre class='cython line score-0'>&#xA0;019: #   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</pre>
<pre class='cython line score-0'>&#xA0;020: #   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</pre>
<pre class='cython line score-0'>&#xA0;021: #   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;022: #   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</pre>
<pre class='cython line score-0'>&#xA0;023: #   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;024: #   DEALINGS IN THE SOFTWARE.</pre>
<pre class='cython line score-0'>&#xA0;025: #</pre>
<pre class='cython line score-0'>&#xA0;026: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;027: </pre>
<pre class='cython line score-0'>&#xA0;028: """</pre>
<pre class='cython line score-0'>&#xA0;029: Contains the :class:`SimpleReactor` class, providing a reaction system</pre>
<pre class='cython line score-0'>&#xA0;030: consisting of a homogeneous, isothermal, isobaric batch reactor.</pre>
<pre class='cython line score-0'>&#xA0;031: """</pre>
<pre class='cython line score-0'>&#xA0;032: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+033: import numpy</pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;034: cimport numpy</pre>
<pre class='cython line score-0'>&#xA0;035: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+036: import itertools</pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_itertools, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;037: </pre>
<pre class='cython line score-0'>&#xA0;038: from base cimport ReactionSystem</pre>
<pre class='cython line score-0'>&#xA0;039: cimport cython</pre>
<pre class='cython line score-0'>&#xA0;040: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+041: import rmgpy.constants as constants</pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__9);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_constants, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_constants, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;042: cimport rmgpy.constants as constants</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+043: from rmgpy.quantity import Quantity</pre>
<pre class='cython code score-19'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Quantity);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_Quantity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Quantity);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_quantity, __pyx_t_4, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Quantity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Quantity, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;044: from rmgpy.quantity cimport ScalarQuantity, ArrayQuantity</pre>
<pre class='cython line score-0'>&#xA0;045: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+046: cdef class SimpleReactor(ReactionSystem):</pre>
<pre class='cython code score-0'>struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor {
  struct __pyx_obj_5rmgpy_6solver_4base_ReactionSystem __pyx_base;
  struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *T;
  struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *P;
  double V;
  int constantVolume;
  PyObject *initialMoleFractions;
  PyObject *pdepColliderKinetics;
  PyArrayObject *colliderEfficiencies;
  PyArrayObject *pdepColliderReactionIndices;
};
/* â€¦ */
struct __pyx_vtabstruct_5rmgpy_6solver_6simple_SimpleReactor {
  struct __pyx_vtabstruct_5rmgpy_6solver_4base_ReactionSystem __pyx_base;
};
static struct __pyx_vtabstruct_5rmgpy_6solver_6simple_SimpleReactor *__pyx_vtabptr_5rmgpy_6solver_6simple_SimpleReactor;
</pre><pre class='cython line score-0'>&#xA0;047:     """</pre>
<pre class='cython line score-0'>&#xA0;048:     A reaction system consisting of a homogeneous, isothermal, isobaric batch</pre>
<pre class='cython line score-0'>&#xA0;049:     reactor. These assumptions allow for a number of optimizations that enable</pre>
<pre class='cython line score-0'>&#xA0;050:     this solver to complete very rapidly, even for large kinetic models.</pre>
<pre class='cython line score-0'>&#xA0;051:     """</pre>
<pre class='cython line score-0'>&#xA0;052: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+053:     cdef public ScalarQuantity T</pre>
<pre class='cython code score-11'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;T);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(((__pyx_v_value) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_value, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;T);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  __pyx_v_self-&gt;T = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.T.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1T_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1T_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;T);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  __pyx_v_self-&gt;T = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+054:     cdef public ScalarQuantity P</pre>
<pre class='cython code score-11'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;P);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(((__pyx_v_value) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_value, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;P);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  __pyx_v_self-&gt;P = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.P.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1P_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1P_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;P);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  __pyx_v_self-&gt;P = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+055:     cdef public double V</pre>
<pre class='cython code score-16'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1V_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1V_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1V___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1V___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;V);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.V.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1V_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1V_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1V_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_1V_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;V = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.V.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+056:     cdef public bint constantVolume</pre>
<pre class='cython code score-10'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;constantVolume);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.constantVolume.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14constantVolume_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;constantVolume = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.constantVolume.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+057:     cdef public dict initialMoleFractions</pre>
<pre class='cython code score-19'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  __pyx_r = __pyx_v_self-&gt;initialMoleFractions;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_v_value))||((__pyx_v_value) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_v_value)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  __pyx_v_self-&gt;initialMoleFractions = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.initialMoleFractions.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20initialMoleFractions_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  __pyx_v_self-&gt;initialMoleFractions = ((PyObject*)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;058: </pre>
<pre class='cython line score-0'>&#xA0;059:     # collider variables</pre>
<pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-0'>&#xA0;061:     """</pre>
<pre class='cython line score-0'>&#xA0;062:     pdepColliderKinetics:</pre>
<pre class='cython line score-0'>&#xA0;063:     an array that contains a reference to the kinetics object of the reaction</pre>
<pre class='cython line score-0'>&#xA0;064:     that has pressure dependent kinetics.</pre>
<pre class='cython line score-0'>&#xA0;065:     """</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+066:     cdef public list pdepColliderKinetics</pre>
<pre class='cython code score-19'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  __pyx_r = __pyx_v_self-&gt;pdepColliderKinetics;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_value))||((__pyx_v_value) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_value)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  __pyx_v_self-&gt;pdepColliderKinetics = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.pdepColliderKinetics.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20pdepColliderKinetics_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  __pyx_v_self-&gt;pdepColliderKinetics = ((PyObject*)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;067: </pre>
<pre class='cython line score-0'>&#xA0;068: </pre>
<pre class='cython line score-0'>&#xA0;069:     """</pre>
<pre class='cython line score-0'>&#xA0;070:     colliderEfficiencies:</pre>
<pre class='cython line score-0'>&#xA0;071:     an array consisting of array elements, each element corresponding to a reaction.</pre>
<pre class='cython line score-0'>&#xA0;072:     Each element is an array with each position in the array corresponding to the collider efficiency</pre>
<pre class='cython line score-0'>&#xA0;073:     of the core species. The collider efficiency is set to 1 if the species was not found in the list</pre>
<pre class='cython line score-0'>&#xA0;074:     of colliders.</pre>
<pre class='cython line score-0'>&#xA0;075: </pre>
<pre class='cython line score-0'>&#xA0;076:     """</pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+077:     cdef public numpy.ndarray colliderEfficiencies</pre>
<pre class='cython code score-11'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;colliderEfficiencies);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(((__pyx_v_value) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_value, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies));
  __pyx_v_self-&gt;colliderEfficiencies = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.colliderEfficiencies.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_20colliderEfficiencies_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies));
  __pyx_v_self-&gt;colliderEfficiencies = ((PyArrayObject *)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;078: </pre>
<pre class='cython line score-0'>&#xA0;079: </pre>
<pre class='cython line score-0'>&#xA0;080:     """</pre>
<pre class='cython line score-0'>&#xA0;081:     pdepColliderReactionIndices:</pre>
<pre class='cython line score-0'>&#xA0;082:     array that contains the indices of those reactions that</pre>
<pre class='cython line score-0'>&#xA0;083:     have pressure dependent kinetics. E.g. [4, 10, 2, 123]</pre>
<pre class='cython line score-0'>&#xA0;084:     """</pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+085:     cdef public numpy.ndarray pdepColliderReactionIndices</pre>
<pre class='cython code score-11'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices___get__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices___get__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices);
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_2__set__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_2__set__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  if (!(likely(((__pyx_v_value) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_value, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices));
  __pyx_v_self-&gt;pdepColliderReactionIndices = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.pdepColliderReactionIndices.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_4__del__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_27pdepColliderReactionIndices_4__del__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices));
  __pyx_v_self-&gt;pdepColliderReactionIndices = ((PyArrayObject *)Py_None);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;086: </pre>
<pre class='cython line score-0'>&#xA0;087: </pre>
<pre class='cython line score-68' onclick='toggleDiv(this)'>+088:     def __init__(self, T, P, initialMoleFractions, termination, sensitiveSpecies=None, sensitivityThreshold=1e-3):</pre>
<pre class='cython code score-68'>/* Python wrapper */
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_T = 0;
  PyObject *__pyx_v_P = 0;
  PyObject *__pyx_v_initialMoleFractions = 0;
  PyObject *__pyx_v_termination = 0;
  PyObject *__pyx_v_sensitiveSpecies = 0;
  PyObject *__pyx_v_sensitivityThreshold = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_T,&amp;__pyx_n_s_P,&amp;__pyx_n_s_initialMoleFractions,&amp;__pyx_n_s_termination,&amp;__pyx_n_s_sensitiveSpecies,&amp;__pyx_n_s_sensitivityThreshold,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    values[4] = ((PyObject *)Py_None);
    values[5] = ((PyObject *)__pyx_float_1eneg_3);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_P)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_initialMoleFractions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_termination)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sensitiveSpecies);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sensitivityThreshold);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_T = values[0];
    __pyx_v_P = values[1];
    __pyx_v_initialMoleFractions = values[2];
    __pyx_v_termination = values[3];
    __pyx_v_sensitiveSpecies = values[4];
    __pyx_v_sensitivityThreshold = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor___init__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_T, __pyx_v_P, __pyx_v_initialMoleFractions, __pyx_v_termination, __pyx_v_sensitiveSpecies, __pyx_v_sensitivityThreshold);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor___init__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_T, PyObject *__pyx_v_P, PyObject *__pyx_v_initialMoleFractions, PyObject *__pyx_v_termination, PyObject *__pyx_v_sensitiveSpecies, PyObject *__pyx_v_sensitivityThreshold) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+089:         ReactionSystem.__init__(self, termination, sensitiveSpecies, sensitivityThreshold)</pre>
<pre class='cython code score-31'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, ((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_termination);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_termination);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_termination);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitiveSpecies);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_sensitiveSpecies);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitiveSpecies);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivityThreshold);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3+__pyx_t_4, __pyx_v_sensitivityThreshold);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivityThreshold);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+090:         self.T = Quantity(T)</pre>
<pre class='cython code score-29'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_Quantity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_T);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;T);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  __pyx_v_self-&gt;T = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+091:         self.P = Quantity(P)</pre>
<pre class='cython code score-29'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_Quantity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_P);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_P);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_P);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_P);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;P);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  __pyx_v_self-&gt;P = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-12' onclick='toggleDiv(this)'>+092:         self.initialMoleFractions = initialMoleFractions</pre>
<pre class='cython code score-12'>  if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_v_initialMoleFractions))||((__pyx_v_initialMoleFractions) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_v_initialMoleFractions)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_v_initialMoleFractions;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  __pyx_v_self-&gt;initialMoleFractions = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;093: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+094:         self.V = 0 # will be set in initializeModel</pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;V = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+095:         self.constantVolume = False</pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;constantVolume = 0;
</pre><pre class='cython line score-0'>&#xA0;096: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+097:         self.pdepColliderReactionIndices = None</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices));
  __pyx_v_self-&gt;pdepColliderReactionIndices = ((PyArrayObject *)Py_None);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+098:         self.pdepColliderKinetics = None</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  __pyx_v_self-&gt;pdepColliderKinetics = ((PyObject*)Py_None);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+099:         self.colliderEfficiencies = None</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies));
  __pyx_v_self-&gt;colliderEfficiencies = ((PyArrayObject *)Py_None);
</pre><pre class='cython line score-0'>&#xA0;100: </pre>
<pre class='cython line score-0'>&#xA0;101: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+102:     def __reduce__(self):</pre>
<pre class='cython code score-5'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_3__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_2__reduce__[] = "\n        A helper function used when pickling an object.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_3__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_2__reduce__(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_2__reduce__(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;103:         """</pre>
<pre class='cython line score-0'>&#xA0;104:         A helper function used when pickling an object.</pre>
<pre class='cython line score-0'>&#xA0;105:         """</pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+106:         return (self.__class__,</pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_class);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* â€¦ */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+107:             (self.T, self.P, self.initialMoleFractions, self.termination, ))</pre>
<pre class='cython code score-13'>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self-&gt;T));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;T));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self-&gt;P));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;P));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_self-&gt;initialMoleFractions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;__pyx_base.termination);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_v_self-&gt;__pyx_base.termination);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;__pyx_base.termination);
</pre><pre class='cython line score-0'>&#xA0;108: </pre>
<pre class='cython line score-0'>&#xA0;109: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+110:     def convertInitialKeysToSpeciesObjects(self, speciesDict):</pre>
<pre class='cython code score-9'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_5convertInitialKeysToSpeciesObjects(PyObject *__pyx_v_self, PyObject *__pyx_v_speciesDict); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_4convertInitialKeysToSpeciesObjects[] = "\n        Convert the initialMoleFractions dictionary from species names into species objects,\n        using the given dictionary of species.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_5convertInitialKeysToSpeciesObjects(PyObject *__pyx_v_self, PyObject *__pyx_v_speciesDict) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convertInitialKeysToSpeciesObjects (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_4convertInitialKeysToSpeciesObjects(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_speciesDict));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_4convertInitialKeysToSpeciesObjects(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_speciesDict) {
  PyObject *__pyx_v_initialMoleFractions = NULL;
  PyObject *__pyx_v_label = NULL;
  PyObject *__pyx_v_moleFrac = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convertInitialKeysToSpeciesObjects", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.convertInitialKeysToSpeciesObjects", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_moleFrac);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;111:         """</pre>
<pre class='cython line score-0'>&#xA0;112:         Convert the initialMoleFractions dictionary from species names into species objects,</pre>
<pre class='cython line score-0'>&#xA0;113:         using the given dictionary of species.</pre>
<pre class='cython line score-0'>&#xA0;114:         """</pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+115:         initialMoleFractions = {}</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_initialMoleFractions = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+116:         for label, moleFrac in self.initialMoleFractions.iteritems():</pre>
<pre class='cython code score-8'>  __pyx_t_2 = 0;
  if (unlikely(__pyx_v_self-&gt;initialMoleFractions == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "iteritems");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_self-&gt;initialMoleFractions, 1, __pyx_n_s_iteritems, (&amp;__pyx_t_3), (&amp;__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __pyx_t_1 = __pyx_t_5;
  __pyx_t_5 = 0;
  while (1) {
    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &amp;__pyx_t_2, &amp;__pyx_t_5, &amp;__pyx_t_6, NULL, __pyx_t_4);
    if (unlikely(__pyx_t_7 == 0)) break;
    if (unlikely(__pyx_t_7 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_moleFrac, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class='cython line score-12' onclick='toggleDiv(this)'>+117:             initialMoleFractions[speciesDict[label]] = moleFrac</pre>
<pre class='cython code score-12'>    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_speciesDict, __pyx_v_label);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_initialMoleFractions, __pyx_t_6, __pyx_v_moleFrac) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+118:         self.initialMoleFractions = initialMoleFractions</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_initialMoleFractions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_initialMoleFractions);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;initialMoleFractions);
  __pyx_v_self-&gt;initialMoleFractions = __pyx_v_initialMoleFractions;
</pre><pre class='cython line score-0'>&#xA0;119: </pre>
<pre class='cython line score-167' onclick='toggleDiv(this)'>+120:     cpdef initializeModel(self, list coreSpecies, list coreReactions, list edgeSpecies, list edgeReactions, list pdepNetworks=None, atol=1e-16, rtol=1e-8, sensitivity=False, sens_atol=1e-6, sens_rtol=1e-4, filterReactions=False):</pre>
<pre class='cython code score-167'>static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_7initializeModel(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_5rmgpy_6solver_6simple_13SimpleReactor_initializeModel(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_coreSpecies, PyObject *__pyx_v_coreReactions, PyObject *__pyx_v_edgeSpecies, PyObject *__pyx_v_edgeReactions, int __pyx_skip_dispatch, struct __pyx_opt_args_5rmgpy_6solver_6simple_13SimpleReactor_initializeModel *__pyx_optional_args) {
  PyObject *__pyx_v_pdepNetworks = ((PyObject*)Py_None);
  PyObject *__pyx_v_atol = ((PyObject *)__pyx_float_1eneg_16);
  PyObject *__pyx_v_rtol = ((PyObject *)__pyx_float_1eneg_8);
  PyObject *__pyx_v_sensitivity = ((PyObject *)Py_False);
  PyObject *__pyx_v_sens_atol = ((PyObject *)__pyx_float_1eneg_6);
  PyObject *__pyx_v_sens_rtol = ((PyObject *)__pyx_float_1eneg_4);
  PyObject *__pyx_v_filterReactions = ((PyObject *)Py_False);
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("initializeModel", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_pdepNetworks = __pyx_optional_args-&gt;pdepNetworks;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_atol = __pyx_optional_args-&gt;atol;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_rtol = __pyx_optional_args-&gt;rtol;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_sensitivity = __pyx_optional_args-&gt;sensitivity;
            if (__pyx_optional_args-&gt;__pyx_n &gt; 4) {
              __pyx_v_sens_atol = __pyx_optional_args-&gt;sens_atol;
              if (__pyx_optional_args-&gt;__pyx_n &gt; 5) {
                __pyx_v_sens_rtol = __pyx_optional_args-&gt;sens_rtol;
                if (__pyx_optional_args-&gt;__pyx_n &gt; 6) {
                  __pyx_v_filterReactions = __pyx_optional_args-&gt;filterReactions;
                }
              }
            }
          }
        }
      }
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_initializeModel);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_7initializeModel)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
      __pyx_t_5 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (__pyx_t_4) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreSpecies);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_v_coreSpecies);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreSpecies);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreReactions);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_coreReactions);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreReactions);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeSpecies);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, __pyx_v_edgeSpecies);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeSpecies);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeReactions);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_5, __pyx_v_edgeReactions);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeReactions);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdepNetworks);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4+__pyx_t_5, __pyx_v_pdepNetworks);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pdepNetworks);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_atol);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 5+__pyx_t_5, __pyx_v_atol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_atol);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rtol);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 6+__pyx_t_5, __pyx_v_rtol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rtol);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 7+__pyx_t_5, __pyx_v_sensitivity);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sens_atol);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 8+__pyx_t_5, __pyx_v_sens_atol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sens_atol);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sens_rtol);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 9+__pyx_t_5, __pyx_v_sens_rtol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sens_rtol);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filterReactions);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 10+__pyx_t_5, __pyx_v_filterReactions);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_filterReactions);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.initializeModel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_7initializeModel(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_6initializeModel[] = "\n        Initialize a simulation of the simple reactor using the provided kinetic\n        model.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_7initializeModel(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coreSpecies = 0;
  PyObject *__pyx_v_coreReactions = 0;
  PyObject *__pyx_v_edgeSpecies = 0;
  PyObject *__pyx_v_edgeReactions = 0;
  PyObject *__pyx_v_pdepNetworks = 0;
  PyObject *__pyx_v_atol = 0;
  PyObject *__pyx_v_rtol = 0;
  PyObject *__pyx_v_sensitivity = 0;
  PyObject *__pyx_v_sens_atol = 0;
  PyObject *__pyx_v_sens_rtol = 0;
  PyObject *__pyx_v_filterReactions = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("initializeModel (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coreSpecies,&amp;__pyx_n_s_coreReactions,&amp;__pyx_n_s_edgeSpecies,&amp;__pyx_n_s_edgeReactions,&amp;__pyx_n_s_pdepNetworks,&amp;__pyx_n_s_atol,&amp;__pyx_n_s_rtol,&amp;__pyx_n_s_sensitivity,&amp;__pyx_n_s_sens_atol,&amp;__pyx_n_s_sens_rtol,&amp;__pyx_n_s_filterReactions,0};
    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    values[4] = ((PyObject*)Py_None);
    values[5] = ((PyObject *)__pyx_float_1eneg_16);
    values[6] = ((PyObject *)__pyx_float_1eneg_8);
    values[7] = ((PyObject *)Py_False);
    values[8] = ((PyObject *)__pyx_float_1eneg_6);
    values[9] = ((PyObject *)__pyx_float_1eneg_4);
    values[10] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_coreSpecies)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_coreReactions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("initializeModel", 0, 4, 11, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_edgeSpecies)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("initializeModel", 0, 4, 11, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_edgeReactions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("initializeModel", 0, 4, 11, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pdepNetworks);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_atol);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rtol);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sensitivity);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sens_atol);
          if (value) { values[8] = value; kw_args--; }
        }
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sens_rtol);
          if (value) { values[9] = value; kw_args--; }
        }
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_filterReactions);
          if (value) { values[10] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "initializeModel") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_coreSpecies = ((PyObject*)values[0]);
    __pyx_v_coreReactions = ((PyObject*)values[1]);
    __pyx_v_edgeSpecies = ((PyObject*)values[2]);
    __pyx_v_edgeReactions = ((PyObject*)values[3]);
    __pyx_v_pdepNetworks = ((PyObject*)values[4]);
    __pyx_v_atol = values[5];
    __pyx_v_rtol = values[6];
    __pyx_v_sensitivity = values[7];
    __pyx_v_sens_atol = values[8];
    __pyx_v_sens_rtol = values[9];
    __pyx_v_filterReactions = values[10];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("initializeModel", 0, 4, 11, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.initializeModel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_coreSpecies), (&amp;PyList_Type), 1, "coreSpecies", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_coreReactions), (&amp;PyList_Type), 1, "coreReactions", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_edgeSpecies), (&amp;PyList_Type), 1, "edgeSpecies", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_edgeReactions), (&amp;PyList_Type), 1, "edgeReactions", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_pdepNetworks), (&amp;PyList_Type), 1, "pdepNetworks", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_6initializeModel(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_coreSpecies, __pyx_v_coreReactions, __pyx_v_edgeSpecies, __pyx_v_edgeReactions, __pyx_v_pdepNetworks, __pyx_v_atol, __pyx_v_rtol, __pyx_v_sensitivity, __pyx_v_sens_atol, __pyx_v_sens_rtol, __pyx_v_filterReactions);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_6initializeModel(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_coreSpecies, PyObject *__pyx_v_coreReactions, PyObject *__pyx_v_edgeSpecies, PyObject *__pyx_v_edgeReactions, PyObject *__pyx_v_pdepNetworks, PyObject *__pyx_v_atol, PyObject *__pyx_v_rtol, PyObject *__pyx_v_sensitivity, PyObject *__pyx_v_sens_atol, PyObject *__pyx_v_sens_rtol, PyObject *__pyx_v_filterReactions) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("initializeModel", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 7;
  __pyx_t_2.pdepNetworks = __pyx_v_pdepNetworks;
  __pyx_t_2.atol = __pyx_v_atol;
  __pyx_t_2.rtol = __pyx_v_rtol;
  __pyx_t_2.sensitivity = __pyx_v_sensitivity;
  __pyx_t_2.sens_atol = __pyx_v_sens_atol;
  __pyx_t_2.sens_rtol = __pyx_v_sens_rtol;
  __pyx_t_2.filterReactions = __pyx_v_filterReactions;
  __pyx_t_1 = __pyx_vtabptr_5rmgpy_6solver_6simple_SimpleReactor-&gt;__pyx_base.initializeModel(((struct __pyx_obj_5rmgpy_6solver_4base_ReactionSystem *)__pyx_v_self), __pyx_v_coreSpecies, __pyx_v_coreReactions, __pyx_v_edgeSpecies, __pyx_v_edgeReactions, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.initializeModel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
struct __pyx_opt_args_5rmgpy_6solver_6simple_13SimpleReactor_initializeModel {
  int __pyx_n;
  PyObject *pdepNetworks;
  PyObject *atol;
  PyObject *rtol;
  PyObject *sensitivity;
  PyObject *sens_atol;
  PyObject *sens_rtol;
  PyObject *filterReactions;
};
</pre><pre class='cython line score-0'>&#xA0;121:         """</pre>
<pre class='cython line score-0'>&#xA0;122:         Initialize a simulation of the simple reactor using the provided kinetic</pre>
<pre class='cython line score-0'>&#xA0;123:         model.</pre>
<pre class='cython line score-0'>&#xA0;124:         """</pre>
<pre class='cython line score-0'>&#xA0;125: </pre>
<pre class='cython line score-0'>&#xA0;126:         # First call the base class version of the method</pre>
<pre class='cython line score-0'>&#xA0;127:         # This initializes the attributes declared in the base class</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+128:         ReactionSystem.initializeModel(self, coreSpecies, coreReactions, edgeSpecies, edgeReactions, pdepNetworks, atol, rtol, sensitivity, sens_atol, sens_rtol)</pre>
<pre class='cython code score-1'>  __pyx_t_7.__pyx_n = 6;
  __pyx_t_7.pdepNetworks = __pyx_v_pdepNetworks;
  __pyx_t_7.atol = __pyx_v_atol;
  __pyx_t_7.rtol = __pyx_v_rtol;
  __pyx_t_7.sensitivity = __pyx_v_sensitivity;
  __pyx_t_7.sens_atol = __pyx_v_sens_atol;
  __pyx_t_7.sens_rtol = __pyx_v_sens_rtol;
  __pyx_t_1 = __pyx_vtabptr_5rmgpy_6solver_4base_ReactionSystem-&gt;initializeModel(((struct __pyx_obj_5rmgpy_6solver_4base_ReactionSystem *)__pyx_v_self), __pyx_v_coreSpecies, __pyx_v_coreReactions, __pyx_v_edgeSpecies, __pyx_v_edgeReactions, 1, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;129: </pre>
<pre class='cython line score-0'>&#xA0;130:         # Set initial conditions</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+131:         self.set_initial_conditions()</pre>
<pre class='cython code score-19'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_set_initial_conditions);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;132: </pre>
<pre class='cython line score-0'>&#xA0;133:         # Compute reaction thresholds if reaction filtering is turned on</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+134:         if filterReactions:</pre>
<pre class='cython code score-2'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_filterReactions);<span class='error_goto'> if (unlikely(__pyx_t_8 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_8) {
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+135:             ReactionSystem.set_initial_reaction_thresholds(self)</pre>
<pre class='cython code score-27'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_set_initial_reaction_thresholds);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;136: </pre>
<pre class='cython line score-29' onclick='toggleDiv(this)'>+137:         self.set_colliders(coreReactions, edgeReactions, coreSpecies)</pre>
<pre class='cython code score-29'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_set_colliders);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_6) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_5, __pyx_v_coreReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreReactions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_5, __pyx_v_edgeReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeReactions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreSpecies);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_5, __pyx_v_coreSpecies);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreSpecies);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;138: </pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+139:         ReactionSystem.compute_network_variables(self, pdepNetworks)</pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_compute_network_variables);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_3) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdepNetworks);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_pdepNetworks);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pdepNetworks);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;140: </pre>
<pre class='cython line score-0'>&#xA0;141:         # Generate forward and reverse rate coefficients k(T,P)</pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+142:         self.generate_rate_coefficients(coreReactions, edgeReactions)</pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_generate_rate_coefficients);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_6) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_5, __pyx_v_coreReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreReactions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_5, __pyx_v_edgeReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeReactions);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;143: </pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+144:         ReactionSystem.set_initial_derivative(self)</pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_set_initial_derivative);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;145:         # Initialize the model</pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+146:         ReactionSystem.initialize_solver(self)</pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_initialize_solver);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, ((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;147: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+148:     def calculate_effective_pressure(self, rxn):</pre>
<pre class='cython code score-12'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_9calculate_effective_pressure(PyObject *__pyx_v_self, PyObject *__pyx_v_rxn); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_8calculate_effective_pressure[] = "\n        Computes the effective pressure for a reaction as:\n            Peff = P * sum(yi * effi / sum(y))\n        with:\n            - P the pressure of the reactor,\n            - y the array of initial moles of the core species\n\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_9calculate_effective_pressure(PyObject *__pyx_v_self, PyObject *__pyx_v_rxn) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_effective_pressure (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_8calculate_effective_pressure(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), ((PyObject *)__pyx_v_rxn));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_8calculate_effective_pressure(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_rxn) {
  PyObject *__pyx_v_y0_coreSpecies = NULL;
  PyObject *__pyx_v_sum_core_species = NULL;
  PyObject *__pyx_v_j = NULL;
  npy_intp __pyx_v_i;
  PyObject *__pyx_v_Peff = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_effective_pressure", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.calculate_effective_pressure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0_coreSpecies);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sum_core_species);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Peff);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;149:         """</pre>
<pre class='cython line score-0'>&#xA0;150:         Computes the effective pressure for a reaction as:</pre>
<pre class='cython line score-0'>&#xA0;151:             Peff = P * sum(yi * effi / sum(y))</pre>
<pre class='cython line score-0'>&#xA0;152:         with:</pre>
<pre class='cython line score-0'>&#xA0;153:             - P the pressure of the reactor,</pre>
<pre class='cython line score-0'>&#xA0;154:             - y the array of initial moles of the core species</pre>
<pre class='cython line score-0'>&#xA0;155: </pre>
<pre class='cython line score-0'>&#xA0;156:         """</pre>
<pre class='cython line score-0'>&#xA0;157: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+158:         y0_coreSpecies = self.y0[:self.numCoreSpecies]</pre>
<pre class='cython code score-2'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.y0), 0, __pyx_v_self-&gt;__pyx_base.numCoreSpecies, NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_y0_coreSpecies = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+159:         sum_core_species = numpy.sum(y0_coreSpecies)</pre>
<pre class='cython code score-29'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_y0_coreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y0_coreSpecies);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_y0_coreSpecies);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y0_coreSpecies);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_sum_core_species = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;160: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+161:         j = self.reactionIndex[rxn]</pre>
<pre class='cython code score-7'>  if (unlikely(__pyx_v_self-&gt;__pyx_base.reactionIndex == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;__pyx_base.reactionIndex, __pyx_v_rxn);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_j = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+162:         for i in xrange(self.pdepColliderReactionIndices.shape[0]):</pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_self-&gt;pdepColliderReactionIndices-&gt;dimensions[0]);
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+163:             if j == self.pdepColliderReactionIndices[i]:</pre>
<pre class='cython code score-11'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices), __pyx_v_i, npy_intp, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_j, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_7) {
</pre><pre class='cython line score-0'>&#xA0;164:                 # Calculate effective pressure</pre>
<pre class='cython line score-52' onclick='toggleDiv(this)'>+165:                 Peff = self.P.value_si * numpy.sum(self.colliderEfficiencies[i]*y0_coreSpecies / sum_core_species)</pre>
<pre class='cython code score-52'>      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;P-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies), __pyx_v_i, npy_intp, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_v_y0_coreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_v_sum_core_species);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_Peff = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+166:                 return Peff</pre>
<pre class='cython code score-2'>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Peff);
      __pyx_r = __pyx_v_Peff;
      goto __pyx_L0;
    }
  }
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+167:         return self.P.value_si</pre>
<pre class='cython code score-6'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;P-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;168: </pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+169:     def generate_rate_coefficients(self, coreReactions, edgeReactions):</pre>
<pre class='cython code score-42'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_11generate_rate_coefficients(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_10generate_rate_coefficients[] = "\n        Populates the forward rate coefficients (kf), reverse rate coefficients (kb)\n        and equilibrium constants (Keq) arrays with the values computed at the temperature\n        and (effective) pressure of the reacion system.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_11generate_rate_coefficients(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coreReactions = 0;
  PyObject *__pyx_v_edgeReactions = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_rate_coefficients (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coreReactions,&amp;__pyx_n_s_edgeReactions,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_coreReactions)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_edgeReactions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_rate_coefficients", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_rate_coefficients") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coreReactions = values[0];
    __pyx_v_edgeReactions = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_rate_coefficients", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.generate_rate_coefficients", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_10generate_rate_coefficients(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_coreReactions, __pyx_v_edgeReactions);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_10generate_rate_coefficients(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_coreReactions, PyObject *__pyx_v_edgeReactions) {
  PyObject *__pyx_v_rxn = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_Peff = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generate_rate_coefficients", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.generate_rate_coefficients", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxn);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Peff);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;170:         """</pre>
<pre class='cython line score-0'>&#xA0;171:         Populates the forward rate coefficients (kf), reverse rate coefficients (kb)</pre>
<pre class='cython line score-0'>&#xA0;172:         and equilibrium constants (Keq) arrays with the values computed at the temperature</pre>
<pre class='cython line score-0'>&#xA0;173:         and (effective) pressure of the reacion system.</pre>
<pre class='cython line score-0'>&#xA0;174:         """</pre>
<pre class='cython line score-0'>&#xA0;175: </pre>
<pre class='cython line score-76' onclick='toggleDiv(this)'>+176:         for rxn in itertools.chain(coreReactions, edgeReactions):</pre>
<pre class='cython code score-76'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_chain);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_coreReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreReactions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_edgeReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeReactions);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rxn, __pyx_t_1);
    __pyx_t_1 = 0;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+177:             j = self.reactionIndex[rxn]</pre>
<pre class='cython code score-8'>    if (unlikely(__pyx_v_self-&gt;__pyx_base.reactionIndex == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;__pyx_base.reactionIndex, __pyx_v_rxn);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+178:             Peff = self.calculate_effective_pressure(rxn)</pre>
<pre class='cython code score-27'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_calculate_effective_pressure);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_rxn);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rxn);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_rxn);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rxn);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Peff, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+179:             self.kf[j] = rxn.getRateCoefficient(self.T.value_si, Peff)</pre>
<pre class='cython code score-36'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_getRateCoefficient);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;T-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_2) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Peff);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_v_Peff);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Peff);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.kf), __pyx_v_j, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;180: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+181:             if rxn.reversible:</pre>
<pre class='cython code score-5'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_reversible);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_10) {
</pre><pre class='cython line score-37' onclick='toggleDiv(this)'>+182:                 self.Keq[j] = rxn.getEquilibriumConstant(self.T.value_si)</pre>
<pre class='cython code score-37'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_getEquilibriumConstant);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;T-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.Keq), __pyx_v_j, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+183:                 self.kb[j] = self.kf[j] / self.Keq[j]</pre>
<pre class='cython code score-20'>      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.kf), __pyx_v_j);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.Keq), __pyx_v_j);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.kb), __pyx_v_j, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;184: </pre>
<pre class='cython line score-0'>&#xA0;185: </pre>
<pre class='cython line score-51' onclick='toggleDiv(this)'>+186:     def set_colliders(self, coreReactions, edgeReactions, coreSpecies):</pre>
<pre class='cython code score-51'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_13set_colliders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_12set_colliders[] = "\n        Store collider efficiencies and reaction indices for pdep reactions that have specific collider efficiencies.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_13set_colliders(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coreReactions = 0;
  PyObject *__pyx_v_edgeReactions = 0;
  PyObject *__pyx_v_coreSpecies = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_colliders (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coreReactions,&amp;__pyx_n_s_edgeReactions,&amp;__pyx_n_s_coreSpecies,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_coreReactions)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_edgeReactions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_colliders", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_coreSpecies)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_colliders", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_colliders") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_coreReactions = values[0];
    __pyx_v_edgeReactions = values[1];
    __pyx_v_coreSpecies = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("set_colliders", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.set_colliders", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_12set_colliders(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_coreReactions, __pyx_v_edgeReactions, __pyx_v_coreSpecies);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_12set_colliders(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, PyObject *__pyx_v_coreReactions, PyObject *__pyx_v_edgeReactions, PyObject *__pyx_v_coreSpecies) {
  PyObject *__pyx_v_pdepColliderReactionIndices = NULL;
  PyObject *__pyx_v_colliderEfficiencies = NULL;
  PyObject *__pyx_v_rxn = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_colliders", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.set_colliders", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxn);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;187:         """</pre>
<pre class='cython line score-0'>&#xA0;188:         Store collider efficiencies and reaction indices for pdep reactions that have specific collider efficiencies.</pre>
<pre class='cython line score-0'>&#xA0;189:         """</pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+190:         pdepColliderReactionIndices = []</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pdepColliderReactionIndices = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+191:         self.pdepColliderKinetics = []</pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;pdepColliderKinetics);
  __pyx_v_self-&gt;pdepColliderKinetics = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+192:         colliderEfficiencies = []</pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_colliderEfficiencies = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;193: </pre>
<pre class='cython line score-76' onclick='toggleDiv(this)'>+194:         for rxn in itertools.chain(coreReactions, edgeReactions):</pre>
<pre class='cython code score-76'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_chain);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_coreReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreReactions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_edgeReactions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_edgeReactions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_edgeReactions);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rxn, __pyx_t_1);
    __pyx_t_1 = 0;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+195:             if rxn.kinetics.isPressureDependent():</pre>
<pre class='cython code score-24'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_isPressureDependent);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_7) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+196:                 if rxn.kinetics.efficiencies:</pre>
<pre class='cython code score-8'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_efficiencies);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_7) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+197:                     j = self.reactionIndex[rxn]</pre>
<pre class='cython code score-8'>        if (unlikely(__pyx_v_self-&gt;__pyx_base.reactionIndex == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;__pyx_base.reactionIndex, __pyx_v_rxn);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_2);
        __pyx_t_2 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+198:                     pdepColliderReactionIndices.append(j)</pre>
<pre class='cython code score-2'>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_pdepColliderReactionIndices, __pyx_v_j);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+199:                     self.pdepColliderKinetics.append(rxn.kinetics)</pre>
<pre class='cython code score-10'>        if (unlikely(__pyx_v_self-&gt;pdepColliderKinetics == Py_None)) {
          <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_self-&gt;pdepColliderKinetics, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+200:                     colliderEfficiencies.append(rxn.kinetics.getEffectiveColliderEfficiencies(coreSpecies))</pre>
<pre class='cython code score-32'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rxn, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_getEffectiveColliderEfficiencies);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          }
        }
        if (!__pyx_t_1) {
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_coreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coreSpecies);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_coreSpecies);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coreSpecies);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_colliderEfficiencies, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;201: </pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+202:         self.pdepColliderReactionIndices = numpy.array(pdepColliderReactionIndices, numpy.int)</pre>
<pre class='cython code score-36'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdepColliderReactionIndices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_4, __pyx_v_pdepColliderReactionIndices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pdepColliderReactionIndices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_4, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices));
  __pyx_v_self-&gt;pdepColliderReactionIndices = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+203:         self.colliderEfficiencies = numpy.array(colliderEfficiencies, numpy.float64)</pre>
<pre class='cython code score-36'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_5) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_colliderEfficiencies);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_4, __pyx_v_colliderEfficiencies);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_colliderEfficiencies);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_4, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;colliderEfficiencies));
  __pyx_v_self-&gt;colliderEfficiencies = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;204: </pre>
<pre class='cython line score-0'>&#xA0;205: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+206:     def set_initial_conditions(self):</pre>
<pre class='cython code score-12'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_15set_initial_conditions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_14set_initial_conditions[] = "\n        Sets the initial conditions of the rate equations that represent the \n        current reactor model.\n\n        The volume is set to the value derived from the ideal gas law, using the \n        user-defined pressure, temperature, and the number of moles of initial species.\n\n        The species moles array (y0) is set to the values stored in the\n        initial mole fractions dictionary.\n\n        The initial species concentration is computed and stored in the\n        coreSpeciesConcentrations array.\n\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_15set_initial_conditions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_initial_conditions (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14set_initial_conditions(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_14set_initial_conditions(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self) {
  PyObject *__pyx_v_spec = NULL;
  PyObject *__pyx_v_moleFrac = NULL;
  PyObject *__pyx_v_i = NULL;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_initial_conditions", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.set_initial_conditions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_moleFrac);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;207:         """</pre>
<pre class='cython line score-0'>&#xA0;208:         Sets the initial conditions of the rate equations that represent the</pre>
<pre class='cython line score-0'>&#xA0;209:         current reactor model.</pre>
<pre class='cython line score-0'>&#xA0;210: </pre>
<pre class='cython line score-0'>&#xA0;211:         The volume is set to the value derived from the ideal gas law, using the</pre>
<pre class='cython line score-0'>&#xA0;212:         user-defined pressure, temperature, and the number of moles of initial species.</pre>
<pre class='cython line score-0'>&#xA0;213: </pre>
<pre class='cython line score-0'>&#xA0;214:         The species moles array (y0) is set to the values stored in the</pre>
<pre class='cython line score-0'>&#xA0;215:         initial mole fractions dictionary.</pre>
<pre class='cython line score-0'>&#xA0;216: </pre>
<pre class='cython line score-0'>&#xA0;217:         The initial species concentration is computed and stored in the</pre>
<pre class='cython line score-0'>&#xA0;218:         coreSpeciesConcentrations array.</pre>
<pre class='cython line score-0'>&#xA0;219: </pre>
<pre class='cython line score-0'>&#xA0;220:         """</pre>
<pre class='cython line score-0'>&#xA0;221: </pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+222:         ReactionSystem.set_initial_conditions(self)</pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_set_initial_conditions);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;223: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+224:         for spec, moleFrac in self.initialMoleFractions.iteritems():</pre>
<pre class='cython code score-8'>  __pyx_t_5 = 0;
  if (unlikely(__pyx_v_self-&gt;initialMoleFractions == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "iteritems");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_self-&gt;initialMoleFractions, 1, __pyx_n_s_iteritems, (&amp;__pyx_t_6), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __pyx_t_1 = __pyx_t_2;
  __pyx_t_2 = 0;
  while (1) {
    __pyx_t_8 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_6, &amp;__pyx_t_5, &amp;__pyx_t_2, &amp;__pyx_t_4, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_8 == 0)) break;
    if (unlikely(__pyx_t_8 == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_spec, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_moleFrac, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+225:             i = self.get_species_index(spec)</pre>
<pre class='cython code score-27'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_species_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_spec);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_spec);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_spec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_spec);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+226:             self.y0[i] = moleFrac</pre>
<pre class='cython code score-6'>    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.y0), __pyx_v_i, __pyx_v_moleFrac) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;227: </pre>
<pre class='cython line score-0'>&#xA0;228:         # Use ideal gas law to compute volume</pre>
<pre class='cython line score-58' onclick='toggleDiv(this)'>+229:         self.V = constants.R * self.T.value_si * numpy.sum(self.y0[:self.numCoreSpecies]) / self.P.value_si# volume in m^3</pre>
<pre class='cython code score-58'>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_5rmgpy_9constants_R * __pyx_v_self-&gt;T-&gt;value_si));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.y0), 0, __pyx_v_self-&gt;__pyx_base.numCoreSpecies, NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;P-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;V = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+230:         for j in xrange(self.numCoreSpecies):</pre>
<pre class='cython code score-0'>  __pyx_t_7 = __pyx_v_self-&gt;__pyx_base.numCoreSpecies;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_j = __pyx_t_8;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+231:             self.coreSpeciesConcentrations[j] = self.y0[j] / self.V</pre>
<pre class='cython code score-14'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.y0), __pyx_v_j, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;V);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations), __pyx_v_j, __pyx_t_9, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
</pre><pre class='cython line score-0'>&#xA0;232: </pre>
<pre class='cython line score-0'>&#xA0;233:     @cython.boundscheck(False)</pre>
<pre class='cython line score-230' onclick='toggleDiv(this)'>+234:     def residual(self, double t, numpy.ndarray[numpy.float64_t, ndim=1] y, numpy.ndarray[numpy.float64_t, ndim=1] dydt, numpy.ndarray[numpy.float64_t, ndim=1] senpar = numpy.zeros(1, numpy.float64)):</pre>
<pre class='cython code score-230'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_17residual(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_16residual[] = "\n        Return the residual function for the governing DAE system for the\n        simple reaction system.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_17residual(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t;
  PyArrayObject *__pyx_v_y = 0;
  PyArrayObject *__pyx_v_dydt = 0;
  PyArrayObject *__pyx_v_senpar = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("residual (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dydt,&amp;__pyx_n_s_senpar,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = (PyObject *)__pyx_k_;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("residual", 0, 3, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dydt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("residual", 0, 3, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_senpar);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "residual") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_y = ((PyArrayObject *)values[1]);
    __pyx_v_dydt = ((PyArrayObject *)values[2]);
    __pyx_v_senpar = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("residual", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_y), __pyx_ptype_5numpy_ndarray, 1, "y", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_dydt), __pyx_ptype_5numpy_ndarray, 1, "dydt", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_senpar), __pyx_ptype_5numpy_ndarray, 1, "senpar", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_16residual(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_t, __pyx_v_y, __pyx_v_dydt, __pyx_v_senpar);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_16residual(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, double __pyx_v_t, PyArrayObject *__pyx_v_y, PyArrayObject *__pyx_v_dydt, PyArrayObject *__pyx_v_senpar) {
  PyArrayObject *__pyx_v_ir = 0;
  PyArrayObject *__pyx_v_ip = 0;
  PyArrayObject *__pyx_v_inet = 0;
  PyArrayObject *__pyx_v_res = 0;
  PyArrayObject *__pyx_v_kf = 0;
  PyArrayObject *__pyx_v_kr = 0;
  PyArrayObject *__pyx_v_knet = 0;
  PyArrayObject *__pyx_v_delta = 0;
  PyArrayObject *__pyx_v_equilibriumConstants = 0;
  int __pyx_v_numCoreSpecies;
  int __pyx_v_numCoreReactions;
  CYTHON_UNUSED int __pyx_v_numEdgeSpecies;
  CYTHON_UNUSED int __pyx_v_numEdgeReactions;
  CYTHON_UNUSED int __pyx_v_numPdepNetworks;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_z;
  int __pyx_v_first;
  int __pyx_v_second;
  int __pyx_v_third;
  double __pyx_v_k;
  double __pyx_v_V;
  double __pyx_v_reactionRate;
  double __pyx_v_T;
  double __pyx_v_P;
  double __pyx_v_Peff;
  PyArrayObject *__pyx_v_coreSpeciesConcentrations = 0;
  PyArrayObject *__pyx_v_coreSpeciesRates = 0;
  PyArrayObject *__pyx_v_coreReactionRates = 0;
  PyArrayObject *__pyx_v_edgeSpeciesRates = 0;
  PyArrayObject *__pyx_v_edgeReactionRates = 0;
  PyArrayObject *__pyx_v_networkLeakRates = 0;
  PyArrayObject *__pyx_v_C = 0;
  PyArrayObject *__pyx_v_y_coreSpecies = 0;
  PyArrayObject *__pyx_v_jacobian = 0;
  PyArrayObject *__pyx_v_dgdk = 0;
  PyArrayObject *__pyx_v_colliderEfficiencies = 0;
  PyArrayObject *__pyx_v_pdepColliderReactionIndices = 0;
  PyObject *__pyx_v_pdepColliderKinetics = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_C;
  __Pyx_Buffer __pyx_pybuffer_C;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_colliderEfficiencies;
  __Pyx_Buffer __pyx_pybuffer_colliderEfficiencies;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_coreReactionRates;
  __Pyx_Buffer __pyx_pybuffer_coreReactionRates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_coreSpeciesConcentrations;
  __Pyx_Buffer __pyx_pybuffer_coreSpeciesConcentrations;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_coreSpeciesRates;
  __Pyx_Buffer __pyx_pybuffer_coreSpeciesRates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_delta;
  __Pyx_Buffer __pyx_pybuffer_delta;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dgdk;
  __Pyx_Buffer __pyx_pybuffer_dgdk;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dydt;
  __Pyx_Buffer __pyx_pybuffer_dydt;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_edgeReactionRates;
  __Pyx_Buffer __pyx_pybuffer_edgeReactionRates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_edgeSpeciesRates;
  __Pyx_Buffer __pyx_pybuffer_edgeSpeciesRates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_equilibriumConstants;
  __Pyx_Buffer __pyx_pybuffer_equilibriumConstants;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_inet;
  __Pyx_Buffer __pyx_pybuffer_inet;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ip;
  __Pyx_Buffer __pyx_pybuffer_ip;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ir;
  __Pyx_Buffer __pyx_pybuffer_ir;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_jacobian;
  __Pyx_Buffer __pyx_pybuffer_jacobian;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kf;
  __Pyx_Buffer __pyx_pybuffer_kf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_knet;
  __Pyx_Buffer __pyx_pybuffer_knet;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kr;
  __Pyx_Buffer __pyx_pybuffer_kr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_networkLeakRates;
  __Pyx_Buffer __pyx_pybuffer_networkLeakRates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_pdepColliderReactionIndices;
  __Pyx_Buffer __pyx_pybuffer_pdepColliderReactionIndices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_res;
  __Pyx_Buffer __pyx_pybuffer_res;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_senpar;
  __Pyx_Buffer __pyx_pybuffer_senpar;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_y;
  __Pyx_Buffer __pyx_pybuffer_y;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_y_coreSpecies;
  __Pyx_Buffer __pyx_pybuffer_y_coreSpecies;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("residual", 0);
  __pyx_pybuffer_ir.pybuffer.buf = NULL;
  __pyx_pybuffer_ir.refcount = 0;
  __pyx_pybuffernd_ir.data = NULL;
  __pyx_pybuffernd_ir.rcbuffer = &amp;__pyx_pybuffer_ir;
  __pyx_pybuffer_ip.pybuffer.buf = NULL;
  __pyx_pybuffer_ip.refcount = 0;
  __pyx_pybuffernd_ip.data = NULL;
  __pyx_pybuffernd_ip.rcbuffer = &amp;__pyx_pybuffer_ip;
  __pyx_pybuffer_inet.pybuffer.buf = NULL;
  __pyx_pybuffer_inet.refcount = 0;
  __pyx_pybuffernd_inet.data = NULL;
  __pyx_pybuffernd_inet.rcbuffer = &amp;__pyx_pybuffer_inet;
  __pyx_pybuffer_res.pybuffer.buf = NULL;
  __pyx_pybuffer_res.refcount = 0;
  __pyx_pybuffernd_res.data = NULL;
  __pyx_pybuffernd_res.rcbuffer = &amp;__pyx_pybuffer_res;
  __pyx_pybuffer_kf.pybuffer.buf = NULL;
  __pyx_pybuffer_kf.refcount = 0;
  __pyx_pybuffernd_kf.data = NULL;
  __pyx_pybuffernd_kf.rcbuffer = &amp;__pyx_pybuffer_kf;
  __pyx_pybuffer_kr.pybuffer.buf = NULL;
  __pyx_pybuffer_kr.refcount = 0;
  __pyx_pybuffernd_kr.data = NULL;
  __pyx_pybuffernd_kr.rcbuffer = &amp;__pyx_pybuffer_kr;
  __pyx_pybuffer_knet.pybuffer.buf = NULL;
  __pyx_pybuffer_knet.refcount = 0;
  __pyx_pybuffernd_knet.data = NULL;
  __pyx_pybuffernd_knet.rcbuffer = &amp;__pyx_pybuffer_knet;
  __pyx_pybuffer_delta.pybuffer.buf = NULL;
  __pyx_pybuffer_delta.refcount = 0;
  __pyx_pybuffernd_delta.data = NULL;
  __pyx_pybuffernd_delta.rcbuffer = &amp;__pyx_pybuffer_delta;
  __pyx_pybuffer_equilibriumConstants.pybuffer.buf = NULL;
  __pyx_pybuffer_equilibriumConstants.refcount = 0;
  __pyx_pybuffernd_equilibriumConstants.data = NULL;
  __pyx_pybuffernd_equilibriumConstants.rcbuffer = &amp;__pyx_pybuffer_equilibriumConstants;
  __pyx_pybuffer_coreSpeciesConcentrations.pybuffer.buf = NULL;
  __pyx_pybuffer_coreSpeciesConcentrations.refcount = 0;
  __pyx_pybuffernd_coreSpeciesConcentrations.data = NULL;
  __pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer = &amp;__pyx_pybuffer_coreSpeciesConcentrations;
  __pyx_pybuffer_coreSpeciesRates.pybuffer.buf = NULL;
  __pyx_pybuffer_coreSpeciesRates.refcount = 0;
  __pyx_pybuffernd_coreSpeciesRates.data = NULL;
  __pyx_pybuffernd_coreSpeciesRates.rcbuffer = &amp;__pyx_pybuffer_coreSpeciesRates;
  __pyx_pybuffer_coreReactionRates.pybuffer.buf = NULL;
  __pyx_pybuffer_coreReactionRates.refcount = 0;
  __pyx_pybuffernd_coreReactionRates.data = NULL;
  __pyx_pybuffernd_coreReactionRates.rcbuffer = &amp;__pyx_pybuffer_coreReactionRates;
  __pyx_pybuffer_edgeSpeciesRates.pybuffer.buf = NULL;
  __pyx_pybuffer_edgeSpeciesRates.refcount = 0;
  __pyx_pybuffernd_edgeSpeciesRates.data = NULL;
  __pyx_pybuffernd_edgeSpeciesRates.rcbuffer = &amp;__pyx_pybuffer_edgeSpeciesRates;
  __pyx_pybuffer_edgeReactionRates.pybuffer.buf = NULL;
  __pyx_pybuffer_edgeReactionRates.refcount = 0;
  __pyx_pybuffernd_edgeReactionRates.data = NULL;
  __pyx_pybuffernd_edgeReactionRates.rcbuffer = &amp;__pyx_pybuffer_edgeReactionRates;
  __pyx_pybuffer_networkLeakRates.pybuffer.buf = NULL;
  __pyx_pybuffer_networkLeakRates.refcount = 0;
  __pyx_pybuffernd_networkLeakRates.data = NULL;
  __pyx_pybuffernd_networkLeakRates.rcbuffer = &amp;__pyx_pybuffer_networkLeakRates;
  __pyx_pybuffer_C.pybuffer.buf = NULL;
  __pyx_pybuffer_C.refcount = 0;
  __pyx_pybuffernd_C.data = NULL;
  __pyx_pybuffernd_C.rcbuffer = &amp;__pyx_pybuffer_C;
  __pyx_pybuffer_y_coreSpecies.pybuffer.buf = NULL;
  __pyx_pybuffer_y_coreSpecies.refcount = 0;
  __pyx_pybuffernd_y_coreSpecies.data = NULL;
  __pyx_pybuffernd_y_coreSpecies.rcbuffer = &amp;__pyx_pybuffer_y_coreSpecies;
  __pyx_pybuffer_jacobian.pybuffer.buf = NULL;
  __pyx_pybuffer_jacobian.refcount = 0;
  __pyx_pybuffernd_jacobian.data = NULL;
  __pyx_pybuffernd_jacobian.rcbuffer = &amp;__pyx_pybuffer_jacobian;
  __pyx_pybuffer_dgdk.pybuffer.buf = NULL;
  __pyx_pybuffer_dgdk.refcount = 0;
  __pyx_pybuffernd_dgdk.data = NULL;
  __pyx_pybuffernd_dgdk.rcbuffer = &amp;__pyx_pybuffer_dgdk;
  __pyx_pybuffer_colliderEfficiencies.pybuffer.buf = NULL;
  __pyx_pybuffer_colliderEfficiencies.refcount = 0;
  __pyx_pybuffernd_colliderEfficiencies.data = NULL;
  __pyx_pybuffernd_colliderEfficiencies.rcbuffer = &amp;__pyx_pybuffer_colliderEfficiencies;
  __pyx_pybuffer_pdepColliderReactionIndices.pybuffer.buf = NULL;
  __pyx_pybuffer_pdepColliderReactionIndices.refcount = 0;
  __pyx_pybuffernd_pdepColliderReactionIndices.data = NULL;
  __pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer = &amp;__pyx_pybuffer_pdepColliderReactionIndices;
  __pyx_pybuffer_y.pybuffer.buf = NULL;
  __pyx_pybuffer_y.refcount = 0;
  __pyx_pybuffernd_y.data = NULL;
  __pyx_pybuffernd_y.rcbuffer = &amp;__pyx_pybuffer_y;
  __pyx_pybuffer_dydt.pybuffer.buf = NULL;
  __pyx_pybuffer_dydt.refcount = 0;
  __pyx_pybuffernd_dydt.data = NULL;
  __pyx_pybuffernd_dydt.rcbuffer = &amp;__pyx_pybuffer_dydt;
  __pyx_pybuffer_senpar.pybuffer.buf = NULL;
  __pyx_pybuffer_senpar.refcount = 0;
  __pyx_pybuffernd_senpar.data = NULL;
  __pyx_pybuffernd_senpar.rcbuffer = &amp;__pyx_pybuffer_senpar;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_y, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_y.diminfo[0].strides = __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_y.diminfo[0].shape = __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_dydt, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_dydt.diminfo[0].strides = __pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dydt.diminfo[0].shape = __pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_senpar, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_senpar.diminfo[0].strides = __pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_senpar.diminfo[0].shape = __pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer.shape[0];
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.residual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ir);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ip);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_inet);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_res);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_knet);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_delta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_equilibriumConstants);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_coreSpeciesConcentrations);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_coreSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_coreReactionRates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_edgeSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_edgeReactionRates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_networkLeakRates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_y_coreSpecies);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_jacobian);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dgdk);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_colliderEfficiencies);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_pdepColliderReactionIndices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pdepColliderKinetics);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_4) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_k_ = ((PyArrayObject *)__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;235: </pre>
<pre class='cython line score-0'>&#xA0;236:         """</pre>
<pre class='cython line score-0'>&#xA0;237:         Return the residual function for the governing DAE system for the</pre>
<pre class='cython line score-0'>&#xA0;238:         simple reaction system.</pre>
<pre class='cython line score-0'>&#xA0;239:         """</pre>
<pre class='cython line score-0'>&#xA0;240:         cdef numpy.ndarray[numpy.int_t, ndim=2] ir, ip, inet</pre>
<pre class='cython line score-0'>&#xA0;241:         cdef numpy.ndarray[numpy.float64_t, ndim=1] res, kf, kr, knet, delta, equilibriumConstants</pre>
<pre class='cython line score-0'>&#xA0;242:         cdef int numCoreSpecies, numCoreReactions, numEdgeSpecies, numEdgeReactions, numPdepNetworks</pre>
<pre class='cython line score-0'>&#xA0;243:         cdef int i, j, z, first, second, third</pre>
<pre class='cython line score-0'>&#xA0;244:         cdef double k, V, reactionRate, T, P, Peff</pre>
<pre class='cython line score-0'>&#xA0;245:         cdef numpy.ndarray[numpy.float64_t, ndim=1] coreSpeciesConcentrations, coreSpeciesRates, coreReactionRates, edgeSpeciesRates, edgeReactionRates, networkLeakRates</pre>
<pre class='cython line score-0'>&#xA0;246:         cdef numpy.ndarray[numpy.float64_t, ndim=1] C, y_coreSpecies</pre>
<pre class='cython line score-0'>&#xA0;247:         cdef numpy.ndarray[numpy.float64_t, ndim=2] jacobian, dgdk, colliderEfficiencies</pre>
<pre class='cython line score-0'>&#xA0;248:         cdef numpy.ndarray[numpy.int_t, ndim=1] pdepColliderReactionIndices</pre>
<pre class='cython line score-0'>&#xA0;249:         cdef list pdepColliderKinetics</pre>
<pre class='cython line score-0'>&#xA0;250: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+251:         ir = self.reactantIndices</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.reactantIndices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_ir, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_ir.diminfo[0].strides = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ir.diminfo[0].shape = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_ir.diminfo[1].strides = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_ir.diminfo[1].shape = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_ir = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+252:         ip = self.productIndices</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.productIndices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_ip, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_ip.diminfo[0].strides = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ip.diminfo[0].shape = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_ip.diminfo[1].strides = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_ip.diminfo[1].shape = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_ip = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;253: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+254:         numCoreSpecies = len(self.coreSpeciesRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numCoreSpecies = __pyx_t_6;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+255:         numCoreReactions = len(self.coreReactionRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numCoreReactions = __pyx_t_6;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+256:         numEdgeSpecies = len(self.edgeSpeciesRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numEdgeSpecies = __pyx_t_6;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+257:         numEdgeReactions = len(self.edgeReactionRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numEdgeReactions = __pyx_t_6;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+258:         numPdepNetworks = len(self.networkLeakRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numPdepNetworks = __pyx_t_6;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+259:         kf = self.kf</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.kf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_kf = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+260:         kr = self.kb</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.kb);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_kr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;261: </pre>
<pre class='cython line score-22' onclick='toggleDiv(this)'>+262:         y_coreSpecies = y[:numCoreSpecies]</pre>
<pre class='cython code score-22'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_y), 0, __pyx_v_numCoreSpecies, NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_y_coreSpecies, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_y_coreSpecies.diminfo[0].strides = __pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_y_coreSpecies.diminfo[0].shape = __pyx_pybuffernd_y_coreSpecies.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_7 = 0;
  __pyx_v_y_coreSpecies = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;263: </pre>
<pre class='cython line score-0'>&#xA0;264:         # Recalculate any forward and reverse rate coefficients that involve pdep collision efficiencies</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+265:         if self.pdepColliderReactionIndices.shape[0] != 0:</pre>
<pre class='cython code score-0'>  __pyx_t_8 = (((__pyx_v_self-&gt;pdepColliderReactionIndices-&gt;dimensions[0]) != 0) != 0);
  if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+266:             T = self.T.value_si</pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_self-&gt;T-&gt;value_si;
    __pyx_v_T = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+267:             P = self.P.value_si</pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_self-&gt;P-&gt;value_si;
    __pyx_v_P = __pyx_t_9;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+268:             equilibriumConstants = self.Keq</pre>
<pre class='cython code score-19'>    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.Keq);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_equilibriumConstants, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
        }
      }
      __pyx_pybuffernd_equilibriumConstants.diminfo[0].strides = __pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_equilibriumConstants.diminfo[0].shape = __pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_equilibriumConstants = ((PyArrayObject *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+269:             pdepColliderReactionIndices = self.pdepColliderReactionIndices</pre>
<pre class='cython code score-19'>    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;pdepColliderReactionIndices);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_pdepColliderReactionIndices, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
        }
      }
      __pyx_pybuffernd_pdepColliderReactionIndices.diminfo[0].strides = __pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_pdepColliderReactionIndices.diminfo[0].shape = __pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_pdepColliderReactionIndices = ((PyArrayObject *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+270:             pdepColliderKinetics = self.pdepColliderKinetics</pre>
<pre class='cython code score-1'>    __pyx_t_1 = __pyx_v_self-&gt;pdepColliderKinetics;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_v_pdepColliderKinetics = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+271:             colliderEfficiencies = self.colliderEfficiencies</pre>
<pre class='cython code score-19'>    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;colliderEfficiencies);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_colliderEfficiencies, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
        }
      }
      __pyx_pybuffernd_colliderEfficiencies.diminfo[0].strides = __pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_colliderEfficiencies.diminfo[0].shape = __pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_colliderEfficiencies.diminfo[1].strides = __pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_colliderEfficiencies.diminfo[1].shape = __pyx_pybuffernd_colliderEfficiencies.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_colliderEfficiencies = ((PyArrayObject *)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+272:             for i in xrange(pdepColliderReactionIndices.shape[0]):</pre>
<pre class='cython code score-0'>    __pyx_t_10 = (__pyx_v_pdepColliderReactionIndices-&gt;dimensions[0]);
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_10; __pyx_t_2+=1) {
      __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;273:                 # Calculate effective pressure</pre>
<pre class='cython line score-88' onclick='toggleDiv(this)'>+274:                 Peff = P*numpy.sum(colliderEfficiencies[i]*y_coreSpecies / numpy.sum(y_coreSpecies))</pre>
<pre class='cython code score-88'>      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_P);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_colliderEfficiencies), __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, ((PyObject *)__pyx_v_y_coreSpecies));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
        __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
        if (likely(__pyx_t_15)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
        }
      }
      if (!__pyx_t_15) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, ((PyObject *)__pyx_v_y_coreSpecies));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_15); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); __pyx_t_15 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y_coreSpecies));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0+1, ((PyObject *)__pyx_v_y_coreSpecies));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y_coreSpecies));
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_14, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
        __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
        if (likely(__pyx_t_12)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
        }
      }
      if (!__pyx_t_12) {
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      } else {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_16);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
        __pyx_t_16 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13);<span class='error_goto'> if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_v_Peff = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+275:                 j = pdepColliderReactionIndices[i]</pre>
<pre class='cython code score-0'>      __pyx_t_18 = __pyx_v_i;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_pybuffernd_pdepColliderReactionIndices.diminfo[0].shape;
      __pyx_v_j = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_pdepColliderReactionIndices.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pdepColliderReactionIndices.diminfo[0].strides));
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+276:                 kf[j] = pdepColliderKinetics[i].getRateCoefficient(T, Peff)</pre>
<pre class='cython code score-48'>      if (unlikely(__pyx_v_pdepColliderKinetics == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_pdepColliderKinetics, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 1, 1, 0);<span class='error_goto'> if (unlikely(__pyx_t_11 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_getRateCoefficient);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Peff);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_16 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_16)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      if (__pyx_t_16) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_16); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16); __pyx_t_16 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_6, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_6, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      __pyx_t_11 = 0;
      __pyx_t_14 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13);<span class='error_goto'> if (unlikely((__pyx_t_19 == (npy_float64)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_20 = __pyx_v_j;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_pybuffernd_kf.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_kf.diminfo[0].strides) = __pyx_t_19;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+277:                 kr[j] = kf[j] / equilibriumConstants[j]</pre>
<pre class='cython code score-5'>      __pyx_t_21 = __pyx_v_j;
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_kf.diminfo[0].shape;
      __pyx_t_19 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_kf.diminfo[0].strides));
      __pyx_t_22 = __pyx_v_j;
      if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_equilibriumConstants.diminfo[0].shape;
      __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_equilibriumConstants.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_equilibriumConstants.diminfo[0].strides));
      if (unlikely(__pyx_t_23 == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_24 = __pyx_v_j;
      if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_kr.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_kr.diminfo[0].strides) = (__pyx_t_19 / __pyx_t_23);
    }
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;278: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+279:         inet = self.networkIndices</pre>
<pre class='cython code score-19'>  __pyx_t_13 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.networkIndices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_13), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_inet, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_inet.diminfo[0].strides = __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_inet.diminfo[0].shape = __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_inet.diminfo[1].strides = __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_inet.diminfo[1].shape = __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_inet = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+280:         knet = self.networkLeakCoefficients</pre>
<pre class='cython code score-19'>  __pyx_t_13 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakCoefficients);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_13), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_knet, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_knet.diminfo[0].strides = __pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_knet.diminfo[0].shape = __pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_knet = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-0'>&#xA0;281: </pre>
<pre class='cython line score-0'>&#xA0;282: </pre>
<pre class='cython line score-54' onclick='toggleDiv(this)'>+283:         res = numpy.zeros(numCoreSpecies, numpy.float64)</pre>
<pre class='cython code score-54'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numCoreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  if (__pyx_t_14) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0+__pyx_t_6, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1+__pyx_t_6, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  __pyx_t_1 = 0;
  __pyx_t_11 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_res, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_res.diminfo[0].strides = __pyx_pybuffernd_res.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_res.diminfo[0].shape = __pyx_pybuffernd_res.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_25 = 0;
  __pyx_v_res = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-0'>&#xA0;284: </pre>
<pre class='cython line score-49' onclick='toggleDiv(this)'>+285:         coreSpeciesConcentrations = numpy.zeros_like(self.coreSpeciesConcentrations)</pre>
<pre class='cython code score-49'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
    }
  }
  if (!__pyx_t_12) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_coreSpeciesConcentrations, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_coreSpeciesConcentrations.diminfo[0].strides = __pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_coreSpeciesConcentrations.diminfo[0].shape = __pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_coreSpeciesConcentrations = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+286:         coreSpeciesRates = numpy.zeros_like(self.coreSpeciesRates)</pre>
<pre class='cython code score-49'>  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_16)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  if (!__pyx_t_16) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_16); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16); __pyx_t_16 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_coreSpeciesRates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides = __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape = __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_coreSpeciesRates = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+287:         coreReactionRates = numpy.zeros_like(self.coreReactionRates)</pre>
<pre class='cython code score-49'>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_coreReactionRates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_coreReactionRates.diminfo[0].strides = __pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_coreReactionRates.diminfo[0].shape = __pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_coreReactionRates = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+288:         edgeSpeciesRates = numpy.zeros_like(self.edgeSpeciesRates)</pre>
<pre class='cython code score-49'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
    }
  }
  if (!__pyx_t_12) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_edgeSpeciesRates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides = __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape = __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_edgeSpeciesRates = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+289:         edgeReactionRates = numpy.zeros_like(self.edgeReactionRates)</pre>
<pre class='cython code score-49'>  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_16)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  if (!__pyx_t_16) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_16); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16); __pyx_t_16 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_edgeReactionRates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_edgeReactionRates.diminfo[0].strides = __pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_edgeReactionRates.diminfo[0].shape = __pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_edgeReactionRates = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+290:         networkLeakRates = numpy.zeros_like(self.networkLeakRates)</pre>
<pre class='cython code score-49'>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_networkLeakRates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_networkLeakRates.diminfo[0].strides = __pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_networkLeakRates.diminfo[0].shape = __pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_26 = 0;
  __pyx_v_networkLeakRates = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-0'>&#xA0;291: </pre>
<pre class='cython line score-49' onclick='toggleDiv(this)'>+292:         C = numpy.zeros_like(self.coreSpeciesConcentrations)</pre>
<pre class='cython code score-49'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
    }
  }
  if (!__pyx_t_12) {
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  } else {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_C, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_C.diminfo[0].strides = __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_C.diminfo[0].shape = __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_7 = 0;
  __pyx_v_C = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='cython line score-0'>&#xA0;293: </pre>
<pre class='cython line score-0'>&#xA0;294:         # Use ideal gas law to compute volume</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+295:         V = constants.R * self.T.value_si * numpy.sum(y_coreSpecies) / self.P.value_si</pre>
<pre class='cython code score-56'>  __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_5rmgpy_9constants_R * __pyx_v_self-&gt;T-&gt;value_si));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_y_coreSpecies));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y_coreSpecies));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, ((PyObject *)__pyx_v_y_coreSpecies));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y_coreSpecies));
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;P-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_12, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13);<span class='error_goto'> if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_V = __pyx_t_9;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+296:         self.V = V</pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;V = __pyx_v_V;
</pre><pre class='cython line score-0'>&#xA0;297: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+298:         for j in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_numCoreSpecies;
  for (__pyx_t_27 = 0; __pyx_t_27 &lt; __pyx_t_2; __pyx_t_27+=1) {
    __pyx_v_j = __pyx_t_27;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+299:             C[j] = y[j] / V</pre>
<pre class='cython code score-5'>    __pyx_t_28 = __pyx_v_j;
    if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_y.diminfo[0].shape;
    __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_y.diminfo[0].strides));
    if (unlikely(__pyx_v_V == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_29 = __pyx_v_j;
    if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_C.diminfo[0].shape;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_C.diminfo[0].strides) = (__pyx_t_23 / __pyx_v_V);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+300:             coreSpeciesConcentrations[j] = C[j]</pre>
<pre class='cython code score-0'>    __pyx_t_30 = __pyx_v_j;
    if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_C.diminfo[0].shape;
    __pyx_t_31 = __pyx_v_j;
    if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_coreSpeciesConcentrations.diminfo[0].shape;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesConcentrations.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_coreSpeciesConcentrations.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_C.diminfo[0].strides));
  }
</pre><pre class='cython line score-0'>&#xA0;301: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+302:         for j in xrange(ir.shape[0]):</pre>
<pre class='cython code score-0'>  __pyx_t_10 = (__pyx_v_ir-&gt;dimensions[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_10; __pyx_t_2+=1) {
    __pyx_v_j = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+303:             k = kf[j]</pre>
<pre class='cython code score-0'>    __pyx_t_27 = __pyx_v_j;
    if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_kf.diminfo[0].shape;
    __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_kf.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+304:             if ir[j,0] &gt;= numCoreSpecies or ir[j,1] &gt;= numCoreSpecies or ir[j,2] &gt;= numCoreSpecies:</pre>
<pre class='cython code score-0'>    __pyx_t_32 = __pyx_v_j;
    __pyx_t_33 = 0;
    if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_ir.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    if (!__pyx_t_34) {
      goto __pyx_L12_next_or;
    } else {
      __pyx_t_8 = __pyx_t_34;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_L12_next_or:;
    __pyx_t_35 = __pyx_v_j;
    __pyx_t_36 = 1;
    if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_ir.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    if (!__pyx_t_34) {
      goto __pyx_L13_next_or;
    } else {
      __pyx_t_8 = __pyx_t_34;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_L13_next_or:;
    __pyx_t_37 = __pyx_v_j;
    __pyx_t_38 = 2;
    if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_ir.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    __pyx_t_8 = __pyx_t_34;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+305:                 reactionRate = 0.0</pre>
<pre class='cython code score-0'>      __pyx_v_reactionRate = 0.0;
      goto __pyx_L10;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+306:             elif ir[j,1] == -1: # only one reactant</pre>
<pre class='cython code score-0'>    __pyx_t_39 = __pyx_v_j;
    __pyx_t_40 = 1;
    if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_ir.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+307:                 reactionRate = k * C[ir[j,0]]</pre>
<pre class='cython code score-0'>      __pyx_t_41 = __pyx_v_j;
      __pyx_t_42 = 0;
      if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_43 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_C.diminfo[0].strides)));
      goto __pyx_L10;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+308:             elif ir[j,2] == -1: # only two reactants</pre>
<pre class='cython code score-0'>    __pyx_t_44 = __pyx_v_j;
    __pyx_t_45 = 2;
    if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_45, __pyx_pybuffernd_ir.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+309:                 reactionRate = k * C[ir[j,0]] * C[ir[j,1]]</pre>
<pre class='cython code score-0'>      __pyx_t_46 = __pyx_v_j;
      __pyx_t_47 = 0;
      if (__pyx_t_46 &lt; 0) __pyx_t_46 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_47 &lt; 0) __pyx_t_47 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_48 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_48 &lt; 0) __pyx_t_48 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_49 = __pyx_v_j;
      __pyx_t_50 = 1;
      if (__pyx_t_49 &lt; 0) __pyx_t_49 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_50 &lt; 0) __pyx_t_50 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_51 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_50, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_51 &lt; 0) __pyx_t_51 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_C.diminfo[0].strides)));
      goto __pyx_L10;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;310:             else: # three reactants!! (really?)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+311:                 reactionRate = k * C[ir[j,0]] * C[ir[j,1]] * C[ir[j,2]]</pre>
<pre class='cython code score-0'>      __pyx_t_52 = __pyx_v_j;
      __pyx_t_53 = 0;
      if (__pyx_t_52 &lt; 0) __pyx_t_52 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_53 &lt; 0) __pyx_t_53 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_54 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_54 &lt; 0) __pyx_t_54 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_55 = __pyx_v_j;
      __pyx_t_56 = 1;
      if (__pyx_t_55 &lt; 0) __pyx_t_55 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_56 &lt; 0) __pyx_t_56 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_57 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_56, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_57 &lt; 0) __pyx_t_57 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_58 = __pyx_v_j;
      __pyx_t_59 = 2;
      if (__pyx_t_58 &lt; 0) __pyx_t_58 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_59 &lt; 0) __pyx_t_59 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_60 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_59, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_60 &lt; 0) __pyx_t_60 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_C.diminfo[0].strides)));
    }
    __pyx_L10:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+312:             k = kr[j]</pre>
<pre class='cython code score-0'>    __pyx_t_61 = __pyx_v_j;
    if (__pyx_t_61 &lt; 0) __pyx_t_61 += __pyx_pybuffernd_kr.diminfo[0].shape;
    __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_kr.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+313:             if ip[j,0] &gt;= numCoreSpecies or ip[j,1] &gt;= numCoreSpecies or ip[j,2] &gt;= numCoreSpecies:</pre>
<pre class='cython code score-0'>    __pyx_t_62 = __pyx_v_j;
    __pyx_t_63 = 0;
    if (__pyx_t_62 &lt; 0) __pyx_t_62 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_63 &lt; 0) __pyx_t_63 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_63, __pyx_pybuffernd_ip.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    if (!__pyx_t_34) {
      goto __pyx_L16_next_or;
    } else {
      __pyx_t_8 = __pyx_t_34;
      goto __pyx_L15_bool_binop_done;
    }
    __pyx_L16_next_or:;
    __pyx_t_64 = __pyx_v_j;
    __pyx_t_65 = 1;
    if (__pyx_t_64 &lt; 0) __pyx_t_64 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_65 &lt; 0) __pyx_t_65 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_65, __pyx_pybuffernd_ip.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    if (!__pyx_t_34) {
      goto __pyx_L17_next_or;
    } else {
      __pyx_t_8 = __pyx_t_34;
      goto __pyx_L15_bool_binop_done;
    }
    __pyx_L17_next_or:;
    __pyx_t_66 = __pyx_v_j;
    __pyx_t_67 = 2;
    if (__pyx_t_66 &lt; 0) __pyx_t_66 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_67 &lt; 0) __pyx_t_67 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_34 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_67, __pyx_pybuffernd_ip.diminfo[1].strides)) &gt;= __pyx_v_numCoreSpecies) != 0);
    __pyx_t_8 = __pyx_t_34;
    __pyx_L15_bool_binop_done:;
    if (__pyx_t_8) {
      goto __pyx_L14;
    }
</pre><pre class='cython line score-0'>&#xA0;314:                 pass</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+315:             elif ip[j,1] == -1: # only one reactant</pre>
<pre class='cython code score-0'>    __pyx_t_68 = __pyx_v_j;
    __pyx_t_69 = 1;
    if (__pyx_t_68 &lt; 0) __pyx_t_68 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_69 &lt; 0) __pyx_t_69 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_69, __pyx_pybuffernd_ip.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+316:                 reactionRate -= k * C[ip[j,0]]</pre>
<pre class='cython code score-0'>      __pyx_t_70 = __pyx_v_j;
      __pyx_t_71 = 0;
      if (__pyx_t_70 &lt; 0) __pyx_t_70 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_71 &lt; 0) __pyx_t_71 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_72 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_71, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_72 &lt; 0) __pyx_t_72 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (__pyx_v_reactionRate - (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_72, __pyx_pybuffernd_C.diminfo[0].strides))));
      goto __pyx_L14;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+317:             elif ip[j,2] == -1: # only two reactants</pre>
<pre class='cython code score-0'>    __pyx_t_73 = __pyx_v_j;
    __pyx_t_74 = 2;
    if (__pyx_t_73 &lt; 0) __pyx_t_73 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_74 &lt; 0) __pyx_t_74 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_74, __pyx_pybuffernd_ip.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+318:                 reactionRate -= k * C[ip[j,0]] * C[ip[j,1]]</pre>
<pre class='cython code score-0'>      __pyx_t_75 = __pyx_v_j;
      __pyx_t_76 = 0;
      if (__pyx_t_75 &lt; 0) __pyx_t_75 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_76 &lt; 0) __pyx_t_76 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_77 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_76, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_77 &lt; 0) __pyx_t_77 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_78 = __pyx_v_j;
      __pyx_t_79 = 1;
      if (__pyx_t_78 &lt; 0) __pyx_t_78 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_79 &lt; 0) __pyx_t_79 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_80 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_78, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_79, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_80 &lt; 0) __pyx_t_80 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (__pyx_v_reactionRate - ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_C.diminfo[0].strides))));
      goto __pyx_L14;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;319:             else: # three reactants!! (really?)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+320:                 reactionRate -= k * C[ip[j,0]] * C[ip[j,1]] * C[ip[j,2]]</pre>
<pre class='cython code score-0'>      __pyx_t_81 = __pyx_v_j;
      __pyx_t_82 = 0;
      if (__pyx_t_81 &lt; 0) __pyx_t_81 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_82 &lt; 0) __pyx_t_82 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_83 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_82, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_83 &lt; 0) __pyx_t_83 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_84 = __pyx_v_j;
      __pyx_t_85 = 1;
      if (__pyx_t_84 &lt; 0) __pyx_t_84 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_85 &lt; 0) __pyx_t_85 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_86 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_85, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_86 &lt; 0) __pyx_t_86 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_87 = __pyx_v_j;
      __pyx_t_88 = 2;
      if (__pyx_t_87 &lt; 0) __pyx_t_87 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_88 &lt; 0) __pyx_t_88 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_89 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_89 &lt; 0) __pyx_t_89 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (__pyx_v_reactionRate - (((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_C.diminfo[0].strides))));
    }
    __pyx_L14:;
</pre><pre class='cython line score-0'>&#xA0;321: </pre>
<pre class='cython line score-0'>&#xA0;322:             # Set the reaction and species rates</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+323:             if j &lt; numCoreReactions:</pre>
<pre class='cython code score-0'>    __pyx_t_8 = ((__pyx_v_j &lt; __pyx_v_numCoreReactions) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0'>&#xA0;324:                 # The reaction is a core reaction</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+325:                 coreReactionRates[j] = reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_90 = __pyx_v_j;
      if (__pyx_t_90 &lt; 0) __pyx_t_90 += __pyx_pybuffernd_coreReactionRates.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreReactionRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_90, __pyx_pybuffernd_coreReactionRates.diminfo[0].strides) = __pyx_v_reactionRate;
</pre><pre class='cython line score-0'>&#xA0;326: </pre>
<pre class='cython line score-0'>&#xA0;327:                 # Add/substract the total reaction rate from each species rate</pre>
<pre class='cython line score-0'>&#xA0;328:                 # Since it's a core reaction we know that all of its reactants</pre>
<pre class='cython line score-0'>&#xA0;329:                 # and products are core species</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+330:                 first = ir[j,0]</pre>
<pre class='cython code score-0'>      __pyx_t_91 = __pyx_v_j;
      __pyx_t_92 = 0;
      if (__pyx_t_91 &lt; 0) __pyx_t_91 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_92 &lt; 0) __pyx_t_92 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_v_first = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_92, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+331:                 coreSpeciesRates[first] -= reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_93 = __pyx_v_first;
      if (__pyx_t_93 &lt; 0) __pyx_t_93 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+332:                 second = ir[j,1]</pre>
<pre class='cython code score-0'>      __pyx_t_94 = __pyx_v_j;
      __pyx_t_95 = 1;
      if (__pyx_t_94 &lt; 0) __pyx_t_94 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_95 &lt; 0) __pyx_t_95 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_v_second = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_95, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+333:                 if second != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_second != -1) != 0);
      if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+334:                     coreSpeciesRates[second] -= reactionRate</pre>
<pre class='cython code score-0'>        __pyx_t_96 = __pyx_v_second;
        if (__pyx_t_96 &lt; 0) __pyx_t_96 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+335:                     third = ir[j,2]</pre>
<pre class='cython code score-0'>        __pyx_t_97 = __pyx_v_j;
        __pyx_t_98 = 2;
        if (__pyx_t_97 &lt; 0) __pyx_t_97 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_98 &lt; 0) __pyx_t_98 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_v_third = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_97, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_98, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+336:                     if third != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_third != -1) != 0);
        if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+337:                         coreSpeciesRates[third] -= reactionRate</pre>
<pre class='cython code score-0'>          __pyx_t_99 = __pyx_v_third;
          if (__pyx_t_99 &lt; 0) __pyx_t_99 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
          goto __pyx_L20;
        }
        __pyx_L20:;
        goto __pyx_L19;
      }
      __pyx_L19:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+338:                 first = ip[j,0]</pre>
<pre class='cython code score-0'>      __pyx_t_100 = __pyx_v_j;
      __pyx_t_101 = 0;
      if (__pyx_t_100 &lt; 0) __pyx_t_100 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_101 &lt; 0) __pyx_t_101 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_v_first = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+339:                 coreSpeciesRates[first] += reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_102 = __pyx_v_first;
      if (__pyx_t_102 &lt; 0) __pyx_t_102 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_102, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+340:                 second = ip[j,1]</pre>
<pre class='cython code score-0'>      __pyx_t_103 = __pyx_v_j;
      __pyx_t_104 = 1;
      if (__pyx_t_103 &lt; 0) __pyx_t_103 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_104 &lt; 0) __pyx_t_104 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_v_second = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_104, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+341:                 if second != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_second != -1) != 0);
      if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+342:                     coreSpeciesRates[second] += reactionRate</pre>
<pre class='cython code score-0'>        __pyx_t_105 = __pyx_v_second;
        if (__pyx_t_105 &lt; 0) __pyx_t_105 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+343:                     third = ip[j,2]</pre>
<pre class='cython code score-0'>        __pyx_t_106 = __pyx_v_j;
        __pyx_t_107 = 2;
        if (__pyx_t_106 &lt; 0) __pyx_t_106 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_107 &lt; 0) __pyx_t_107 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_v_third = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_106, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_107, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+344:                     if third != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_third != -1) != 0);
        if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+345:                         coreSpeciesRates[third] += reactionRate</pre>
<pre class='cython code score-0'>          __pyx_t_108 = __pyx_v_third;
          if (__pyx_t_108 &lt; 0) __pyx_t_108 += __pyx_pybuffernd_coreSpeciesRates.diminfo[0].shape;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_coreSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_coreSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
          goto __pyx_L22;
        }
        __pyx_L22:;
        goto __pyx_L21;
      }
      __pyx_L21:;
      goto __pyx_L18;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;346: </pre>
<pre class='cython line score-0'>&#xA0;347:             else:</pre>
<pre class='cython line score-0'>&#xA0;348:                 # The reaction is an edge reaction</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+349:                 edgeReactionRates[j-numCoreReactions] = reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_109 = (__pyx_v_j - __pyx_v_numCoreReactions);
      if (__pyx_t_109 &lt; 0) __pyx_t_109 += __pyx_pybuffernd_edgeReactionRates.diminfo[0].shape;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeReactionRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_109, __pyx_pybuffernd_edgeReactionRates.diminfo[0].strides) = __pyx_v_reactionRate;
</pre><pre class='cython line score-0'>&#xA0;350: </pre>
<pre class='cython line score-0'>&#xA0;351:                 # Add/substract the total reaction rate from each species rate</pre>
<pre class='cython line score-0'>&#xA0;352:                 # Since it's an edge reaction its reactants and products could</pre>
<pre class='cython line score-0'>&#xA0;353:                 # be either core or edge species</pre>
<pre class='cython line score-0'>&#xA0;354:                 # We're only interested in the edge species</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+355:                 first = ir[j,0]</pre>
<pre class='cython code score-0'>      __pyx_t_110 = __pyx_v_j;
      __pyx_t_111 = 0;
      if (__pyx_t_110 &lt; 0) __pyx_t_110 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_111 &lt; 0) __pyx_t_111 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_v_first = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_110, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_111, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+356:                 if first &gt;= numCoreSpecies: edgeSpeciesRates[first-numCoreSpecies] -= reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_first &gt;= __pyx_v_numCoreSpecies) != 0);
      if (__pyx_t_8) {
        __pyx_t_112 = (__pyx_v_first - __pyx_v_numCoreSpecies);
        if (__pyx_t_112 &lt; 0) __pyx_t_112 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_112, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
        goto __pyx_L23;
      }
      __pyx_L23:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+357:                 second = ir[j,1]</pre>
<pre class='cython code score-0'>      __pyx_t_113 = __pyx_v_j;
      __pyx_t_114 = 1;
      if (__pyx_t_113 &lt; 0) __pyx_t_113 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_114 &lt; 0) __pyx_t_114 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_v_second = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_113, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_114, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+358:                 if second != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_second != -1) != 0);
      if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+359:                     if second &gt;= numCoreSpecies: edgeSpeciesRates[second-numCoreSpecies] -= reactionRate</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_second &gt;= __pyx_v_numCoreSpecies) != 0);
        if (__pyx_t_8) {
          __pyx_t_115 = (__pyx_v_second - __pyx_v_numCoreSpecies);
          if (__pyx_t_115 &lt; 0) __pyx_t_115 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_115, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
          goto __pyx_L25;
        }
        __pyx_L25:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+360:                     third = ir[j,2]</pre>
<pre class='cython code score-0'>        __pyx_t_116 = __pyx_v_j;
        __pyx_t_117 = 2;
        if (__pyx_t_116 &lt; 0) __pyx_t_116 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_117 &lt; 0) __pyx_t_117 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_v_third = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_116, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_117, __pyx_pybuffernd_ir.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+361:                     if third != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_third != -1) != 0);
        if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+362:                         if third &gt;= numCoreSpecies: edgeSpeciesRates[third-numCoreSpecies] -= reactionRate</pre>
<pre class='cython code score-0'>          __pyx_t_8 = ((__pyx_v_third &gt;= __pyx_v_numCoreSpecies) != 0);
          if (__pyx_t_8) {
            __pyx_t_118 = (__pyx_v_third - __pyx_v_numCoreSpecies);
            if (__pyx_t_118 &lt; 0) __pyx_t_118 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_118, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) -= __pyx_v_reactionRate;
            goto __pyx_L27;
          }
          __pyx_L27:;
          goto __pyx_L26;
        }
        __pyx_L26:;
        goto __pyx_L24;
      }
      __pyx_L24:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+363:                 first = ip[j,0]</pre>
<pre class='cython code score-0'>      __pyx_t_119 = __pyx_v_j;
      __pyx_t_120 = 0;
      if (__pyx_t_119 &lt; 0) __pyx_t_119 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_120 &lt; 0) __pyx_t_120 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_v_first = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_119, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_120, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+364:                 if first &gt;= numCoreSpecies: edgeSpeciesRates[first-numCoreSpecies] += reactionRate</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_first &gt;= __pyx_v_numCoreSpecies) != 0);
      if (__pyx_t_8) {
        __pyx_t_121 = (__pyx_v_first - __pyx_v_numCoreSpecies);
        if (__pyx_t_121 &lt; 0) __pyx_t_121 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
        goto __pyx_L28;
      }
      __pyx_L28:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+365:                 second = ip[j,1]</pre>
<pre class='cython code score-0'>      __pyx_t_122 = __pyx_v_j;
      __pyx_t_123 = 1;
      if (__pyx_t_122 &lt; 0) __pyx_t_122 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_123 &lt; 0) __pyx_t_123 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_v_second = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_122, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_123, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+366:                 if second != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_8 = ((__pyx_v_second != -1) != 0);
      if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+367:                     if second &gt;= numCoreSpecies: edgeSpeciesRates[second-numCoreSpecies] += reactionRate</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_second &gt;= __pyx_v_numCoreSpecies) != 0);
        if (__pyx_t_8) {
          __pyx_t_124 = (__pyx_v_second - __pyx_v_numCoreSpecies);
          if (__pyx_t_124 &lt; 0) __pyx_t_124 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
          goto __pyx_L30;
        }
        __pyx_L30:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+368:                     third = ip[j,2]</pre>
<pre class='cython code score-0'>        __pyx_t_125 = __pyx_v_j;
        __pyx_t_126 = 2;
        if (__pyx_t_125 &lt; 0) __pyx_t_125 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_126 &lt; 0) __pyx_t_126 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_v_third = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_125, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_126, __pyx_pybuffernd_ip.diminfo[1].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+369:                     if third != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_8 = ((__pyx_v_third != -1) != 0);
        if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+370:                         if third &gt;= numCoreSpecies: edgeSpeciesRates[third-numCoreSpecies] += reactionRate</pre>
<pre class='cython code score-0'>          __pyx_t_8 = ((__pyx_v_third &gt;= __pyx_v_numCoreSpecies) != 0);
          if (__pyx_t_8) {
            __pyx_t_127 = (__pyx_v_third - __pyx_v_numCoreSpecies);
            if (__pyx_t_127 &lt; 0) __pyx_t_127 += __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].shape;
            *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_edgeSpeciesRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_edgeSpeciesRates.diminfo[0].strides) += __pyx_v_reactionRate;
            goto __pyx_L32;
          }
          __pyx_L32:;
          goto __pyx_L31;
        }
        __pyx_L31:;
        goto __pyx_L29;
      }
      __pyx_L29:;
    }
    __pyx_L18:;
  }
</pre><pre class='cython line score-0'>&#xA0;371: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+372:         for j in xrange(inet.shape[0]):</pre>
<pre class='cython code score-0'>  __pyx_t_10 = (__pyx_v_inet-&gt;dimensions[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_10; __pyx_t_2+=1) {
    __pyx_v_j = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+373:             k = knet[j]</pre>
<pre class='cython code score-0'>    __pyx_t_128 = __pyx_v_j;
    if (__pyx_t_128 &lt; 0) __pyx_t_128 += __pyx_pybuffernd_knet.diminfo[0].shape;
    __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_knet.rcbuffer-&gt;pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_knet.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+374:             if inet[j,1] == -1: # only one reactant</pre>
<pre class='cython code score-0'>    __pyx_t_129 = __pyx_v_j;
    __pyx_t_130 = 1;
    if (__pyx_t_129 &lt; 0) __pyx_t_129 += __pyx_pybuffernd_inet.diminfo[0].shape;
    if (__pyx_t_130 &lt; 0) __pyx_t_130 += __pyx_pybuffernd_inet.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_129, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_130, __pyx_pybuffernd_inet.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+375:                 reactionRate = k * C[inet[j,0]]</pre>
<pre class='cython code score-0'>      __pyx_t_131 = __pyx_v_j;
      __pyx_t_132 = 0;
      if (__pyx_t_131 &lt; 0) __pyx_t_131 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_132 &lt; 0) __pyx_t_132 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_133 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_131, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_132, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_133 &lt; 0) __pyx_t_133 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_133, __pyx_pybuffernd_C.diminfo[0].strides)));
      goto __pyx_L35;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+376:             elif inet[j,2] == -1: # only two reactants</pre>
<pre class='cython code score-0'>    __pyx_t_134 = __pyx_v_j;
    __pyx_t_135 = 2;
    if (__pyx_t_134 &lt; 0) __pyx_t_134 += __pyx_pybuffernd_inet.diminfo[0].shape;
    if (__pyx_t_135 &lt; 0) __pyx_t_135 += __pyx_pybuffernd_inet.diminfo[1].shape;
    __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_134, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_135, __pyx_pybuffernd_inet.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_8) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+377:                 reactionRate = k * C[inet[j,0]] * C[inet[j,1]]</pre>
<pre class='cython code score-0'>      __pyx_t_136 = __pyx_v_j;
      __pyx_t_137 = 0;
      if (__pyx_t_136 &lt; 0) __pyx_t_136 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_137 &lt; 0) __pyx_t_137 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_138 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_136, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_137, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_138 &lt; 0) __pyx_t_138 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_139 = __pyx_v_j;
      __pyx_t_140 = 1;
      if (__pyx_t_139 &lt; 0) __pyx_t_139 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_140 &lt; 0) __pyx_t_140 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_141 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_139, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_140, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_141 &lt; 0) __pyx_t_141 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_138, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_C.diminfo[0].strides)));
      goto __pyx_L35;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;378:             else: # three reactants!! (really?)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+379:                 reactionRate = k * C[inet[j,0]] * C[inet[j,1]] * C[inet[j,2]]</pre>
<pre class='cython code score-0'>      __pyx_t_142 = __pyx_v_j;
      __pyx_t_143 = 0;
      if (__pyx_t_142 &lt; 0) __pyx_t_142 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_143 &lt; 0) __pyx_t_143 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_144 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_142, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_143, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_144 &lt; 0) __pyx_t_144 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_145 = __pyx_v_j;
      __pyx_t_146 = 1;
      if (__pyx_t_145 &lt; 0) __pyx_t_145 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_146 &lt; 0) __pyx_t_146 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_147 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_145, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_146, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_147 &lt; 0) __pyx_t_147 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_148 = __pyx_v_j;
      __pyx_t_149 = 2;
      if (__pyx_t_148 &lt; 0) __pyx_t_148 += __pyx_pybuffernd_inet.diminfo[0].shape;
      if (__pyx_t_149 &lt; 0) __pyx_t_149 += __pyx_pybuffernd_inet.diminfo[1].shape;
      __pyx_t_150 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_inet.rcbuffer-&gt;pybuffer.buf, __pyx_t_148, __pyx_pybuffernd_inet.diminfo[0].strides, __pyx_t_149, __pyx_pybuffernd_inet.diminfo[1].strides));
      if (__pyx_t_150 &lt; 0) __pyx_t_150 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_v_reactionRate = (((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_144, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_147, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_150, __pyx_pybuffernd_C.diminfo[0].strides)));
    }
    __pyx_L35:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+380:             networkLeakRates[j] = reactionRate</pre>
<pre class='cython code score-0'>    __pyx_t_151 = __pyx_v_j;
    if (__pyx_t_151 &lt; 0) __pyx_t_151 += __pyx_pybuffernd_networkLeakRates.diminfo[0].shape;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_networkLeakRates.rcbuffer-&gt;pybuffer.buf, __pyx_t_151, __pyx_pybuffernd_networkLeakRates.diminfo[0].strides) = __pyx_v_reactionRate;
  }
</pre><pre class='cython line score-0'>&#xA0;381: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+382:         self.coreSpeciesConcentrations = coreSpeciesConcentrations</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_coreSpeciesConcentrations));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_coreSpeciesConcentrations));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
  __pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations = ((PyArrayObject *)__pyx_v_coreSpeciesConcentrations);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+383:         self.coreSpeciesRates = coreSpeciesRates</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_coreSpeciesRates));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_coreSpeciesRates));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.coreSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesRates));
  __pyx_v_self-&gt;__pyx_base.coreSpeciesRates = ((PyArrayObject *)__pyx_v_coreSpeciesRates);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+384:         self.coreReactionRates = coreReactionRates</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_coreReactionRates));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_coreReactionRates));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.coreReactionRates);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates));
  __pyx_v_self-&gt;__pyx_base.coreReactionRates = ((PyArrayObject *)__pyx_v_coreReactionRates);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+385:         self.edgeSpeciesRates = edgeSpeciesRates</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edgeSpeciesRates));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_edgeSpeciesRates));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeSpeciesRates));
  __pyx_v_self-&gt;__pyx_base.edgeSpeciesRates = ((PyArrayObject *)__pyx_v_edgeSpeciesRates);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+386:         self.edgeReactionRates = edgeReactionRates</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_edgeReactionRates));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_edgeReactionRates));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.edgeReactionRates);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.edgeReactionRates));
  __pyx_v_self-&gt;__pyx_base.edgeReactionRates = ((PyArrayObject *)__pyx_v_edgeReactionRates);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+387:         self.networkLeakRates = networkLeakRates</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_networkLeakRates));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_networkLeakRates));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.networkLeakRates);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.networkLeakRates));
  __pyx_v_self-&gt;__pyx_base.networkLeakRates = ((PyArrayObject *)__pyx_v_networkLeakRates);
</pre><pre class='cython line score-0'>&#xA0;388: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+389:         res = coreSpeciesRates * V</pre>
<pre class='cython code score-32'>  __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_V);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_16 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_v_coreSpeciesRates), __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  if (!(likely(((__pyx_t_16) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_16, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_16);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_res.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_res, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_res.diminfo[0].strides = __pyx_pybuffernd_res.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_res.diminfo[0].shape = __pyx_pybuffernd_res.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_25 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_res, ((PyArrayObject *)__pyx_t_16));
  __pyx_t_16 = 0;
</pre><pre class='cython line score-0'>&#xA0;390: </pre>
<pre class='cython line score-0'>&#xA0;391: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+392:         if self.sensitivity:</pre>
<pre class='cython code score-0'>  __pyx_t_8 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.sensitivity != 0);
  if (__pyx_t_8) {
</pre><pre class='cython line score-62' onclick='toggleDiv(this)'>+393:             delta = numpy.zeros(len(y), numpy.float64)</pre>
<pre class='cython code score-62'>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_y));<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_1) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_6, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_6, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    __pyx_t_13 = 0;
    __pyx_t_11 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (!(likely(((__pyx_t_16) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_16, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_25 = ((PyArrayObject *)__pyx_t_16);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_delta, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
        }
      }
      __pyx_pybuffernd_delta.diminfo[0].strides = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_delta.diminfo[0].shape = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_25 = 0;
    __pyx_v_delta = ((PyArrayObject *)__pyx_t_16);
    __pyx_t_16 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+394:             delta[:numCoreSpecies] = res</pre>
<pre class='cython code score-2'>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(((PyObject *)__pyx_v_delta), ((PyObject *)__pyx_v_res), 0, __pyx_v_numCoreSpecies, NULL, NULL, NULL, 0, 1, 1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+395:             if self.jacobianMatrix is None:</pre>
<pre class='cython code score-0'>    __pyx_t_8 = (((PyObject *)__pyx_v_self-&gt;__pyx_base.jacobianMatrix) == Py_None);
    __pyx_t_34 = (__pyx_t_8 != 0);
    if (__pyx_t_34) {
</pre><pre class='cython line score-56' onclick='toggleDiv(this)'>+396:                 jacobian = self.jacobian(t,y,dydt,0,senpar)</pre>
<pre class='cython code score-56'>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_jacobian);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_11 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (__pyx_t_11) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_6, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_6, ((PyObject *)__pyx_v_y));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_dydt));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_6, ((PyObject *)__pyx_v_dydt));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_dydt));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3+__pyx_t_6, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_senpar));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 4+__pyx_t_6, ((PyObject *)__pyx_v_senpar));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_senpar));
      __pyx_t_14 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      if (!(likely(((__pyx_t_16) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_16, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_152 = ((PyArrayObject *)__pyx_t_16);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_152, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_2 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jacobian, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
          }
        }
        __pyx_pybuffernd_jacobian.diminfo[0].strides = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jacobian.diminfo[0].shape = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jacobian.diminfo[1].strides = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jacobian.diminfo[1].shape = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_152 = 0;
      __pyx_v_jacobian = ((PyArrayObject *)__pyx_t_16);
      __pyx_t_16 = 0;
      goto __pyx_L37;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;397:             else:</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+398:                 jacobian = self.jacobianMatrix</pre>
<pre class='cython code score-19'>      __pyx_t_16 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.jacobianMatrix);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_16), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_2 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_jacobian, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
          }
        }
        __pyx_pybuffernd_jacobian.diminfo[0].strides = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_jacobian.diminfo[0].shape = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_jacobian.diminfo[1].strides = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_jacobian.diminfo[1].shape = __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_jacobian = ((PyArrayObject *)__pyx_t_16);
      __pyx_t_16 = 0;
    }
    __pyx_L37:;
</pre><pre class='cython line score-46' onclick='toggleDiv(this)'>+399:             dgdk = ReactionSystem.computeRateDerivative(self)</pre>
<pre class='cython code score-46'>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_6solver_4base_ReactionSystem)), __pyx_n_s_computeRateDerivative);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_13 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    if (!__pyx_t_13) {
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    } else {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_13); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); __pyx_t_13 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, ((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (!(likely(((__pyx_t_16) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_16, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_152 = ((PyArrayObject *)__pyx_t_16);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_152, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_dgdk, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
        }
      }
      __pyx_pybuffernd_dgdk.diminfo[0].strides = __pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dgdk.diminfo[0].shape = __pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dgdk.diminfo[1].strides = __pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dgdk.diminfo[1].shape = __pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_152 = 0;
    __pyx_v_dgdk = ((PyArrayObject *)__pyx_t_16);
    __pyx_t_16 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+400:             for j in xrange(numCoreReactions+numCoreSpecies):</pre>
<pre class='cython code score-0'>    __pyx_t_2 = (__pyx_v_numCoreReactions + __pyx_v_numCoreSpecies);
    for (__pyx_t_153 = 0; __pyx_t_153 &lt; __pyx_t_2; __pyx_t_153+=1) {
      __pyx_v_j = __pyx_t_153;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+401:                 for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>      __pyx_t_154 = __pyx_v_numCoreSpecies;
      for (__pyx_t_155 = 0; __pyx_t_155 &lt; __pyx_t_154; __pyx_t_155+=1) {
        __pyx_v_i = __pyx_t_155;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+402:                     for z in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_156 = __pyx_v_numCoreSpecies;
        for (__pyx_t_157 = 0; __pyx_t_157 &lt; __pyx_t_156; __pyx_t_157+=1) {
          __pyx_v_z = __pyx_t_157;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+403:                         delta[(j+1)*numCoreSpecies + i] += jacobian[i,z]*y[(j+1)*numCoreSpecies + z]</pre>
<pre class='cython code score-0'>          __pyx_t_158 = __pyx_v_i;
          __pyx_t_159 = __pyx_v_z;
          if (__pyx_t_158 &lt; 0) __pyx_t_158 += __pyx_pybuffernd_jacobian.diminfo[0].shape;
          if (__pyx_t_159 &lt; 0) __pyx_t_159 += __pyx_pybuffernd_jacobian.diminfo[1].shape;
          __pyx_t_160 = (((__pyx_v_j + 1) * __pyx_v_numCoreSpecies) + __pyx_v_z);
          if (__pyx_t_160 &lt; 0) __pyx_t_160 += __pyx_pybuffernd_y.diminfo[0].shape;
          __pyx_t_161 = (((__pyx_v_j + 1) * __pyx_v_numCoreSpecies) + __pyx_v_i);
          if (__pyx_t_161 &lt; 0) __pyx_t_161 += __pyx_pybuffernd_delta.diminfo[0].shape;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.buf, __pyx_t_161, __pyx_pybuffernd_delta.diminfo[0].strides) += ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_jacobian.rcbuffer-&gt;pybuffer.buf, __pyx_t_158, __pyx_pybuffernd_jacobian.diminfo[0].strides, __pyx_t_159, __pyx_pybuffernd_jacobian.diminfo[1].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.buf, __pyx_t_160, __pyx_pybuffernd_y.diminfo[0].strides)));
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+404:                     delta[(j+1)*numCoreSpecies + i] += dgdk[i,j]</pre>
<pre class='cython code score-0'>        __pyx_t_156 = __pyx_v_i;
        __pyx_t_157 = __pyx_v_j;
        if (__pyx_t_156 &lt; 0) __pyx_t_156 += __pyx_pybuffernd_dgdk.diminfo[0].shape;
        if (__pyx_t_157 &lt; 0) __pyx_t_157 += __pyx_pybuffernd_dgdk.diminfo[1].shape;
        __pyx_t_162 = (((__pyx_v_j + 1) * __pyx_v_numCoreSpecies) + __pyx_v_i);
        if (__pyx_t_162 &lt; 0) __pyx_t_162 += __pyx_pybuffernd_delta.diminfo[0].shape;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_delta.diminfo[0].strides) += (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_dgdk.rcbuffer-&gt;pybuffer.buf, __pyx_t_156, __pyx_pybuffernd_dgdk.diminfo[0].strides, __pyx_t_157, __pyx_pybuffernd_dgdk.diminfo[1].strides));
      }
    }
    goto __pyx_L36;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;405: </pre>
<pre class='cython line score-0'>&#xA0;406:         else:</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+407:             delta = res</pre>
<pre class='cython code score-19'>    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_res, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_2 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_delta, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
        }
      }
      __pyx_pybuffernd_delta.diminfo[0].strides = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_delta.diminfo[0].shape = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_res));
    __pyx_v_delta = __pyx_v_res;
  }
  __pyx_L36:;
</pre><pre class='cython line score-26' onclick='toggleDiv(this)'>+408:         delta = delta - dydt</pre>
<pre class='cython code score-26'>  __pyx_t_16 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_delta), ((PyObject *)__pyx_v_dydt));<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  if (!(likely(((__pyx_t_16) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_16, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_16);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_delta, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_delta.diminfo[0].strides = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_delta.diminfo[0].shape = __pyx_pybuffernd_delta.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_25 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_delta, ((PyArrayObject *)__pyx_t_16));
  __pyx_t_16 = 0;
</pre><pre class='cython line score-0'>&#xA0;409: </pre>
<pre class='cython line score-0'>&#xA0;410:         # Return DELTA, IRES.  IRES is set to 1 in order to tell DASPK to evaluate the sensitivity residuals</pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+411:         return delta, 1</pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_delta));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, ((PyObject *)__pyx_v_delta));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_delta));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  __pyx_r = __pyx_t_16;
  __pyx_t_16 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;412: </pre>
<pre class='cython line score-0'>&#xA0;413:     @cython.boundscheck(False)</pre>
<pre class='cython line score-167' onclick='toggleDiv(this)'>+414:     def jacobian(self, double t, numpy.ndarray[numpy.float64_t, ndim=1] y, numpy.ndarray[numpy.float64_t, ndim=1] dydt, double cj, numpy.ndarray[numpy.float64_t, ndim=1] senpar = numpy.zeros(1, numpy.float64)):</pre>
<pre class='cython code score-167'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_19jacobian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_6solver_6simple_13SimpleReactor_18jacobian[] = "\n        Return the analytical Jacobian for the reaction system.\n        ";
static PyObject *__pyx_pw_5rmgpy_6solver_6simple_13SimpleReactor_19jacobian(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED double __pyx_v_t;
  PyArrayObject *__pyx_v_y = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_dydt = 0;
  double __pyx_v_cj;
  CYTHON_UNUSED PyArrayObject *__pyx_v_senpar = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("jacobian (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dydt,&amp;__pyx_n_s_cj,&amp;__pyx_n_s_senpar,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = (PyObject *)__pyx_k__2;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("jacobian", 0, 4, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dydt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("jacobian", 0, 4, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cj)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("jacobian", 0, 4, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_senpar);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "jacobian") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_y = ((PyArrayObject *)values[1]);
    __pyx_v_dydt = ((PyArrayObject *)values[2]);
    __pyx_v_cj = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_cj == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_senpar = ((PyArrayObject *)values[4]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("jacobian", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.jacobian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_y), __pyx_ptype_5numpy_ndarray, 1, "y", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_dydt), __pyx_ptype_5numpy_ndarray, 1, "dydt", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_senpar), __pyx_ptype_5numpy_ndarray, 1, "senpar", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_18jacobian(((struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *)__pyx_v_self), __pyx_v_t, __pyx_v_y, __pyx_v_dydt, __pyx_v_cj, __pyx_v_senpar);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_6solver_6simple_13SimpleReactor_18jacobian(struct __pyx_obj_5rmgpy_6solver_6simple_SimpleReactor *__pyx_v_self, CYTHON_UNUSED double __pyx_v_t, PyArrayObject *__pyx_v_y, CYTHON_UNUSED PyArrayObject *__pyx_v_dydt, double __pyx_v_cj, CYTHON_UNUSED PyArrayObject *__pyx_v_senpar) {
  PyArrayObject *__pyx_v_ir = 0;
  PyArrayObject *__pyx_v_ip = 0;
  PyArrayObject *__pyx_v_kf = 0;
  PyArrayObject *__pyx_v_kr = 0;
  PyArrayObject *__pyx_v_C = 0;
  PyArrayObject *__pyx_v_pd = 0;
  int __pyx_v_numCoreReactions;
  int __pyx_v_numCoreSpecies;
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_k;
  double __pyx_v_V;
  double __pyx_v_Ctot;
  double __pyx_v_deriv;
  double __pyx_v_corr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_C;
  __Pyx_Buffer __pyx_pybuffer_C;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dydt;
  __Pyx_Buffer __pyx_pybuffer_dydt;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ip;
  __Pyx_Buffer __pyx_pybuffer_ip;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ir;
  __Pyx_Buffer __pyx_pybuffer_ir;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kf;
  __Pyx_Buffer __pyx_pybuffer_kf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kr;
  __Pyx_Buffer __pyx_pybuffer_kr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_pd;
  __Pyx_Buffer __pyx_pybuffer_pd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_senpar;
  __Pyx_Buffer __pyx_pybuffer_senpar;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_y;
  __Pyx_Buffer __pyx_pybuffer_y;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("jacobian", 0);
  __pyx_pybuffer_ir.pybuffer.buf = NULL;
  __pyx_pybuffer_ir.refcount = 0;
  __pyx_pybuffernd_ir.data = NULL;
  __pyx_pybuffernd_ir.rcbuffer = &amp;__pyx_pybuffer_ir;
  __pyx_pybuffer_ip.pybuffer.buf = NULL;
  __pyx_pybuffer_ip.refcount = 0;
  __pyx_pybuffernd_ip.data = NULL;
  __pyx_pybuffernd_ip.rcbuffer = &amp;__pyx_pybuffer_ip;
  __pyx_pybuffer_kf.pybuffer.buf = NULL;
  __pyx_pybuffer_kf.refcount = 0;
  __pyx_pybuffernd_kf.data = NULL;
  __pyx_pybuffernd_kf.rcbuffer = &amp;__pyx_pybuffer_kf;
  __pyx_pybuffer_kr.pybuffer.buf = NULL;
  __pyx_pybuffer_kr.refcount = 0;
  __pyx_pybuffernd_kr.data = NULL;
  __pyx_pybuffernd_kr.rcbuffer = &amp;__pyx_pybuffer_kr;
  __pyx_pybuffer_C.pybuffer.buf = NULL;
  __pyx_pybuffer_C.refcount = 0;
  __pyx_pybuffernd_C.data = NULL;
  __pyx_pybuffernd_C.rcbuffer = &amp;__pyx_pybuffer_C;
  __pyx_pybuffer_pd.pybuffer.buf = NULL;
  __pyx_pybuffer_pd.refcount = 0;
  __pyx_pybuffernd_pd.data = NULL;
  __pyx_pybuffernd_pd.rcbuffer = &amp;__pyx_pybuffer_pd;
  __pyx_pybuffer_y.pybuffer.buf = NULL;
  __pyx_pybuffer_y.refcount = 0;
  __pyx_pybuffernd_y.data = NULL;
  __pyx_pybuffernd_y.rcbuffer = &amp;__pyx_pybuffer_y;
  __pyx_pybuffer_dydt.pybuffer.buf = NULL;
  __pyx_pybuffer_dydt.refcount = 0;
  __pyx_pybuffernd_dydt.data = NULL;
  __pyx_pybuffernd_dydt.rcbuffer = &amp;__pyx_pybuffer_dydt;
  __pyx_pybuffer_senpar.pybuffer.buf = NULL;
  __pyx_pybuffer_senpar.refcount = 0;
  __pyx_pybuffernd_senpar.data = NULL;
  __pyx_pybuffernd_senpar.rcbuffer = &amp;__pyx_pybuffer_senpar;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_y, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_y.diminfo[0].strides = __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_y.diminfo[0].shape = __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_dydt, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_dydt.diminfo[0].strides = __pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dydt.diminfo[0].shape = __pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_senpar, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_senpar.diminfo[0].strides = __pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_senpar.diminfo[0].shape = __pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer.shape[0];
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.solver.simple.SimpleReactor.jacobian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dydt.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_senpar.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_y.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ir);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ip);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_pd);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_5) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_k__2 = ((PyArrayObject *)__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;415:         """</pre>
<pre class='cython line score-0'>&#xA0;416:         Return the analytical Jacobian for the reaction system.</pre>
<pre class='cython line score-0'>&#xA0;417:         """</pre>
<pre class='cython line score-0'>&#xA0;418:         cdef numpy.ndarray[numpy.int_t, ndim=2] ir, ip</pre>
<pre class='cython line score-0'>&#xA0;419:         cdef numpy.ndarray[numpy.float64_t, ndim=1] kf, kr, C</pre>
<pre class='cython line score-0'>&#xA0;420:         cdef numpy.ndarray[numpy.float64_t, ndim=2] pd</pre>
<pre class='cython line score-0'>&#xA0;421:         cdef int numCoreReactions, numCoreSpecies, i, j</pre>
<pre class='cython line score-0'>&#xA0;422:         cdef double k, V, Ctot, deriv, corr</pre>
<pre class='cython line score-0'>&#xA0;423: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+424:         ir = self.reactantIndices</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.reactantIndices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_ir, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_ir.diminfo[0].strides = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ir.diminfo[0].shape = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_ir.diminfo[1].strides = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_ir.diminfo[1].shape = __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_ir = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+425:         ip = self.productIndices</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.productIndices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_ip, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_ip.diminfo[0].strides = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ip.diminfo[0].shape = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_ip.diminfo[1].strides = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_ip.diminfo[1].shape = __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_ip = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;426: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+427:         kf = self.kf</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.kf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_kf = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+428:         kr = self.kb</pre>
<pre class='cython code score-19'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.kb);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_kr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+429:         numCoreReactions = len(self.coreReactionRates)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreReactionRates);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numCoreReactions = __pyx_t_6;
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+430:         numCoreSpecies = len(self.coreSpeciesConcentrations)</pre>
<pre class='cython code score-7'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numCoreSpecies = __pyx_t_6;
</pre><pre class='cython line score-0'>&#xA0;431: </pre>
<pre class='cython line score-66' onclick='toggleDiv(this)'>+432:         pd = -cj * numpy.identity(numCoreSpecies, numpy.float64)</pre>
<pre class='cython code score-66'>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((-__pyx_v_cj));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_identity);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numCoreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  if (__pyx_t_10) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); __pyx_t_10 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_6, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_6, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  __pyx_t_8 = 0;
  __pyx_t_11 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_9);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_3, &amp;__pyx_t_4, &amp;__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_pd, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_3); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      }
    }
    __pyx_pybuffernd_pd.diminfo[0].strides = __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_pd.diminfo[0].shape = __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_pd.diminfo[1].strides = __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_pd.diminfo[1].shape = __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_13 = 0;
  __pyx_v_pd = ((PyArrayObject *)__pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class='cython line score-0'>&#xA0;433: </pre>
<pre class='cython line score-58' onclick='toggleDiv(this)'>+434:         V = constants.R * self.T.value_si * numpy.sum(y[:numCoreSpecies]) / self.P.value_si</pre>
<pre class='cython code score-58'>  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_5rmgpy_9constants_R * __pyx_v_self-&gt;T-&gt;value_si));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(((PyObject *)__pyx_v_y), 0, __pyx_v_numCoreSpecies, NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;P-&gt;value_si);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_12, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9);<span class='error_goto'> if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_V = __pyx_t_14;
</pre><pre class='cython line score-0'>&#xA0;435: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+436:         Ctot = self.P.value_si /(constants.R * self.T.value_si)</pre>
<pre class='cython code score-5'>  __pyx_t_14 = (__pyx_v_5rmgpy_9constants_R * __pyx_v_self-&gt;T-&gt;value_si);
  if (unlikely(__pyx_t_14 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_Ctot = (__pyx_v_self-&gt;P-&gt;value_si / __pyx_t_14);
</pre><pre class='cython line score-0'>&#xA0;437: </pre>
<pre class='cython line score-49' onclick='toggleDiv(this)'>+438:         C = numpy.zeros_like(self.coreSpeciesConcentrations)</pre>
<pre class='cython code score-49'>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, ((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.coreSpeciesConcentrations));
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_9);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_15, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_C.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_C, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_5); Py_XDECREF(__pyx_t_4); Py_XDECREF(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
      }
    }
    __pyx_pybuffernd_C.diminfo[0].strides = __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_C.diminfo[0].shape = __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_15 = 0;
  __pyx_v_C = ((PyArrayObject *)__pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+439:         for j in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_numCoreSpecies;
  for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_2; __pyx_t_16+=1) {
    __pyx_v_j = __pyx_t_16;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+440:             C[j] = y[j] / V</pre>
<pre class='cython code score-5'>    __pyx_t_17 = __pyx_v_j;
    if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_y.diminfo[0].shape;
    __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_y.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_y.diminfo[0].strides));
    if (unlikely(__pyx_v_V == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_19 = __pyx_v_j;
    if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_pybuffernd_C.diminfo[0].shape;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_C.diminfo[0].strides) = (__pyx_t_18 / __pyx_v_V);
  }
</pre><pre class='cython line score-0'>&#xA0;441: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+442:         for j in xrange(numCoreReactions):</pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_numCoreReactions;
  for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_2; __pyx_t_16+=1) {
    __pyx_v_j = __pyx_t_16;
</pre><pre class='cython line score-0'>&#xA0;443: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+444:             k = kf[j]</pre>
<pre class='cython code score-0'>    __pyx_t_20 = __pyx_v_j;
    if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_pybuffernd_kf.diminfo[0].shape;
    __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_kf.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+445:             if ir[j,1] == -1: # only one reactant</pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_j;
    __pyx_t_22 = 1;
    if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_ir.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+446:                 deriv = k</pre>
<pre class='cython code score-0'>      __pyx_v_deriv = __pyx_v_k;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+447:                 pd[ir[j,0], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>      __pyx_t_24 = __pyx_v_j;
      __pyx_t_25 = 0;
      if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_26 = __pyx_v_j;
      __pyx_t_27 = 0;
      if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_28 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_ir.diminfo[1].strides));
      __pyx_t_29 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_pd.diminfo[0].shape;
      if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_pd.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;448: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+449:                 pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>      __pyx_t_30 = __pyx_v_j;
      __pyx_t_31 = 0;
      if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_32 = __pyx_v_j;
      __pyx_t_33 = 0;
      if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_34 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_ip.diminfo[1].strides));
      __pyx_t_35 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_pybuffernd_pd.diminfo[0].shape;
      if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_pybuffernd_pd.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+450:                 if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_36 = __pyx_v_j;
      __pyx_t_37 = 1;
      if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_37, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+451:                     pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_38 = __pyx_v_j;
        __pyx_t_39 = 1;
        if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_40 = __pyx_v_j;
        __pyx_t_41 = 0;
        if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_42 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_43 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+452:                     if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_44 = __pyx_v_j;
        __pyx_t_45 = 2;
        if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_45, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+453:                         pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_46 = __pyx_v_j;
          __pyx_t_47 = 2;
          if (__pyx_t_46 &lt; 0) __pyx_t_46 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_47 &lt; 0) __pyx_t_47 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_48 = __pyx_v_j;
          __pyx_t_49 = 0;
          if (__pyx_t_48 &lt; 0) __pyx_t_48 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_49 &lt; 0) __pyx_t_49 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_50 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_51 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_49, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_50 &lt; 0) __pyx_t_50 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_51 &lt; 0) __pyx_t_51 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_51, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
          goto __pyx_L9;
        }
        __pyx_L9:;
        goto __pyx_L8;
      }
      __pyx_L8:;
      goto __pyx_L7;
    }
</pre><pre class='cython line score-0'>&#xA0;454: </pre>
<pre class='cython line score-0'>&#xA0;455: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+456:             elif ir[j,2] == -1: # only two reactants</pre>
<pre class='cython code score-0'>    __pyx_t_52 = __pyx_v_j;
    __pyx_t_53 = 2;
    if (__pyx_t_52 &lt; 0) __pyx_t_52 += __pyx_pybuffernd_ir.diminfo[0].shape;
    if (__pyx_t_53 &lt; 0) __pyx_t_53 += __pyx_pybuffernd_ir.diminfo[1].shape;
    __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_53, __pyx_pybuffernd_ir.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_23) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+457:                 corr = - k * C[ir[j,0]] * C[ir[j,1]] / Ctot</pre>
<pre class='cython code score-5'>      __pyx_t_54 = __pyx_v_j;
      __pyx_t_55 = 0;
      if (__pyx_t_54 &lt; 0) __pyx_t_54 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_55 &lt; 0) __pyx_t_55 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_56 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_55, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_56 &lt; 0) __pyx_t_56 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_57 = __pyx_v_j;
      __pyx_t_58 = 1;
      if (__pyx_t_57 &lt; 0) __pyx_t_57 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_58 &lt; 0) __pyx_t_58 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_59 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_58, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_59 &lt; 0) __pyx_t_59 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_18 = (((-__pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_C.diminfo[0].strides)));
      if (unlikely(__pyx_v_Ctot == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_corr = (__pyx_t_18 / __pyx_v_Ctot);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+458:                 if ir[j,0] == ir[j,1]:  # reactants are the same</pre>
<pre class='cython code score-0'>      __pyx_t_60 = __pyx_v_j;
      __pyx_t_61 = 0;
      if (__pyx_t_60 &lt; 0) __pyx_t_60 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_61 &lt; 0) __pyx_t_61 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_62 = __pyx_v_j;
      __pyx_t_63 = 1;
      if (__pyx_t_62 &lt; 0) __pyx_t_62 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_63 &lt; 0) __pyx_t_63 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_61, __pyx_pybuffernd_ir.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_63, __pyx_pybuffernd_ir.diminfo[1].strides))) != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+459:                     deriv = 2 * k * C[ir[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_64 = __pyx_v_j;
        __pyx_t_65 = 0;
        if (__pyx_t_64 &lt; 0) __pyx_t_64 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_65 &lt; 0) __pyx_t_65 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_66 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_65, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_66 &lt; 0) __pyx_t_66 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+460:                     pd[ir[j,0], ir[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_67 = __pyx_v_j;
        __pyx_t_68 = 0;
        if (__pyx_t_67 &lt; 0) __pyx_t_67 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_68 &lt; 0) __pyx_t_68 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_69 = __pyx_v_j;
        __pyx_t_70 = 0;
        if (__pyx_t_69 &lt; 0) __pyx_t_69 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_70 &lt; 0) __pyx_t_70 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_71 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_68, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_72 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_71 &lt; 0) __pyx_t_71 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_72 &lt; 0) __pyx_t_72 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+461:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_73 = __pyx_v_numCoreSpecies;
        for (__pyx_t_74 = 0; __pyx_t_74 &lt; __pyx_t_73; __pyx_t_74+=1) {
          __pyx_v_i = __pyx_t_74;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+462:                         pd[ir[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_75 = __pyx_v_j;
          __pyx_t_76 = 0;
          if (__pyx_t_75 &lt; 0) __pyx_t_75 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_76 &lt; 0) __pyx_t_76 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_77 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_76, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_78 = __pyx_v_i;
          if (__pyx_t_77 &lt; 0) __pyx_t_77 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_78 &lt; 0) __pyx_t_78 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;463: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+464:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_73 = __pyx_v_j;
        __pyx_t_79 = 0;
        if (__pyx_t_73 &lt; 0) __pyx_t_73 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_79 &lt; 0) __pyx_t_79 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_74 = __pyx_v_j;
        __pyx_t_80 = 0;
        if (__pyx_t_74 &lt; 0) __pyx_t_74 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_80 &lt; 0) __pyx_t_80 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_81 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_79, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_82 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_80, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_81 &lt; 0) __pyx_t_81 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_82 &lt; 0) __pyx_t_82 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_82, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+465:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_83 = __pyx_v_numCoreSpecies;
        for (__pyx_t_84 = 0; __pyx_t_84 &lt; __pyx_t_83; __pyx_t_84+=1) {
          __pyx_v_i = __pyx_t_84;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+466:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_85 = __pyx_v_j;
          __pyx_t_86 = 0;
          if (__pyx_t_85 &lt; 0) __pyx_t_85 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_86 &lt; 0) __pyx_t_86 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_87 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_86, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_88 = __pyx_v_i;
          if (__pyx_t_87 &lt; 0) __pyx_t_87 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_88 &lt; 0) __pyx_t_88 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_88, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+467:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_83 = __pyx_v_j;
        __pyx_t_89 = 1;
        if (__pyx_t_83 &lt; 0) __pyx_t_83 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_89 &lt; 0) __pyx_t_89 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_89, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+468:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_84 = __pyx_v_j;
          __pyx_t_90 = 1;
          if (__pyx_t_84 &lt; 0) __pyx_t_84 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_90 &lt; 0) __pyx_t_90 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_91 = __pyx_v_j;
          __pyx_t_92 = 0;
          if (__pyx_t_91 &lt; 0) __pyx_t_91 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_92 &lt; 0) __pyx_t_92 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_93 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_94 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_92, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_93 &lt; 0) __pyx_t_93 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_94 &lt; 0) __pyx_t_94 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_94, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+469:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_95 = __pyx_v_numCoreSpecies;
          for (__pyx_t_96 = 0; __pyx_t_96 &lt; __pyx_t_95; __pyx_t_96+=1) {
            __pyx_v_i = __pyx_t_96;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+470:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_97 = __pyx_v_j;
            __pyx_t_98 = 1;
            if (__pyx_t_97 &lt; 0) __pyx_t_97 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_98 &lt; 0) __pyx_t_98 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_99 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_97, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_98, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_100 = __pyx_v_i;
            if (__pyx_t_99 &lt; 0) __pyx_t_99 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_100 &lt; 0) __pyx_t_100 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_100, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+471:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_95 = __pyx_v_j;
          __pyx_t_101 = 2;
          if (__pyx_t_95 &lt; 0) __pyx_t_95 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_101 &lt; 0) __pyx_t_101 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+472:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_96 = __pyx_v_j;
            __pyx_t_102 = 2;
            if (__pyx_t_96 &lt; 0) __pyx_t_96 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_102 &lt; 0) __pyx_t_102 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_103 = __pyx_v_j;
            __pyx_t_104 = 0;
            if (__pyx_t_103 &lt; 0) __pyx_t_103 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_104 &lt; 0) __pyx_t_104 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_105 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_102, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_106 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_104, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_105 &lt; 0) __pyx_t_105 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_106 &lt; 0) __pyx_t_106 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_106, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+473:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_107 = __pyx_v_numCoreSpecies;
            for (__pyx_t_108 = 0; __pyx_t_108 &lt; __pyx_t_107; __pyx_t_108+=1) {
              __pyx_v_i = __pyx_t_108;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+474:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_109 = __pyx_v_j;
              __pyx_t_110 = 2;
              if (__pyx_t_109 &lt; 0) __pyx_t_109 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_110 &lt; 0) __pyx_t_110 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_111 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_109, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_110, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_112 = __pyx_v_i;
              if (__pyx_t_111 &lt; 0) __pyx_t_111 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_112 &lt; 0) __pyx_t_112 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_111, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_112, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L18;
          }
          __pyx_L18:;
          goto __pyx_L15;
        }
        __pyx_L15:;
        goto __pyx_L10;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;475: </pre>
<pre class='cython line score-0'>&#xA0;476:                 else:</pre>
<pre class='cython line score-0'>&#xA0;477:                     # Derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+478:                     deriv = k * C[ir[j, 1]]</pre>
<pre class='cython code score-0'>        __pyx_t_107 = __pyx_v_j;
        __pyx_t_113 = 1;
        if (__pyx_t_107 &lt; 0) __pyx_t_107 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_113 &lt; 0) __pyx_t_113 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_114 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_113, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_114 &lt; 0) __pyx_t_114 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_114, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+479:                     pd[ir[j,0], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_108 = __pyx_v_j;
        __pyx_t_115 = 0;
        if (__pyx_t_108 &lt; 0) __pyx_t_108 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_115 &lt; 0) __pyx_t_115 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_116 = __pyx_v_j;
        __pyx_t_117 = 0;
        if (__pyx_t_116 &lt; 0) __pyx_t_116 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_117 &lt; 0) __pyx_t_117 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_118 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_115, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_119 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_116, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_117, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_118 &lt; 0) __pyx_t_118 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_119 &lt; 0) __pyx_t_119 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_118, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_119, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+480:                     pd[ir[j,1], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_120 = __pyx_v_j;
        __pyx_t_121 = 1;
        if (__pyx_t_120 &lt; 0) __pyx_t_120 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_121 &lt; 0) __pyx_t_121 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_122 = __pyx_v_j;
        __pyx_t_123 = 0;
        if (__pyx_t_122 &lt; 0) __pyx_t_122 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_123 &lt; 0) __pyx_t_123 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_124 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_120, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_121, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_125 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_122, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_123, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_124 &lt; 0) __pyx_t_124 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_125 &lt; 0) __pyx_t_125 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_125, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;481: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+482:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_126 = __pyx_v_j;
        __pyx_t_127 = 0;
        if (__pyx_t_126 &lt; 0) __pyx_t_126 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_127 &lt; 0) __pyx_t_127 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_128 = __pyx_v_j;
        __pyx_t_129 = 0;
        if (__pyx_t_128 &lt; 0) __pyx_t_128 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_129 &lt; 0) __pyx_t_129 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_130 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_126, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_127, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_131 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_129, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_130 &lt; 0) __pyx_t_130 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_131 &lt; 0) __pyx_t_131 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_130, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_131, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+483:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_132 = __pyx_v_j;
        __pyx_t_133 = 1;
        if (__pyx_t_132 &lt; 0) __pyx_t_132 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_133 &lt; 0) __pyx_t_133 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_132, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_133, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+484:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_134 = __pyx_v_j;
          __pyx_t_135 = 1;
          if (__pyx_t_134 &lt; 0) __pyx_t_134 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_135 &lt; 0) __pyx_t_135 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_136 = __pyx_v_j;
          __pyx_t_137 = 0;
          if (__pyx_t_136 &lt; 0) __pyx_t_136 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_137 &lt; 0) __pyx_t_137 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_138 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_134, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_135, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_139 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_136, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_137, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_138 &lt; 0) __pyx_t_138 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_139 &lt; 0) __pyx_t_139 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_138, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_139, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+485:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_140 = __pyx_v_j;
          __pyx_t_141 = 2;
          if (__pyx_t_140 &lt; 0) __pyx_t_140 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_141 &lt; 0) __pyx_t_141 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_140, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_141, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+486:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_142 = __pyx_v_j;
            __pyx_t_143 = 2;
            if (__pyx_t_142 &lt; 0) __pyx_t_142 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_143 &lt; 0) __pyx_t_143 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_144 = __pyx_v_j;
            __pyx_t_145 = 0;
            if (__pyx_t_144 &lt; 0) __pyx_t_144 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_145 &lt; 0) __pyx_t_145 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_146 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_142, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_143, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_147 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_144, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_145, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_146 &lt; 0) __pyx_t_146 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_147 &lt; 0) __pyx_t_147 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_146, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_147, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L22;
          }
          __pyx_L22:;
          goto __pyx_L21;
        }
        __pyx_L21:;
</pre><pre class='cython line score-0'>&#xA0;487: </pre>
<pre class='cython line score-0'>&#xA0;488:                     # Derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+489:                     deriv = k * C[ir[j, 0]]</pre>
<pre class='cython code score-0'>        __pyx_t_148 = __pyx_v_j;
        __pyx_t_149 = 0;
        if (__pyx_t_148 &lt; 0) __pyx_t_148 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_149 &lt; 0) __pyx_t_149 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_150 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_148, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_149, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_150 &lt; 0) __pyx_t_150 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_150, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+490:                     pd[ir[j,0], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_151 = __pyx_v_j;
        __pyx_t_152 = 0;
        if (__pyx_t_151 &lt; 0) __pyx_t_151 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_152 &lt; 0) __pyx_t_152 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_153 = __pyx_v_j;
        __pyx_t_154 = 1;
        if (__pyx_t_153 &lt; 0) __pyx_t_153 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_154 &lt; 0) __pyx_t_154 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_155 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_151, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_152, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_156 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_153, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_154, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_155 &lt; 0) __pyx_t_155 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_156 &lt; 0) __pyx_t_156 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_155, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_156, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+491:                     pd[ir[j,1], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_157 = __pyx_v_j;
        __pyx_t_158 = 1;
        if (__pyx_t_157 &lt; 0) __pyx_t_157 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_158 &lt; 0) __pyx_t_158 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_159 = __pyx_v_j;
        __pyx_t_160 = 1;
        if (__pyx_t_159 &lt; 0) __pyx_t_159 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_160 &lt; 0) __pyx_t_160 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_161 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_157, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_158, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_162 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_159, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_160, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_161 &lt; 0) __pyx_t_161 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_162 &lt; 0) __pyx_t_162 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_161, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_162, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+492:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_163 = __pyx_v_numCoreSpecies;
        for (__pyx_t_164 = 0; __pyx_t_164 &lt; __pyx_t_163; __pyx_t_164+=1) {
          __pyx_v_i = __pyx_t_164;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+493:                         pd[ir[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_165 = __pyx_v_j;
          __pyx_t_166 = 0;
          if (__pyx_t_165 &lt; 0) __pyx_t_165 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_166 &lt; 0) __pyx_t_166 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_167 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_165, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_166, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_168 = __pyx_v_i;
          if (__pyx_t_167 &lt; 0) __pyx_t_167 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_168 &lt; 0) __pyx_t_168 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_168, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+494:                         pd[ir[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_169 = __pyx_v_j;
          __pyx_t_170 = 1;
          if (__pyx_t_169 &lt; 0) __pyx_t_169 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_170 &lt; 0) __pyx_t_170 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_171 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_169, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_170, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_172 = __pyx_v_i;
          if (__pyx_t_171 &lt; 0) __pyx_t_171 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_172 &lt; 0) __pyx_t_172 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_171, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_172, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;495: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+496:                     pd[ip[j,0], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_163 = __pyx_v_j;
        __pyx_t_173 = 0;
        if (__pyx_t_163 &lt; 0) __pyx_t_163 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_173 &lt; 0) __pyx_t_173 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_164 = __pyx_v_j;
        __pyx_t_174 = 1;
        if (__pyx_t_164 &lt; 0) __pyx_t_164 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_174 &lt; 0) __pyx_t_174 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_175 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_163, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_173, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_176 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_164, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_174, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_175 &lt; 0) __pyx_t_175 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_176 &lt; 0) __pyx_t_176 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_175, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_176, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+497:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_177 = __pyx_v_numCoreSpecies;
        for (__pyx_t_178 = 0; __pyx_t_178 &lt; __pyx_t_177; __pyx_t_178+=1) {
          __pyx_v_i = __pyx_t_178;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+498:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_179 = __pyx_v_j;
          __pyx_t_180 = 0;
          if (__pyx_t_179 &lt; 0) __pyx_t_179 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_180 &lt; 0) __pyx_t_180 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_181 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_179, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_180, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_182 = __pyx_v_i;
          if (__pyx_t_181 &lt; 0) __pyx_t_181 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_182 &lt; 0) __pyx_t_182 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_181, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_182, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+499:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_177 = __pyx_v_j;
        __pyx_t_183 = 1;
        if (__pyx_t_177 &lt; 0) __pyx_t_177 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_183 &lt; 0) __pyx_t_183 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_177, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_183, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+500:                         pd[ip[j,1], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_178 = __pyx_v_j;
          __pyx_t_184 = 1;
          if (__pyx_t_178 &lt; 0) __pyx_t_178 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_184 &lt; 0) __pyx_t_184 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_185 = __pyx_v_j;
          __pyx_t_186 = 1;
          if (__pyx_t_185 &lt; 0) __pyx_t_185 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_186 &lt; 0) __pyx_t_186 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_187 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_178, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_184, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_188 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_185, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_186, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_187 &lt; 0) __pyx_t_187 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_188 &lt; 0) __pyx_t_188 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_187, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_188, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+501:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_189 = __pyx_v_numCoreSpecies;
          for (__pyx_t_190 = 0; __pyx_t_190 &lt; __pyx_t_189; __pyx_t_190+=1) {
            __pyx_v_i = __pyx_t_190;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+502:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_191 = __pyx_v_j;
            __pyx_t_192 = 1;
            if (__pyx_t_191 &lt; 0) __pyx_t_191 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_192 &lt; 0) __pyx_t_192 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_193 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_191, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_192, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_194 = __pyx_v_i;
            if (__pyx_t_193 &lt; 0) __pyx_t_193 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_194 &lt; 0) __pyx_t_194 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_193, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_194, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+503:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_189 = __pyx_v_j;
          __pyx_t_195 = 2;
          if (__pyx_t_189 &lt; 0) __pyx_t_189 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_195 &lt; 0) __pyx_t_195 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_189, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_195, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+504:                             pd[ip[j,2], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_190 = __pyx_v_j;
            __pyx_t_196 = 2;
            if (__pyx_t_190 &lt; 0) __pyx_t_190 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_196 &lt; 0) __pyx_t_196 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_197 = __pyx_v_j;
            __pyx_t_198 = 1;
            if (__pyx_t_197 &lt; 0) __pyx_t_197 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_198 &lt; 0) __pyx_t_198 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_199 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_190, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_196, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_200 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_197, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_198, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_199 &lt; 0) __pyx_t_199 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_200 &lt; 0) __pyx_t_200 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_199, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_200, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+505:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_201 = __pyx_v_numCoreSpecies;
            for (__pyx_t_202 = 0; __pyx_t_202 &lt; __pyx_t_201; __pyx_t_202+=1) {
              __pyx_v_i = __pyx_t_202;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+506:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_203 = __pyx_v_j;
              __pyx_t_204 = 2;
              if (__pyx_t_203 &lt; 0) __pyx_t_203 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_204 &lt; 0) __pyx_t_204 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_205 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_203, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_204, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_206 = __pyx_v_i;
              if (__pyx_t_205 &lt; 0) __pyx_t_205 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_206 &lt; 0) __pyx_t_206 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_205, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_206, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L30;
          }
          __pyx_L30:;
          goto __pyx_L27;
        }
        __pyx_L27:;
      }
      __pyx_L10:;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;507: </pre>
<pre class='cython line score-0'>&#xA0;508: </pre>
<pre class='cython line score-0'>&#xA0;509:             else: # three reactants!! (really?)</pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+510:                 corr = - 2* k * C[ir[j,0]] * C[ir[j,1]] * C[ir[j,2]] / Ctot</pre>
<pre class='cython code score-5'>      __pyx_t_201 = __pyx_v_j;
      __pyx_t_207 = 0;
      if (__pyx_t_201 &lt; 0) __pyx_t_201 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_207 &lt; 0) __pyx_t_207 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_208 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_201, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_207, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_208 &lt; 0) __pyx_t_208 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_202 = __pyx_v_j;
      __pyx_t_209 = 1;
      if (__pyx_t_202 &lt; 0) __pyx_t_202 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_209 &lt; 0) __pyx_t_209 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_210 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_202, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_209, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_210 &lt; 0) __pyx_t_210 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_211 = __pyx_v_j;
      __pyx_t_212 = 2;
      if (__pyx_t_211 &lt; 0) __pyx_t_211 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_212 &lt; 0) __pyx_t_212 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_213 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_211, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_212, __pyx_pybuffernd_ir.diminfo[1].strides));
      if (__pyx_t_213 &lt; 0) __pyx_t_213 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_18 = ((((-2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_208, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_210, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_213, __pyx_pybuffernd_C.diminfo[0].strides)));
      if (unlikely(__pyx_v_Ctot == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_corr = (__pyx_t_18 / __pyx_v_Ctot);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+511:                 if (ir[j,0] == ir[j,1] &amp; ir[j,0] == ir[j,2]):</pre>
<pre class='cython code score-0'>      __pyx_t_214 = __pyx_v_j;
      __pyx_t_215 = 0;
      if (__pyx_t_214 &lt; 0) __pyx_t_214 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_215 &lt; 0) __pyx_t_215 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_216 = __pyx_v_j;
      __pyx_t_217 = 1;
      if (__pyx_t_216 &lt; 0) __pyx_t_216 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_217 &lt; 0) __pyx_t_217 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_218 = __pyx_v_j;
      __pyx_t_219 = 0;
      if (__pyx_t_218 &lt; 0) __pyx_t_218 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_219 &lt; 0) __pyx_t_219 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_220 = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_216, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_217, __pyx_pybuffernd_ir.diminfo[1].strides)) &amp; (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_218, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_219, __pyx_pybuffernd_ir.diminfo[1].strides)));
      __pyx_t_23 = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_214, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_215, __pyx_pybuffernd_ir.diminfo[1].strides)) == __pyx_t_220);
      if (__pyx_t_23) {
        __pyx_t_221 = __pyx_v_j;
        __pyx_t_222 = 2;
        if (__pyx_t_221 &lt; 0) __pyx_t_221 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_222 &lt; 0) __pyx_t_222 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (__pyx_t_220 == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_221, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_222, __pyx_pybuffernd_ir.diminfo[1].strides)));
      }
      __pyx_t_223 = (__pyx_t_23 != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+512:                     deriv = 3 * k * C[ir[j,0]] * C[ir[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_224 = __pyx_v_j;
        __pyx_t_225 = 0;
        if (__pyx_t_224 &lt; 0) __pyx_t_224 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_225 &lt; 0) __pyx_t_225 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_220 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_224, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_225, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_220 &lt; 0) __pyx_t_220 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_226 = __pyx_v_j;
        __pyx_t_227 = 0;
        if (__pyx_t_226 &lt; 0) __pyx_t_226 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_227 &lt; 0) __pyx_t_227 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_228 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_226, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_227, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_228 &lt; 0) __pyx_t_228 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((3.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_220, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_228, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+513:                     pd[ir[j,0], ir[j,0]] -= 3 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_229 = __pyx_v_j;
        __pyx_t_230 = 0;
        if (__pyx_t_229 &lt; 0) __pyx_t_229 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_230 &lt; 0) __pyx_t_230 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_231 = __pyx_v_j;
        __pyx_t_232 = 0;
        if (__pyx_t_231 &lt; 0) __pyx_t_231 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_232 &lt; 0) __pyx_t_232 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_233 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_229, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_230, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_234 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_231, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_232, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_233 &lt; 0) __pyx_t_233 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_234 &lt; 0) __pyx_t_234 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_233, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_234, __pyx_pybuffernd_pd.diminfo[1].strides) -= (3.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+514:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_235 = __pyx_v_numCoreSpecies;
        for (__pyx_t_236 = 0; __pyx_t_236 &lt; __pyx_t_235; __pyx_t_236+=1) {
          __pyx_v_i = __pyx_t_236;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+515:                         pd[ir[j,0], i] -= 3 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_237 = __pyx_v_j;
          __pyx_t_238 = 0;
          if (__pyx_t_237 &lt; 0) __pyx_t_237 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_238 &lt; 0) __pyx_t_238 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_239 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_237, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_238, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_240 = __pyx_v_i;
          if (__pyx_t_239 &lt; 0) __pyx_t_239 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_240 &lt; 0) __pyx_t_240 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_239, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_240, __pyx_pybuffernd_pd.diminfo[1].strides) -= (3.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;516: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+517:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_235 = __pyx_v_j;
        __pyx_t_241 = 0;
        if (__pyx_t_235 &lt; 0) __pyx_t_235 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_241 &lt; 0) __pyx_t_241 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_236 = __pyx_v_j;
        __pyx_t_242 = 0;
        if (__pyx_t_236 &lt; 0) __pyx_t_236 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_242 &lt; 0) __pyx_t_242 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_243 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_235, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_241, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_244 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_236, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_242, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_243 &lt; 0) __pyx_t_243 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_244 &lt; 0) __pyx_t_244 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_243, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_244, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+518:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_245 = __pyx_v_numCoreSpecies;
        for (__pyx_t_246 = 0; __pyx_t_246 &lt; __pyx_t_245; __pyx_t_246+=1) {
          __pyx_v_i = __pyx_t_246;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+519:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_247 = __pyx_v_j;
          __pyx_t_248 = 0;
          if (__pyx_t_247 &lt; 0) __pyx_t_247 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_248 &lt; 0) __pyx_t_248 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_249 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_247, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_248, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_250 = __pyx_v_i;
          if (__pyx_t_249 &lt; 0) __pyx_t_249 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_250 &lt; 0) __pyx_t_250 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_249, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_250, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+520:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_245 = __pyx_v_j;
        __pyx_t_251 = 1;
        if (__pyx_t_245 &lt; 0) __pyx_t_245 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_251 &lt; 0) __pyx_t_251 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_245, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_251, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+521:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_246 = __pyx_v_j;
          __pyx_t_252 = 1;
          if (__pyx_t_246 &lt; 0) __pyx_t_246 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_252 &lt; 0) __pyx_t_252 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_253 = __pyx_v_j;
          __pyx_t_254 = 0;
          if (__pyx_t_253 &lt; 0) __pyx_t_253 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_254 &lt; 0) __pyx_t_254 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_255 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_246, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_252, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_256 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_253, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_254, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_255 &lt; 0) __pyx_t_255 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_256 &lt; 0) __pyx_t_256 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_255, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_256, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+522:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_257 = __pyx_v_numCoreSpecies;
          for (__pyx_t_258 = 0; __pyx_t_258 &lt; __pyx_t_257; __pyx_t_258+=1) {
            __pyx_v_i = __pyx_t_258;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+523:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_259 = __pyx_v_j;
            __pyx_t_260 = 1;
            if (__pyx_t_259 &lt; 0) __pyx_t_259 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_260 &lt; 0) __pyx_t_260 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_261 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_259, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_260, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_262 = __pyx_v_i;
            if (__pyx_t_261 &lt; 0) __pyx_t_261 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_262 &lt; 0) __pyx_t_262 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_261, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_262, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+524:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_257 = __pyx_v_j;
          __pyx_t_263 = 2;
          if (__pyx_t_257 &lt; 0) __pyx_t_257 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_263 &lt; 0) __pyx_t_263 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_257, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_263, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+525:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_258 = __pyx_v_j;
            __pyx_t_264 = 2;
            if (__pyx_t_258 &lt; 0) __pyx_t_258 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_264 &lt; 0) __pyx_t_264 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_265 = __pyx_v_j;
            __pyx_t_266 = 0;
            if (__pyx_t_265 &lt; 0) __pyx_t_265 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_266 &lt; 0) __pyx_t_266 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_267 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_258, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_264, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_268 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_265, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_266, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_267 &lt; 0) __pyx_t_267 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_268 &lt; 0) __pyx_t_268 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_267, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_268, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+526:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_269 = __pyx_v_numCoreSpecies;
            for (__pyx_t_270 = 0; __pyx_t_270 &lt; __pyx_t_269; __pyx_t_270+=1) {
              __pyx_v_i = __pyx_t_270;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+527:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_271 = __pyx_v_j;
              __pyx_t_272 = 2;
              if (__pyx_t_271 &lt; 0) __pyx_t_271 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_272 &lt; 0) __pyx_t_272 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_273 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_271, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_272, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_274 = __pyx_v_i;
              if (__pyx_t_273 &lt; 0) __pyx_t_273 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_274 &lt; 0) __pyx_t_274 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_273, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_274, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L41;
          }
          __pyx_L41:;
          goto __pyx_L38;
        }
        __pyx_L38:;
        goto __pyx_L33;
      }
</pre><pre class='cython line score-0'>&#xA0;528: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+529:                 elif ir[j,0] == ir[j,1]:</pre>
<pre class='cython code score-0'>      __pyx_t_269 = __pyx_v_j;
      __pyx_t_275 = 0;
      if (__pyx_t_269 &lt; 0) __pyx_t_269 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_275 &lt; 0) __pyx_t_275 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_270 = __pyx_v_j;
      __pyx_t_276 = 1;
      if (__pyx_t_270 &lt; 0) __pyx_t_270 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_276 &lt; 0) __pyx_t_276 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_269, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_275, __pyx_pybuffernd_ir.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_270, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_276, __pyx_pybuffernd_ir.diminfo[1].strides))) != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0'>&#xA0;530:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+531:                     deriv = 2 * k * C[ir[j,0]] * C[ir[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_277 = __pyx_v_j;
        __pyx_t_278 = 0;
        if (__pyx_t_277 &lt; 0) __pyx_t_277 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_278 &lt; 0) __pyx_t_278 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_279 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_277, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_278, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_279 &lt; 0) __pyx_t_279 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_280 = __pyx_v_j;
        __pyx_t_281 = 2;
        if (__pyx_t_280 &lt; 0) __pyx_t_280 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_281 &lt; 0) __pyx_t_281 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_282 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_280, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_281, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_282 &lt; 0) __pyx_t_282 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_279, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_282, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+532:                     pd[ir[j,0], ir[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_283 = __pyx_v_j;
        __pyx_t_284 = 0;
        if (__pyx_t_283 &lt; 0) __pyx_t_283 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_284 &lt; 0) __pyx_t_284 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_285 = __pyx_v_j;
        __pyx_t_286 = 0;
        if (__pyx_t_285 &lt; 0) __pyx_t_285 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_286 &lt; 0) __pyx_t_286 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_287 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_283, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_284, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_288 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_285, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_286, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_287 &lt; 0) __pyx_t_287 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_288 &lt; 0) __pyx_t_288 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_287, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_288, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+533:                     pd[ir[j,2], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_289 = __pyx_v_j;
        __pyx_t_290 = 2;
        if (__pyx_t_289 &lt; 0) __pyx_t_289 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_290 &lt; 0) __pyx_t_290 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_291 = __pyx_v_j;
        __pyx_t_292 = 0;
        if (__pyx_t_291 &lt; 0) __pyx_t_291 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_292 &lt; 0) __pyx_t_292 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_293 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_289, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_290, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_294 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_291, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_292, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_293 &lt; 0) __pyx_t_293 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_294 &lt; 0) __pyx_t_294 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_293, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_294, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;534: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+535:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_295 = __pyx_v_j;
        __pyx_t_296 = 0;
        if (__pyx_t_295 &lt; 0) __pyx_t_295 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_296 &lt; 0) __pyx_t_296 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_297 = __pyx_v_j;
        __pyx_t_298 = 0;
        if (__pyx_t_297 &lt; 0) __pyx_t_297 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_298 &lt; 0) __pyx_t_298 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_299 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_295, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_296, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_300 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_297, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_298, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_299 &lt; 0) __pyx_t_299 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_300 &lt; 0) __pyx_t_300 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_299, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_300, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+536:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_301 = __pyx_v_j;
        __pyx_t_302 = 1;
        if (__pyx_t_301 &lt; 0) __pyx_t_301 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_302 &lt; 0) __pyx_t_302 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_301, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_302, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+537:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_303 = __pyx_v_j;
          __pyx_t_304 = 1;
          if (__pyx_t_303 &lt; 0) __pyx_t_303 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_304 &lt; 0) __pyx_t_304 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_305 = __pyx_v_j;
          __pyx_t_306 = 0;
          if (__pyx_t_305 &lt; 0) __pyx_t_305 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_306 &lt; 0) __pyx_t_306 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_307 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_303, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_304, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_308 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_305, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_306, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_307 &lt; 0) __pyx_t_307 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_308 &lt; 0) __pyx_t_308 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_307, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_308, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+538:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_309 = __pyx_v_j;
          __pyx_t_310 = 2;
          if (__pyx_t_309 &lt; 0) __pyx_t_309 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_310 &lt; 0) __pyx_t_310 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_309, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_310, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+539:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_311 = __pyx_v_j;
            __pyx_t_312 = 2;
            if (__pyx_t_311 &lt; 0) __pyx_t_311 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_312 &lt; 0) __pyx_t_312 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_313 = __pyx_v_j;
            __pyx_t_314 = 0;
            if (__pyx_t_313 &lt; 0) __pyx_t_313 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_314 &lt; 0) __pyx_t_314 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_315 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_311, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_312, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_316 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_313, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_314, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_315 &lt; 0) __pyx_t_315 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_316 &lt; 0) __pyx_t_316 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_315, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_316, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L45;
          }
          __pyx_L45:;
          goto __pyx_L44;
        }
        __pyx_L44:;
</pre><pre class='cython line score-0'>&#xA0;540: </pre>
<pre class='cython line score-0'>&#xA0;541:                     # derivative with respect to reactant 3</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+542:                     deriv = k * C[ir[j,0]] * C[ir[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_317 = __pyx_v_j;
        __pyx_t_318 = 0;
        if (__pyx_t_317 &lt; 0) __pyx_t_317 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_318 &lt; 0) __pyx_t_318 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_319 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_317, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_318, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_319 &lt; 0) __pyx_t_319 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_320 = __pyx_v_j;
        __pyx_t_321 = 0;
        if (__pyx_t_320 &lt; 0) __pyx_t_320 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_321 &lt; 0) __pyx_t_321 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_322 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_320, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_321, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_322 &lt; 0) __pyx_t_322 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_319, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_322, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+543:                     pd[ir[j,0], ir[j,2]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_323 = __pyx_v_j;
        __pyx_t_324 = 0;
        if (__pyx_t_323 &lt; 0) __pyx_t_323 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_324 &lt; 0) __pyx_t_324 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_325 = __pyx_v_j;
        __pyx_t_326 = 2;
        if (__pyx_t_325 &lt; 0) __pyx_t_325 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_326 &lt; 0) __pyx_t_326 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_327 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_323, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_324, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_328 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_325, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_326, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_327 &lt; 0) __pyx_t_327 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_328 &lt; 0) __pyx_t_328 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_327, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_328, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+544:                     pd[ir[j,2], ir[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_329 = __pyx_v_j;
        __pyx_t_330 = 2;
        if (__pyx_t_329 &lt; 0) __pyx_t_329 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_330 &lt; 0) __pyx_t_330 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_331 = __pyx_v_j;
        __pyx_t_332 = 2;
        if (__pyx_t_331 &lt; 0) __pyx_t_331 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_332 &lt; 0) __pyx_t_332 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_333 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_329, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_330, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_334 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_331, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_332, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_333 &lt; 0) __pyx_t_333 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_334 &lt; 0) __pyx_t_334 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_333, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_334, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+545:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_335 = __pyx_v_numCoreSpecies;
        for (__pyx_t_336 = 0; __pyx_t_336 &lt; __pyx_t_335; __pyx_t_336+=1) {
          __pyx_v_i = __pyx_t_336;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+546:                         pd[ir[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_337 = __pyx_v_j;
          __pyx_t_338 = 0;
          if (__pyx_t_337 &lt; 0) __pyx_t_337 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_338 &lt; 0) __pyx_t_338 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_339 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_337, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_338, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_340 = __pyx_v_i;
          if (__pyx_t_339 &lt; 0) __pyx_t_339 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_340 &lt; 0) __pyx_t_340 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_339, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_340, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+547:                         pd[ir[j,2], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_341 = __pyx_v_j;
          __pyx_t_342 = 2;
          if (__pyx_t_341 &lt; 0) __pyx_t_341 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_342 &lt; 0) __pyx_t_342 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_343 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_341, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_342, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_344 = __pyx_v_i;
          if (__pyx_t_343 &lt; 0) __pyx_t_343 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_344 &lt; 0) __pyx_t_344 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_343, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_344, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;548: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+549:                     pd[ip[j,0], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_335 = __pyx_v_j;
        __pyx_t_345 = 0;
        if (__pyx_t_335 &lt; 0) __pyx_t_335 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_345 &lt; 0) __pyx_t_345 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_336 = __pyx_v_j;
        __pyx_t_346 = 2;
        if (__pyx_t_336 &lt; 0) __pyx_t_336 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_346 &lt; 0) __pyx_t_346 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_347 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_335, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_345, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_348 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_336, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_346, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_347 &lt; 0) __pyx_t_347 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_348 &lt; 0) __pyx_t_348 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_347, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_348, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+550:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_349 = __pyx_v_numCoreSpecies;
        for (__pyx_t_350 = 0; __pyx_t_350 &lt; __pyx_t_349; __pyx_t_350+=1) {
          __pyx_v_i = __pyx_t_350;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+551:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_351 = __pyx_v_j;
          __pyx_t_352 = 0;
          if (__pyx_t_351 &lt; 0) __pyx_t_351 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_352 &lt; 0) __pyx_t_352 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_353 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_351, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_352, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_354 = __pyx_v_i;
          if (__pyx_t_353 &lt; 0) __pyx_t_353 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_354 &lt; 0) __pyx_t_354 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_353, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_354, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+552:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_349 = __pyx_v_j;
        __pyx_t_355 = 1;
        if (__pyx_t_349 &lt; 0) __pyx_t_349 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_355 &lt; 0) __pyx_t_355 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_349, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_355, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+553:                         pd[ip[j,1], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_350 = __pyx_v_j;
          __pyx_t_356 = 1;
          if (__pyx_t_350 &lt; 0) __pyx_t_350 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_356 &lt; 0) __pyx_t_356 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_357 = __pyx_v_j;
          __pyx_t_358 = 2;
          if (__pyx_t_357 &lt; 0) __pyx_t_357 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_358 &lt; 0) __pyx_t_358 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_359 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_350, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_356, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_360 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_357, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_358, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_359 &lt; 0) __pyx_t_359 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_360 &lt; 0) __pyx_t_360 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_359, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_360, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+554:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_361 = __pyx_v_numCoreSpecies;
          for (__pyx_t_362 = 0; __pyx_t_362 &lt; __pyx_t_361; __pyx_t_362+=1) {
            __pyx_v_i = __pyx_t_362;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+555:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_363 = __pyx_v_j;
            __pyx_t_364 = 1;
            if (__pyx_t_363 &lt; 0) __pyx_t_363 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_364 &lt; 0) __pyx_t_364 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_365 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_363, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_364, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_366 = __pyx_v_i;
            if (__pyx_t_365 &lt; 0) __pyx_t_365 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_366 &lt; 0) __pyx_t_366 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_365, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_366, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+556:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_361 = __pyx_v_j;
          __pyx_t_367 = 2;
          if (__pyx_t_361 &lt; 0) __pyx_t_361 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_367 &lt; 0) __pyx_t_367 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_361, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_367, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+557:                             pd[ip[j,2], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_362 = __pyx_v_j;
            __pyx_t_368 = 2;
            if (__pyx_t_362 &lt; 0) __pyx_t_362 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_368 &lt; 0) __pyx_t_368 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_369 = __pyx_v_j;
            __pyx_t_370 = 2;
            if (__pyx_t_369 &lt; 0) __pyx_t_369 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_370 &lt; 0) __pyx_t_370 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_371 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_362, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_368, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_372 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_369, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_370, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_371 &lt; 0) __pyx_t_371 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_372 &lt; 0) __pyx_t_372 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_371, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_372, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+558:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_373 = __pyx_v_numCoreSpecies;
            for (__pyx_t_374 = 0; __pyx_t_374 &lt; __pyx_t_373; __pyx_t_374+=1) {
              __pyx_v_i = __pyx_t_374;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+559:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_375 = __pyx_v_j;
              __pyx_t_376 = 2;
              if (__pyx_t_375 &lt; 0) __pyx_t_375 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_376 &lt; 0) __pyx_t_376 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_377 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_375, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_376, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_378 = __pyx_v_i;
              if (__pyx_t_377 &lt; 0) __pyx_t_377 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_378 &lt; 0) __pyx_t_378 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_377, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_378, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L53;
          }
          __pyx_L53:;
          goto __pyx_L50;
        }
        __pyx_L50:;
        goto __pyx_L33;
      }
</pre><pre class='cython line score-0'>&#xA0;560: </pre>
<pre class='cython line score-0'>&#xA0;561: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+562:                 elif ir[j,1] == ir[j,2]:</pre>
<pre class='cython code score-0'>      __pyx_t_373 = __pyx_v_j;
      __pyx_t_379 = 1;
      if (__pyx_t_373 &lt; 0) __pyx_t_373 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_379 &lt; 0) __pyx_t_379 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_374 = __pyx_v_j;
      __pyx_t_380 = 2;
      if (__pyx_t_374 &lt; 0) __pyx_t_374 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_380 &lt; 0) __pyx_t_380 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_373, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_379, __pyx_pybuffernd_ir.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_374, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_380, __pyx_pybuffernd_ir.diminfo[1].strides))) != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0'>&#xA0;563:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+564:                     deriv = k * C[ir[j,1]] * C[ir[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_381 = __pyx_v_j;
        __pyx_t_382 = 1;
        if (__pyx_t_381 &lt; 0) __pyx_t_381 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_382 &lt; 0) __pyx_t_382 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_383 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_381, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_382, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_383 &lt; 0) __pyx_t_383 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_384 = __pyx_v_j;
        __pyx_t_385 = 1;
        if (__pyx_t_384 &lt; 0) __pyx_t_384 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_385 &lt; 0) __pyx_t_385 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_386 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_384, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_385, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_386 &lt; 0) __pyx_t_386 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_383, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_386, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+565:                     pd[ir[j,0], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_387 = __pyx_v_j;
        __pyx_t_388 = 0;
        if (__pyx_t_387 &lt; 0) __pyx_t_387 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_388 &lt; 0) __pyx_t_388 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_389 = __pyx_v_j;
        __pyx_t_390 = 0;
        if (__pyx_t_389 &lt; 0) __pyx_t_389 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_390 &lt; 0) __pyx_t_390 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_391 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_387, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_388, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_392 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_389, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_390, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_391 &lt; 0) __pyx_t_391 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_392 &lt; 0) __pyx_t_392 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_391, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_392, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+566:                     pd[ir[j,1], ir[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_393 = __pyx_v_j;
        __pyx_t_394 = 1;
        if (__pyx_t_393 &lt; 0) __pyx_t_393 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_394 &lt; 0) __pyx_t_394 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_395 = __pyx_v_j;
        __pyx_t_396 = 0;
        if (__pyx_t_395 &lt; 0) __pyx_t_395 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_396 &lt; 0) __pyx_t_396 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_397 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_393, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_394, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_398 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_395, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_396, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_397 &lt; 0) __pyx_t_397 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_398 &lt; 0) __pyx_t_398 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_397, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_398, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0'>&#xA0;567: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+568:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_399 = __pyx_v_j;
        __pyx_t_400 = 0;
        if (__pyx_t_399 &lt; 0) __pyx_t_399 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_400 &lt; 0) __pyx_t_400 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_401 = __pyx_v_j;
        __pyx_t_402 = 0;
        if (__pyx_t_401 &lt; 0) __pyx_t_401 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_402 &lt; 0) __pyx_t_402 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_403 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_399, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_400, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_404 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_401, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_402, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_403 &lt; 0) __pyx_t_403 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_404 &lt; 0) __pyx_t_404 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_403, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_404, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+569:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_405 = __pyx_v_j;
        __pyx_t_406 = 1;
        if (__pyx_t_405 &lt; 0) __pyx_t_405 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_406 &lt; 0) __pyx_t_406 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_405, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_406, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+570:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_407 = __pyx_v_j;
          __pyx_t_408 = 1;
          if (__pyx_t_407 &lt; 0) __pyx_t_407 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_408 &lt; 0) __pyx_t_408 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_409 = __pyx_v_j;
          __pyx_t_410 = 0;
          if (__pyx_t_409 &lt; 0) __pyx_t_409 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_410 &lt; 0) __pyx_t_410 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_411 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_407, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_408, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_412 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_409, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_410, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_411 &lt; 0) __pyx_t_411 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_412 &lt; 0) __pyx_t_412 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_411, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_412, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+571:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_413 = __pyx_v_j;
          __pyx_t_414 = 2;
          if (__pyx_t_413 &lt; 0) __pyx_t_413 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_414 &lt; 0) __pyx_t_414 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_413, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_414, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+572:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_415 = __pyx_v_j;
            __pyx_t_416 = 2;
            if (__pyx_t_415 &lt; 0) __pyx_t_415 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_416 &lt; 0) __pyx_t_416 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_417 = __pyx_v_j;
            __pyx_t_418 = 0;
            if (__pyx_t_417 &lt; 0) __pyx_t_417 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_418 &lt; 0) __pyx_t_418 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_419 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_415, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_416, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_420 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_417, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_418, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_419 &lt; 0) __pyx_t_419 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_420 &lt; 0) __pyx_t_420 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_419, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_420, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L57;
          }
          __pyx_L57:;
          goto __pyx_L56;
        }
        __pyx_L56:;
</pre><pre class='cython line score-0'>&#xA0;573:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+574:                     deriv = 2 * k * C[ir[j,0]] * C[ir[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_421 = __pyx_v_j;
        __pyx_t_422 = 0;
        if (__pyx_t_421 &lt; 0) __pyx_t_421 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_422 &lt; 0) __pyx_t_422 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_423 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_421, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_422, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_423 &lt; 0) __pyx_t_423 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_424 = __pyx_v_j;
        __pyx_t_425 = 1;
        if (__pyx_t_424 &lt; 0) __pyx_t_424 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_425 &lt; 0) __pyx_t_425 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_426 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_424, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_425, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_426 &lt; 0) __pyx_t_426 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_423, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_426, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+575:                     pd[ir[j,0], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_427 = __pyx_v_j;
        __pyx_t_428 = 0;
        if (__pyx_t_427 &lt; 0) __pyx_t_427 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_428 &lt; 0) __pyx_t_428 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_429 = __pyx_v_j;
        __pyx_t_430 = 1;
        if (__pyx_t_429 &lt; 0) __pyx_t_429 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_430 &lt; 0) __pyx_t_430 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_431 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_427, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_428, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_432 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_429, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_430, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_431 &lt; 0) __pyx_t_431 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_432 &lt; 0) __pyx_t_432 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_431, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_432, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+576:                     pd[ir[j,1], ir[j,1]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_433 = __pyx_v_j;
        __pyx_t_434 = 1;
        if (__pyx_t_433 &lt; 0) __pyx_t_433 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_434 &lt; 0) __pyx_t_434 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_435 = __pyx_v_j;
        __pyx_t_436 = 1;
        if (__pyx_t_435 &lt; 0) __pyx_t_435 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_436 &lt; 0) __pyx_t_436 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_437 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_433, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_434, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_438 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_435, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_436, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_437 &lt; 0) __pyx_t_437 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_438 &lt; 0) __pyx_t_438 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_437, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_438, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+577:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_439 = __pyx_v_numCoreSpecies;
        for (__pyx_t_440 = 0; __pyx_t_440 &lt; __pyx_t_439; __pyx_t_440+=1) {
          __pyx_v_i = __pyx_t_440;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+578:                         pd[ir[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_441 = __pyx_v_j;
          __pyx_t_442 = 0;
          if (__pyx_t_441 &lt; 0) __pyx_t_441 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_442 &lt; 0) __pyx_t_442 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_443 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_441, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_442, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_444 = __pyx_v_i;
          if (__pyx_t_443 &lt; 0) __pyx_t_443 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_444 &lt; 0) __pyx_t_444 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_443, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_444, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+579:                         pd[ir[j,1], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_445 = __pyx_v_j;
          __pyx_t_446 = 1;
          if (__pyx_t_445 &lt; 0) __pyx_t_445 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_446 &lt; 0) __pyx_t_446 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_447 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_445, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_446, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_448 = __pyx_v_i;
          if (__pyx_t_447 &lt; 0) __pyx_t_447 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_448 &lt; 0) __pyx_t_448 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_447, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_448, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;580: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+581:                     pd[ip[j,0], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_439 = __pyx_v_j;
        __pyx_t_449 = 0;
        if (__pyx_t_439 &lt; 0) __pyx_t_439 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_449 &lt; 0) __pyx_t_449 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_440 = __pyx_v_j;
        __pyx_t_450 = 1;
        if (__pyx_t_440 &lt; 0) __pyx_t_440 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_450 &lt; 0) __pyx_t_450 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_451 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_439, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_449, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_452 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_440, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_450, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_451 &lt; 0) __pyx_t_451 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_452 &lt; 0) __pyx_t_452 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_451, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_452, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+582:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_453 = __pyx_v_numCoreSpecies;
        for (__pyx_t_454 = 0; __pyx_t_454 &lt; __pyx_t_453; __pyx_t_454+=1) {
          __pyx_v_i = __pyx_t_454;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+583:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_455 = __pyx_v_j;
          __pyx_t_456 = 0;
          if (__pyx_t_455 &lt; 0) __pyx_t_455 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_456 &lt; 0) __pyx_t_456 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_457 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_455, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_456, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_458 = __pyx_v_i;
          if (__pyx_t_457 &lt; 0) __pyx_t_457 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_458 &lt; 0) __pyx_t_458 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_457, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_458, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+584:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_453 = __pyx_v_j;
        __pyx_t_459 = 1;
        if (__pyx_t_453 &lt; 0) __pyx_t_453 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_459 &lt; 0) __pyx_t_459 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_453, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_459, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+585:                         pd[ip[j,1], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_454 = __pyx_v_j;
          __pyx_t_460 = 1;
          if (__pyx_t_454 &lt; 0) __pyx_t_454 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_460 &lt; 0) __pyx_t_460 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_461 = __pyx_v_j;
          __pyx_t_462 = 1;
          if (__pyx_t_461 &lt; 0) __pyx_t_461 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_462 &lt; 0) __pyx_t_462 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_463 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_454, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_460, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_464 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_461, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_462, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_463 &lt; 0) __pyx_t_463 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_464 &lt; 0) __pyx_t_464 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_463, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_464, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+586:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_465 = __pyx_v_numCoreSpecies;
          for (__pyx_t_466 = 0; __pyx_t_466 &lt; __pyx_t_465; __pyx_t_466+=1) {
            __pyx_v_i = __pyx_t_466;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+587:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_467 = __pyx_v_j;
            __pyx_t_468 = 1;
            if (__pyx_t_467 &lt; 0) __pyx_t_467 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_468 &lt; 0) __pyx_t_468 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_469 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_467, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_468, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_470 = __pyx_v_i;
            if (__pyx_t_469 &lt; 0) __pyx_t_469 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_470 &lt; 0) __pyx_t_470 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_469, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_470, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+588:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_465 = __pyx_v_j;
          __pyx_t_471 = 2;
          if (__pyx_t_465 &lt; 0) __pyx_t_465 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_471 &lt; 0) __pyx_t_471 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_465, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_471, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+589:                             pd[ip[j,2], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_466 = __pyx_v_j;
            __pyx_t_472 = 2;
            if (__pyx_t_466 &lt; 0) __pyx_t_466 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_472 &lt; 0) __pyx_t_472 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_473 = __pyx_v_j;
            __pyx_t_474 = 1;
            if (__pyx_t_473 &lt; 0) __pyx_t_473 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_474 &lt; 0) __pyx_t_474 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_475 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_466, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_472, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_476 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_473, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_474, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_475 &lt; 0) __pyx_t_475 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_476 &lt; 0) __pyx_t_476 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_475, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_476, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+590:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_477 = __pyx_v_numCoreSpecies;
            for (__pyx_t_478 = 0; __pyx_t_478 &lt; __pyx_t_477; __pyx_t_478+=1) {
              __pyx_v_i = __pyx_t_478;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+591:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_479 = __pyx_v_j;
              __pyx_t_480 = 2;
              if (__pyx_t_479 &lt; 0) __pyx_t_479 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_480 &lt; 0) __pyx_t_480 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_481 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_479, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_480, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_482 = __pyx_v_i;
              if (__pyx_t_481 &lt; 0) __pyx_t_481 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_482 &lt; 0) __pyx_t_482 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_481, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_482, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L65;
          }
          __pyx_L65:;
          goto __pyx_L62;
        }
        __pyx_L62:;
        goto __pyx_L33;
      }
</pre><pre class='cython line score-0'>&#xA0;592: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+593:                 elif ir[j,0] == ir[j,2]:</pre>
<pre class='cython code score-0'>      __pyx_t_477 = __pyx_v_j;
      __pyx_t_483 = 0;
      if (__pyx_t_477 &lt; 0) __pyx_t_477 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_483 &lt; 0) __pyx_t_483 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_478 = __pyx_v_j;
      __pyx_t_484 = 2;
      if (__pyx_t_478 &lt; 0) __pyx_t_478 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_484 &lt; 0) __pyx_t_484 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_477, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_483, __pyx_pybuffernd_ir.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_478, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_484, __pyx_pybuffernd_ir.diminfo[1].strides))) != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0'>&#xA0;594:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+595:                     deriv = 2 * k * C[ir[j,0]] * C[ir[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_485 = __pyx_v_j;
        __pyx_t_486 = 0;
        if (__pyx_t_485 &lt; 0) __pyx_t_485 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_486 &lt; 0) __pyx_t_486 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_487 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_485, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_486, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_487 &lt; 0) __pyx_t_487 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_488 = __pyx_v_j;
        __pyx_t_489 = 1;
        if (__pyx_t_488 &lt; 0) __pyx_t_488 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_489 &lt; 0) __pyx_t_489 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_490 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_488, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_489, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_490 &lt; 0) __pyx_t_490 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_487, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_490, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+596:                     pd[ir[j,0], ir[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_491 = __pyx_v_j;
        __pyx_t_492 = 0;
        if (__pyx_t_491 &lt; 0) __pyx_t_491 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_492 &lt; 0) __pyx_t_492 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_493 = __pyx_v_j;
        __pyx_t_494 = 0;
        if (__pyx_t_493 &lt; 0) __pyx_t_493 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_494 &lt; 0) __pyx_t_494 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_495 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_491, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_492, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_496 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_493, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_494, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_495 &lt; 0) __pyx_t_495 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_496 &lt; 0) __pyx_t_496 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_495, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_496, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+597:                     pd[ir[j,1], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_497 = __pyx_v_j;
        __pyx_t_498 = 1;
        if (__pyx_t_497 &lt; 0) __pyx_t_497 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_498 &lt; 0) __pyx_t_498 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_499 = __pyx_v_j;
        __pyx_t_500 = 0;
        if (__pyx_t_499 &lt; 0) __pyx_t_499 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_500 &lt; 0) __pyx_t_500 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_501 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_497, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_498, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_502 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_499, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_500, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_501 &lt; 0) __pyx_t_501 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_502 &lt; 0) __pyx_t_502 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_501, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_502, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;598: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+599:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_503 = __pyx_v_j;
        __pyx_t_504 = 0;
        if (__pyx_t_503 &lt; 0) __pyx_t_503 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_504 &lt; 0) __pyx_t_504 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_505 = __pyx_v_j;
        __pyx_t_506 = 0;
        if (__pyx_t_505 &lt; 0) __pyx_t_505 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_506 &lt; 0) __pyx_t_506 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_507 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_503, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_504, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_508 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_505, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_506, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_507 &lt; 0) __pyx_t_507 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_508 &lt; 0) __pyx_t_508 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_507, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_508, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+600:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_509 = __pyx_v_j;
        __pyx_t_510 = 1;
        if (__pyx_t_509 &lt; 0) __pyx_t_509 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_510 &lt; 0) __pyx_t_510 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_509, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_510, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+601:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_511 = __pyx_v_j;
          __pyx_t_512 = 1;
          if (__pyx_t_511 &lt; 0) __pyx_t_511 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_512 &lt; 0) __pyx_t_512 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_513 = __pyx_v_j;
          __pyx_t_514 = 0;
          if (__pyx_t_513 &lt; 0) __pyx_t_513 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_514 &lt; 0) __pyx_t_514 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_515 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_511, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_512, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_516 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_513, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_514, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_515 &lt; 0) __pyx_t_515 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_516 &lt; 0) __pyx_t_516 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_515, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_516, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+602:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_517 = __pyx_v_j;
          __pyx_t_518 = 2;
          if (__pyx_t_517 &lt; 0) __pyx_t_517 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_518 &lt; 0) __pyx_t_518 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_517, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_518, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+603:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_519 = __pyx_v_j;
            __pyx_t_520 = 2;
            if (__pyx_t_519 &lt; 0) __pyx_t_519 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_520 &lt; 0) __pyx_t_520 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_521 = __pyx_v_j;
            __pyx_t_522 = 0;
            if (__pyx_t_521 &lt; 0) __pyx_t_521 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_522 &lt; 0) __pyx_t_522 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_523 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_519, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_520, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_524 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_521, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_522, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_523 &lt; 0) __pyx_t_523 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_524 &lt; 0) __pyx_t_524 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_523, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_524, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L69;
          }
          __pyx_L69:;
          goto __pyx_L68;
        }
        __pyx_L68:;
</pre><pre class='cython line score-0'>&#xA0;604:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+605:                     deriv = k * C[ir[j,0]] * C[ir[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_525 = __pyx_v_j;
        __pyx_t_526 = 0;
        if (__pyx_t_525 &lt; 0) __pyx_t_525 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_526 &lt; 0) __pyx_t_526 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_527 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_525, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_526, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_527 &lt; 0) __pyx_t_527 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_528 = __pyx_v_j;
        __pyx_t_529 = 0;
        if (__pyx_t_528 &lt; 0) __pyx_t_528 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_529 &lt; 0) __pyx_t_529 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_530 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_528, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_529, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_530 &lt; 0) __pyx_t_530 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_527, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_530, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+606:                     pd[ir[j,0], ir[j,1]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_531 = __pyx_v_j;
        __pyx_t_532 = 0;
        if (__pyx_t_531 &lt; 0) __pyx_t_531 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_532 &lt; 0) __pyx_t_532 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_533 = __pyx_v_j;
        __pyx_t_534 = 1;
        if (__pyx_t_533 &lt; 0) __pyx_t_533 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_534 &lt; 0) __pyx_t_534 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_535 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_531, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_532, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_536 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_533, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_534, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_535 &lt; 0) __pyx_t_535 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_536 &lt; 0) __pyx_t_536 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_535, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_536, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+607:                     pd[ir[j,1], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_537 = __pyx_v_j;
        __pyx_t_538 = 1;
        if (__pyx_t_537 &lt; 0) __pyx_t_537 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_538 &lt; 0) __pyx_t_538 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_539 = __pyx_v_j;
        __pyx_t_540 = 1;
        if (__pyx_t_539 &lt; 0) __pyx_t_539 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_540 &lt; 0) __pyx_t_540 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_541 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_537, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_538, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_542 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_539, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_540, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_541 &lt; 0) __pyx_t_541 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_542 &lt; 0) __pyx_t_542 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_541, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_542, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+608:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_543 = __pyx_v_numCoreSpecies;
        for (__pyx_t_544 = 0; __pyx_t_544 &lt; __pyx_t_543; __pyx_t_544+=1) {
          __pyx_v_i = __pyx_t_544;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+609:                         pd[ir[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_545 = __pyx_v_j;
          __pyx_t_546 = 0;
          if (__pyx_t_545 &lt; 0) __pyx_t_545 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_546 &lt; 0) __pyx_t_546 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_547 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_545, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_546, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_548 = __pyx_v_i;
          if (__pyx_t_547 &lt; 0) __pyx_t_547 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_548 &lt; 0) __pyx_t_548 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_547, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_548, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+610:                         pd[ir[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_549 = __pyx_v_j;
          __pyx_t_550 = 1;
          if (__pyx_t_549 &lt; 0) __pyx_t_549 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_550 &lt; 0) __pyx_t_550 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_551 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_549, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_550, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_552 = __pyx_v_i;
          if (__pyx_t_551 &lt; 0) __pyx_t_551 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_552 &lt; 0) __pyx_t_552 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_551, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_552, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;611: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+612:                     pd[ip[j,0], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_543 = __pyx_v_j;
        __pyx_t_553 = 0;
        if (__pyx_t_543 &lt; 0) __pyx_t_543 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_553 &lt; 0) __pyx_t_553 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_544 = __pyx_v_j;
        __pyx_t_554 = 1;
        if (__pyx_t_544 &lt; 0) __pyx_t_544 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_554 &lt; 0) __pyx_t_554 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_555 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_543, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_553, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_556 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_544, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_554, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_555 &lt; 0) __pyx_t_555 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_556 &lt; 0) __pyx_t_556 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_555, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_556, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+613:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_557 = __pyx_v_numCoreSpecies;
        for (__pyx_t_558 = 0; __pyx_t_558 &lt; __pyx_t_557; __pyx_t_558+=1) {
          __pyx_v_i = __pyx_t_558;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+614:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_559 = __pyx_v_j;
          __pyx_t_560 = 0;
          if (__pyx_t_559 &lt; 0) __pyx_t_559 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_560 &lt; 0) __pyx_t_560 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_561 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_559, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_560, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_562 = __pyx_v_i;
          if (__pyx_t_561 &lt; 0) __pyx_t_561 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_562 &lt; 0) __pyx_t_562 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_561, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_562, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+615:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_557 = __pyx_v_j;
        __pyx_t_563 = 1;
        if (__pyx_t_557 &lt; 0) __pyx_t_557 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_563 &lt; 0) __pyx_t_563 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_557, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_563, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+616:                         pd[ip[j,1], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_558 = __pyx_v_j;
          __pyx_t_564 = 1;
          if (__pyx_t_558 &lt; 0) __pyx_t_558 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_564 &lt; 0) __pyx_t_564 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_565 = __pyx_v_j;
          __pyx_t_566 = 1;
          if (__pyx_t_565 &lt; 0) __pyx_t_565 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_566 &lt; 0) __pyx_t_566 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_567 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_558, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_564, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_568 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_565, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_566, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_567 &lt; 0) __pyx_t_567 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_568 &lt; 0) __pyx_t_568 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_567, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_568, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+617:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_569 = __pyx_v_numCoreSpecies;
          for (__pyx_t_570 = 0; __pyx_t_570 &lt; __pyx_t_569; __pyx_t_570+=1) {
            __pyx_v_i = __pyx_t_570;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+618:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_571 = __pyx_v_j;
            __pyx_t_572 = 1;
            if (__pyx_t_571 &lt; 0) __pyx_t_571 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_572 &lt; 0) __pyx_t_572 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_573 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_571, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_572, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_574 = __pyx_v_i;
            if (__pyx_t_573 &lt; 0) __pyx_t_573 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_574 &lt; 0) __pyx_t_574 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_573, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_574, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+619:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_569 = __pyx_v_j;
          __pyx_t_575 = 2;
          if (__pyx_t_569 &lt; 0) __pyx_t_569 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_575 &lt; 0) __pyx_t_575 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_569, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_575, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+620:                             pd[ip[j,2], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_570 = __pyx_v_j;
            __pyx_t_576 = 2;
            if (__pyx_t_570 &lt; 0) __pyx_t_570 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_576 &lt; 0) __pyx_t_576 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_577 = __pyx_v_j;
            __pyx_t_578 = 1;
            if (__pyx_t_577 &lt; 0) __pyx_t_577 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_578 &lt; 0) __pyx_t_578 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_579 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_570, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_576, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_580 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_577, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_578, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_579 &lt; 0) __pyx_t_579 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_580 &lt; 0) __pyx_t_580 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_579, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_580, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+621:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_581 = __pyx_v_numCoreSpecies;
            for (__pyx_t_582 = 0; __pyx_t_582 &lt; __pyx_t_581; __pyx_t_582+=1) {
              __pyx_v_i = __pyx_t_582;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+622:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_583 = __pyx_v_j;
              __pyx_t_584 = 2;
              if (__pyx_t_583 &lt; 0) __pyx_t_583 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_584 &lt; 0) __pyx_t_584 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_585 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_583, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_584, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_586 = __pyx_v_i;
              if (__pyx_t_585 &lt; 0) __pyx_t_585 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_586 &lt; 0) __pyx_t_586 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_585, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_586, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L77;
          }
          __pyx_L77:;
          goto __pyx_L74;
        }
        __pyx_L74:;
        goto __pyx_L33;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;623: </pre>
<pre class='cython line score-0'>&#xA0;624:                 else:</pre>
<pre class='cython line score-0'>&#xA0;625:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+626:                     deriv = k * C[ir[j,1]] * C[ir[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_581 = __pyx_v_j;
        __pyx_t_587 = 1;
        if (__pyx_t_581 &lt; 0) __pyx_t_581 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_587 &lt; 0) __pyx_t_587 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_588 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_581, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_587, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_588 &lt; 0) __pyx_t_588 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_582 = __pyx_v_j;
        __pyx_t_589 = 2;
        if (__pyx_t_582 &lt; 0) __pyx_t_582 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_589 &lt; 0) __pyx_t_589 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_590 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_582, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_589, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_590 &lt; 0) __pyx_t_590 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_588, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_590, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+627:                     pd[ir[j,0], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_591 = __pyx_v_j;
        __pyx_t_592 = 0;
        if (__pyx_t_591 &lt; 0) __pyx_t_591 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_592 &lt; 0) __pyx_t_592 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_593 = __pyx_v_j;
        __pyx_t_594 = 0;
        if (__pyx_t_593 &lt; 0) __pyx_t_593 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_594 &lt; 0) __pyx_t_594 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_595 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_591, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_592, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_596 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_593, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_594, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_595 &lt; 0) __pyx_t_595 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_596 &lt; 0) __pyx_t_596 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_595, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_596, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+628:                     pd[ir[j,1], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_597 = __pyx_v_j;
        __pyx_t_598 = 1;
        if (__pyx_t_597 &lt; 0) __pyx_t_597 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_598 &lt; 0) __pyx_t_598 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_599 = __pyx_v_j;
        __pyx_t_600 = 0;
        if (__pyx_t_599 &lt; 0) __pyx_t_599 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_600 &lt; 0) __pyx_t_600 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_601 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_597, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_598, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_602 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_599, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_600, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_601 &lt; 0) __pyx_t_601 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_602 &lt; 0) __pyx_t_602 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_601, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_602, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+629:                     pd[ir[j,2], ir[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_603 = __pyx_v_j;
        __pyx_t_604 = 2;
        if (__pyx_t_603 &lt; 0) __pyx_t_603 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_604 &lt; 0) __pyx_t_604 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_605 = __pyx_v_j;
        __pyx_t_606 = 0;
        if (__pyx_t_605 &lt; 0) __pyx_t_605 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_606 &lt; 0) __pyx_t_606 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_607 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_603, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_604, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_608 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_605, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_606, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_607 &lt; 0) __pyx_t_607 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_608 &lt; 0) __pyx_t_608 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_607, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_608, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;630: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+631:                     pd[ip[j,0], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_609 = __pyx_v_j;
        __pyx_t_610 = 0;
        if (__pyx_t_609 &lt; 0) __pyx_t_609 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_610 &lt; 0) __pyx_t_610 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_611 = __pyx_v_j;
        __pyx_t_612 = 0;
        if (__pyx_t_611 &lt; 0) __pyx_t_611 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_612 &lt; 0) __pyx_t_612 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_613 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_609, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_610, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_614 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_611, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_612, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_613 &lt; 0) __pyx_t_613 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_614 &lt; 0) __pyx_t_614 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_613, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_614, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+632:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_615 = __pyx_v_j;
        __pyx_t_616 = 1;
        if (__pyx_t_615 &lt; 0) __pyx_t_615 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_616 &lt; 0) __pyx_t_616 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_615, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_616, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+633:                         pd[ip[j,1], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_617 = __pyx_v_j;
          __pyx_t_618 = 1;
          if (__pyx_t_617 &lt; 0) __pyx_t_617 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_618 &lt; 0) __pyx_t_618 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_619 = __pyx_v_j;
          __pyx_t_620 = 0;
          if (__pyx_t_619 &lt; 0) __pyx_t_619 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_620 &lt; 0) __pyx_t_620 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_621 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_617, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_618, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_622 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_619, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_620, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_621 &lt; 0) __pyx_t_621 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_622 &lt; 0) __pyx_t_622 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_621, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_622, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+634:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_623 = __pyx_v_j;
          __pyx_t_624 = 2;
          if (__pyx_t_623 &lt; 0) __pyx_t_623 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_624 &lt; 0) __pyx_t_624 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_623, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_624, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+635:                             pd[ip[j,2], ir[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_625 = __pyx_v_j;
            __pyx_t_626 = 2;
            if (__pyx_t_625 &lt; 0) __pyx_t_625 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_626 &lt; 0) __pyx_t_626 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_627 = __pyx_v_j;
            __pyx_t_628 = 0;
            if (__pyx_t_627 &lt; 0) __pyx_t_627 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_628 &lt; 0) __pyx_t_628 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_629 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_625, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_626, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_630 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_627, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_628, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_629 &lt; 0) __pyx_t_629 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_630 &lt; 0) __pyx_t_630 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_629, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_630, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L81;
          }
          __pyx_L81:;
          goto __pyx_L80;
        }
        __pyx_L80:;
</pre><pre class='cython line score-0'>&#xA0;636: </pre>
<pre class='cython line score-0'>&#xA0;637:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+638:                     deriv = k * C[ir[j,0]] * C[ir[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_631 = __pyx_v_j;
        __pyx_t_632 = 0;
        if (__pyx_t_631 &lt; 0) __pyx_t_631 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_632 &lt; 0) __pyx_t_632 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_633 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_631, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_632, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_633 &lt; 0) __pyx_t_633 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_634 = __pyx_v_j;
        __pyx_t_635 = 2;
        if (__pyx_t_634 &lt; 0) __pyx_t_634 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_635 &lt; 0) __pyx_t_635 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_636 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_634, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_635, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_636 &lt; 0) __pyx_t_636 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_633, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_636, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+639:                     pd[ir[j,0], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_637 = __pyx_v_j;
        __pyx_t_638 = 0;
        if (__pyx_t_637 &lt; 0) __pyx_t_637 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_638 &lt; 0) __pyx_t_638 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_639 = __pyx_v_j;
        __pyx_t_640 = 1;
        if (__pyx_t_639 &lt; 0) __pyx_t_639 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_640 &lt; 0) __pyx_t_640 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_641 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_637, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_638, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_642 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_639, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_640, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_641 &lt; 0) __pyx_t_641 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_642 &lt; 0) __pyx_t_642 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_641, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_642, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+640:                     pd[ir[j,1], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_643 = __pyx_v_j;
        __pyx_t_644 = 1;
        if (__pyx_t_643 &lt; 0) __pyx_t_643 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_644 &lt; 0) __pyx_t_644 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_645 = __pyx_v_j;
        __pyx_t_646 = 1;
        if (__pyx_t_645 &lt; 0) __pyx_t_645 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_646 &lt; 0) __pyx_t_646 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_647 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_643, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_644, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_648 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_645, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_646, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_647 &lt; 0) __pyx_t_647 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_648 &lt; 0) __pyx_t_648 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_647, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_648, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+641:                     pd[ir[j,2], ir[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_649 = __pyx_v_j;
        __pyx_t_650 = 2;
        if (__pyx_t_649 &lt; 0) __pyx_t_649 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_650 &lt; 0) __pyx_t_650 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_651 = __pyx_v_j;
        __pyx_t_652 = 1;
        if (__pyx_t_651 &lt; 0) __pyx_t_651 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_652 &lt; 0) __pyx_t_652 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_653 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_649, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_650, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_654 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_651, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_652, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_653 &lt; 0) __pyx_t_653 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_654 &lt; 0) __pyx_t_654 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_653, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_654, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;642: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+643:                     pd[ip[j,0], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_655 = __pyx_v_j;
        __pyx_t_656 = 0;
        if (__pyx_t_655 &lt; 0) __pyx_t_655 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_656 &lt; 0) __pyx_t_656 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_657 = __pyx_v_j;
        __pyx_t_658 = 1;
        if (__pyx_t_657 &lt; 0) __pyx_t_657 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_658 &lt; 0) __pyx_t_658 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_659 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_655, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_656, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_660 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_657, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_658, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_659 &lt; 0) __pyx_t_659 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_660 &lt; 0) __pyx_t_660 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_659, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_660, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+644:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_661 = __pyx_v_j;
        __pyx_t_662 = 1;
        if (__pyx_t_661 &lt; 0) __pyx_t_661 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_662 &lt; 0) __pyx_t_662 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_661, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_662, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+645:                         pd[ip[j,1], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_663 = __pyx_v_j;
          __pyx_t_664 = 1;
          if (__pyx_t_663 &lt; 0) __pyx_t_663 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_664 &lt; 0) __pyx_t_664 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_665 = __pyx_v_j;
          __pyx_t_666 = 1;
          if (__pyx_t_665 &lt; 0) __pyx_t_665 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_666 &lt; 0) __pyx_t_666 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_667 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_663, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_664, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_668 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_665, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_666, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_667 &lt; 0) __pyx_t_667 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_668 &lt; 0) __pyx_t_668 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_667, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_668, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+646:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_669 = __pyx_v_j;
          __pyx_t_670 = 2;
          if (__pyx_t_669 &lt; 0) __pyx_t_669 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_670 &lt; 0) __pyx_t_670 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_669, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_670, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+647:                             pd[ip[j,2], ir[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_671 = __pyx_v_j;
            __pyx_t_672 = 2;
            if (__pyx_t_671 &lt; 0) __pyx_t_671 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_672 &lt; 0) __pyx_t_672 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_673 = __pyx_v_j;
            __pyx_t_674 = 1;
            if (__pyx_t_673 &lt; 0) __pyx_t_673 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_674 &lt; 0) __pyx_t_674 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_675 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_671, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_672, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_676 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_673, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_674, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_675 &lt; 0) __pyx_t_675 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_676 &lt; 0) __pyx_t_676 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_675, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_676, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L83;
          }
          __pyx_L83:;
          goto __pyx_L82;
        }
        __pyx_L82:;
</pre><pre class='cython line score-0'>&#xA0;648: </pre>
<pre class='cython line score-0'>&#xA0;649:                     # derivative with respect to reactant 3</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+650:                     deriv = k * C[ir[j,0]] * C[ir[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_677 = __pyx_v_j;
        __pyx_t_678 = 0;
        if (__pyx_t_677 &lt; 0) __pyx_t_677 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_678 &lt; 0) __pyx_t_678 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_679 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_677, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_678, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_679 &lt; 0) __pyx_t_679 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_680 = __pyx_v_j;
        __pyx_t_681 = 1;
        if (__pyx_t_680 &lt; 0) __pyx_t_680 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_681 &lt; 0) __pyx_t_681 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_682 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_680, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_681, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_682 &lt; 0) __pyx_t_682 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_679, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_682, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+651:                     pd[ir[j,0], ir[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_683 = __pyx_v_j;
        __pyx_t_684 = 0;
        if (__pyx_t_683 &lt; 0) __pyx_t_683 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_684 &lt; 0) __pyx_t_684 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_685 = __pyx_v_j;
        __pyx_t_686 = 2;
        if (__pyx_t_685 &lt; 0) __pyx_t_685 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_686 &lt; 0) __pyx_t_686 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_687 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_683, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_684, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_688 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_685, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_686, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_687 &lt; 0) __pyx_t_687 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_688 &lt; 0) __pyx_t_688 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_687, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_688, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+652:                     pd[ir[j,1], ir[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_689 = __pyx_v_j;
        __pyx_t_690 = 1;
        if (__pyx_t_689 &lt; 0) __pyx_t_689 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_690 &lt; 0) __pyx_t_690 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_691 = __pyx_v_j;
        __pyx_t_692 = 2;
        if (__pyx_t_691 &lt; 0) __pyx_t_691 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_692 &lt; 0) __pyx_t_692 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_693 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_689, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_690, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_694 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_691, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_692, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_693 &lt; 0) __pyx_t_693 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_694 &lt; 0) __pyx_t_694 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_693, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_694, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+653:                     pd[ir[j,2], ir[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_695 = __pyx_v_j;
        __pyx_t_696 = 2;
        if (__pyx_t_695 &lt; 0) __pyx_t_695 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_696 &lt; 0) __pyx_t_696 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_697 = __pyx_v_j;
        __pyx_t_698 = 2;
        if (__pyx_t_697 &lt; 0) __pyx_t_697 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_698 &lt; 0) __pyx_t_698 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_699 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_695, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_696, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_700 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_697, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_698, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_699 &lt; 0) __pyx_t_699 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_700 &lt; 0) __pyx_t_700 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_699, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_700, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+654:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_701 = __pyx_v_numCoreSpecies;
        for (__pyx_t_702 = 0; __pyx_t_702 &lt; __pyx_t_701; __pyx_t_702+=1) {
          __pyx_v_i = __pyx_t_702;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+655:                         pd[ir[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_703 = __pyx_v_j;
          __pyx_t_704 = 0;
          if (__pyx_t_703 &lt; 0) __pyx_t_703 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_704 &lt; 0) __pyx_t_704 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_705 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_703, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_704, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_706 = __pyx_v_i;
          if (__pyx_t_705 &lt; 0) __pyx_t_705 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_706 &lt; 0) __pyx_t_706 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_705, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_706, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+656:                         pd[ir[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_707 = __pyx_v_j;
          __pyx_t_708 = 1;
          if (__pyx_t_707 &lt; 0) __pyx_t_707 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_708 &lt; 0) __pyx_t_708 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_709 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_707, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_708, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_710 = __pyx_v_i;
          if (__pyx_t_709 &lt; 0) __pyx_t_709 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_710 &lt; 0) __pyx_t_710 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_709, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_710, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+657:                         pd[ir[j,2], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_711 = __pyx_v_j;
          __pyx_t_712 = 2;
          if (__pyx_t_711 &lt; 0) __pyx_t_711 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_712 &lt; 0) __pyx_t_712 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_713 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_711, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_712, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_714 = __pyx_v_i;
          if (__pyx_t_713 &lt; 0) __pyx_t_713 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_714 &lt; 0) __pyx_t_714 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_713, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_714, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;658: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+659:                     pd[ip[j,0], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_701 = __pyx_v_j;
        __pyx_t_715 = 0;
        if (__pyx_t_701 &lt; 0) __pyx_t_701 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_715 &lt; 0) __pyx_t_715 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_702 = __pyx_v_j;
        __pyx_t_716 = 2;
        if (__pyx_t_702 &lt; 0) __pyx_t_702 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_716 &lt; 0) __pyx_t_716 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_717 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_701, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_715, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_718 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_702, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_716, __pyx_pybuffernd_ir.diminfo[1].strides));
        if (__pyx_t_717 &lt; 0) __pyx_t_717 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_718 &lt; 0) __pyx_t_718 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_717, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_718, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+660:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_719 = __pyx_v_numCoreSpecies;
        for (__pyx_t_720 = 0; __pyx_t_720 &lt; __pyx_t_719; __pyx_t_720+=1) {
          __pyx_v_i = __pyx_t_720;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+661:                         pd[ip[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_721 = __pyx_v_j;
          __pyx_t_722 = 0;
          if (__pyx_t_721 &lt; 0) __pyx_t_721 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_722 &lt; 0) __pyx_t_722 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_723 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_721, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_722, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_724 = __pyx_v_i;
          if (__pyx_t_723 &lt; 0) __pyx_t_723 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_724 &lt; 0) __pyx_t_724 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_723, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_724, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+662:                     if ip[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_719 = __pyx_v_j;
        __pyx_t_725 = 1;
        if (__pyx_t_719 &lt; 0) __pyx_t_719 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_725 &lt; 0) __pyx_t_725 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_719, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_725, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+663:                         pd[ip[j,1], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_720 = __pyx_v_j;
          __pyx_t_726 = 1;
          if (__pyx_t_720 &lt; 0) __pyx_t_720 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_726 &lt; 0) __pyx_t_726 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_727 = __pyx_v_j;
          __pyx_t_728 = 2;
          if (__pyx_t_727 &lt; 0) __pyx_t_727 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_728 &lt; 0) __pyx_t_728 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_729 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_720, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_726, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_730 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_727, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_728, __pyx_pybuffernd_ir.diminfo[1].strides));
          if (__pyx_t_729 &lt; 0) __pyx_t_729 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_730 &lt; 0) __pyx_t_730 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_729, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_730, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+664:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_731 = __pyx_v_numCoreSpecies;
          for (__pyx_t_732 = 0; __pyx_t_732 &lt; __pyx_t_731; __pyx_t_732+=1) {
            __pyx_v_i = __pyx_t_732;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+665:                             pd[ip[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_733 = __pyx_v_j;
            __pyx_t_734 = 1;
            if (__pyx_t_733 &lt; 0) __pyx_t_733 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_734 &lt; 0) __pyx_t_734 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_735 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_733, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_734, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_736 = __pyx_v_i;
            if (__pyx_t_735 &lt; 0) __pyx_t_735 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_736 &lt; 0) __pyx_t_736 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_735, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_736, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+666:                         if ip[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_731 = __pyx_v_j;
          __pyx_t_737 = 2;
          if (__pyx_t_731 &lt; 0) __pyx_t_731 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_737 &lt; 0) __pyx_t_737 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_731, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_737, __pyx_pybuffernd_ip.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+667:                             pd[ip[j,2], ir[j,2]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_732 = __pyx_v_j;
            __pyx_t_738 = 2;
            if (__pyx_t_732 &lt; 0) __pyx_t_732 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_738 &lt; 0) __pyx_t_738 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_739 = __pyx_v_j;
            __pyx_t_740 = 2;
            if (__pyx_t_739 &lt; 0) __pyx_t_739 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_740 &lt; 0) __pyx_t_740 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_741 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_732, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_738, __pyx_pybuffernd_ip.diminfo[1].strides));
            __pyx_t_742 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_739, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_740, __pyx_pybuffernd_ir.diminfo[1].strides));
            if (__pyx_t_741 &lt; 0) __pyx_t_741 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_742 &lt; 0) __pyx_t_742 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_741, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_742, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+668:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_743 = __pyx_v_numCoreSpecies;
            for (__pyx_t_744 = 0; __pyx_t_744 &lt; __pyx_t_743; __pyx_t_744+=1) {
              __pyx_v_i = __pyx_t_744;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+669:                                 pd[ip[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_745 = __pyx_v_j;
              __pyx_t_746 = 2;
              if (__pyx_t_745 &lt; 0) __pyx_t_745 += __pyx_pybuffernd_ip.diminfo[0].shape;
              if (__pyx_t_746 &lt; 0) __pyx_t_746 += __pyx_pybuffernd_ip.diminfo[1].shape;
              __pyx_t_747 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_745, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_746, __pyx_pybuffernd_ip.diminfo[1].strides));
              __pyx_t_748 = __pyx_v_i;
              if (__pyx_t_747 &lt; 0) __pyx_t_747 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_748 &lt; 0) __pyx_t_748 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_747, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_748, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L91;
          }
          __pyx_L91:;
          goto __pyx_L88;
        }
        __pyx_L88:;
      }
      __pyx_L33:;
    }
    __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;670: </pre>
<pre class='cython line score-0'>&#xA0;671: </pre>
<pre class='cython line score-0'>&#xA0;672: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+673:             k = kr[j]</pre>
<pre class='cython code score-0'>    __pyx_t_743 = __pyx_v_j;
    if (__pyx_t_743 &lt; 0) __pyx_t_743 += __pyx_pybuffernd_kr.diminfo[0].shape;
    __pyx_v_k = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_743, __pyx_pybuffernd_kr.diminfo[0].strides));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+674:             if ip[j,1] == -1: # only one reactant</pre>
<pre class='cython code score-0'>    __pyx_t_744 = __pyx_v_j;
    __pyx_t_749 = 1;
    if (__pyx_t_744 &lt; 0) __pyx_t_744 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_749 &lt; 0) __pyx_t_749 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_744, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_749, __pyx_pybuffernd_ip.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+675:                 deriv = k</pre>
<pre class='cython code score-0'>      __pyx_v_deriv = __pyx_v_k;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+676:                 pd[ip[j,0], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>      __pyx_t_750 = __pyx_v_j;
      __pyx_t_751 = 0;
      if (__pyx_t_750 &lt; 0) __pyx_t_750 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_751 &lt; 0) __pyx_t_751 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_752 = __pyx_v_j;
      __pyx_t_753 = 0;
      if (__pyx_t_752 &lt; 0) __pyx_t_752 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_753 &lt; 0) __pyx_t_753 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_754 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_750, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_751, __pyx_pybuffernd_ip.diminfo[1].strides));
      __pyx_t_755 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_752, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_753, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_754 &lt; 0) __pyx_t_754 += __pyx_pybuffernd_pd.diminfo[0].shape;
      if (__pyx_t_755 &lt; 0) __pyx_t_755 += __pyx_pybuffernd_pd.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_754, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_755, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;677: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+678:                 pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>      __pyx_t_756 = __pyx_v_j;
      __pyx_t_757 = 0;
      if (__pyx_t_756 &lt; 0) __pyx_t_756 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_757 &lt; 0) __pyx_t_757 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_758 = __pyx_v_j;
      __pyx_t_759 = 0;
      if (__pyx_t_758 &lt; 0) __pyx_t_758 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_759 &lt; 0) __pyx_t_759 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_760 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_756, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_757, __pyx_pybuffernd_ir.diminfo[1].strides));
      __pyx_t_761 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_758, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_759, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_760 &lt; 0) __pyx_t_760 += __pyx_pybuffernd_pd.diminfo[0].shape;
      if (__pyx_t_761 &lt; 0) __pyx_t_761 += __pyx_pybuffernd_pd.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_760, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_761, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+679:                 if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>      __pyx_t_762 = __pyx_v_j;
      __pyx_t_763 = 1;
      if (__pyx_t_762 &lt; 0) __pyx_t_762 += __pyx_pybuffernd_ir.diminfo[0].shape;
      if (__pyx_t_763 &lt; 0) __pyx_t_763 += __pyx_pybuffernd_ir.diminfo[1].shape;
      __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_762, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_763, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+680:                     pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_764 = __pyx_v_j;
        __pyx_t_765 = 1;
        if (__pyx_t_764 &lt; 0) __pyx_t_764 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_765 &lt; 0) __pyx_t_765 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_766 = __pyx_v_j;
        __pyx_t_767 = 0;
        if (__pyx_t_766 &lt; 0) __pyx_t_766 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_767 &lt; 0) __pyx_t_767 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_768 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_764, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_765, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_769 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_766, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_767, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_768 &lt; 0) __pyx_t_768 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_769 &lt; 0) __pyx_t_769 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_768, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_769, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+681:                     if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_770 = __pyx_v_j;
        __pyx_t_771 = 2;
        if (__pyx_t_770 &lt; 0) __pyx_t_770 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_771 &lt; 0) __pyx_t_771 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_770, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_771, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+682:                         pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_772 = __pyx_v_j;
          __pyx_t_773 = 2;
          if (__pyx_t_772 &lt; 0) __pyx_t_772 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_773 &lt; 0) __pyx_t_773 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_774 = __pyx_v_j;
          __pyx_t_775 = 0;
          if (__pyx_t_774 &lt; 0) __pyx_t_774 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_775 &lt; 0) __pyx_t_775 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_776 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_772, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_773, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_777 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_774, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_775, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_776 &lt; 0) __pyx_t_776 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_777 &lt; 0) __pyx_t_777 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_776, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_777, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
          goto __pyx_L96;
        }
        __pyx_L96:;
        goto __pyx_L95;
      }
      __pyx_L95:;
      goto __pyx_L94;
    }
</pre><pre class='cython line score-0'>&#xA0;683: </pre>
<pre class='cython line score-0'>&#xA0;684: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+685:             elif ip[j,2] == -1: # only two reactants</pre>
<pre class='cython code score-0'>    __pyx_t_778 = __pyx_v_j;
    __pyx_t_779 = 2;
    if (__pyx_t_778 &lt; 0) __pyx_t_778 += __pyx_pybuffernd_ip.diminfo[0].shape;
    if (__pyx_t_779 &lt; 0) __pyx_t_779 += __pyx_pybuffernd_ip.diminfo[1].shape;
    __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_778, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_779, __pyx_pybuffernd_ip.diminfo[1].strides)) == -1) != 0);
    if (__pyx_t_223) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+686:                 corr = -k * C[ip[j,0]] * C[ip[j,1]] / Ctot</pre>
<pre class='cython code score-5'>      __pyx_t_780 = __pyx_v_j;
      __pyx_t_781 = 0;
      if (__pyx_t_780 &lt; 0) __pyx_t_780 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_781 &lt; 0) __pyx_t_781 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_782 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_780, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_781, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_782 &lt; 0) __pyx_t_782 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_783 = __pyx_v_j;
      __pyx_t_784 = 1;
      if (__pyx_t_783 &lt; 0) __pyx_t_783 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_784 &lt; 0) __pyx_t_784 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_785 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_783, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_784, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_785 &lt; 0) __pyx_t_785 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_18 = (((-__pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_782, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_785, __pyx_pybuffernd_C.diminfo[0].strides)));
      if (unlikely(__pyx_v_Ctot == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_corr = (__pyx_t_18 / __pyx_v_Ctot);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+687:                 if ip[j,0] == ip[j,1]:</pre>
<pre class='cython code score-0'>      __pyx_t_786 = __pyx_v_j;
      __pyx_t_787 = 0;
      if (__pyx_t_786 &lt; 0) __pyx_t_786 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_787 &lt; 0) __pyx_t_787 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_788 = __pyx_v_j;
      __pyx_t_789 = 1;
      if (__pyx_t_788 &lt; 0) __pyx_t_788 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_789 &lt; 0) __pyx_t_789 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_786, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_787, __pyx_pybuffernd_ip.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_788, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_789, __pyx_pybuffernd_ip.diminfo[1].strides))) != 0);
      if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+688:                     deriv = 2 * k * C[ip[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_790 = __pyx_v_j;
        __pyx_t_791 = 0;
        if (__pyx_t_790 &lt; 0) __pyx_t_790 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_791 &lt; 0) __pyx_t_791 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_792 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_790, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_791, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_792 &lt; 0) __pyx_t_792 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_792, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+689:                     pd[ip[j,0], ip[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_793 = __pyx_v_j;
        __pyx_t_794 = 0;
        if (__pyx_t_793 &lt; 0) __pyx_t_793 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_794 &lt; 0) __pyx_t_794 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_795 = __pyx_v_j;
        __pyx_t_796 = 0;
        if (__pyx_t_795 &lt; 0) __pyx_t_795 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_796 &lt; 0) __pyx_t_796 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_797 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_793, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_794, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_798 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_795, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_796, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_797 &lt; 0) __pyx_t_797 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_798 &lt; 0) __pyx_t_798 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_797, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_798, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+690:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_799 = __pyx_v_numCoreSpecies;
        for (__pyx_t_800 = 0; __pyx_t_800 &lt; __pyx_t_799; __pyx_t_800+=1) {
          __pyx_v_i = __pyx_t_800;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+691:                         pd[ip[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_801 = __pyx_v_j;
          __pyx_t_802 = 0;
          if (__pyx_t_801 &lt; 0) __pyx_t_801 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_802 &lt; 0) __pyx_t_802 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_803 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_801, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_802, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_804 = __pyx_v_i;
          if (__pyx_t_803 &lt; 0) __pyx_t_803 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_804 &lt; 0) __pyx_t_804 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_803, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_804, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;692: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+693:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_799 = __pyx_v_j;
        __pyx_t_805 = 0;
        if (__pyx_t_799 &lt; 0) __pyx_t_799 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_805 &lt; 0) __pyx_t_805 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_800 = __pyx_v_j;
        __pyx_t_806 = 0;
        if (__pyx_t_800 &lt; 0) __pyx_t_800 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_806 &lt; 0) __pyx_t_806 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_807 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_799, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_805, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_808 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_800, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_806, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_807 &lt; 0) __pyx_t_807 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_808 &lt; 0) __pyx_t_808 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_807, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_808, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+694:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_809 = __pyx_v_numCoreSpecies;
        for (__pyx_t_810 = 0; __pyx_t_810 &lt; __pyx_t_809; __pyx_t_810+=1) {
          __pyx_v_i = __pyx_t_810;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+695:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_811 = __pyx_v_j;
          __pyx_t_812 = 0;
          if (__pyx_t_811 &lt; 0) __pyx_t_811 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_812 &lt; 0) __pyx_t_812 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_813 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_811, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_812, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_814 = __pyx_v_i;
          if (__pyx_t_813 &lt; 0) __pyx_t_813 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_814 &lt; 0) __pyx_t_814 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_813, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_814, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+696:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_809 = __pyx_v_j;
        __pyx_t_815 = 1;
        if (__pyx_t_809 &lt; 0) __pyx_t_809 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_815 &lt; 0) __pyx_t_815 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_809, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_815, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+697:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_810 = __pyx_v_j;
          __pyx_t_816 = 1;
          if (__pyx_t_810 &lt; 0) __pyx_t_810 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_816 &lt; 0) __pyx_t_816 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_817 = __pyx_v_j;
          __pyx_t_818 = 0;
          if (__pyx_t_817 &lt; 0) __pyx_t_817 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_818 &lt; 0) __pyx_t_818 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_819 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_810, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_816, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_820 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_817, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_818, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_819 &lt; 0) __pyx_t_819 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_820 &lt; 0) __pyx_t_820 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_819, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_820, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+698:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_821 = __pyx_v_numCoreSpecies;
          for (__pyx_t_822 = 0; __pyx_t_822 &lt; __pyx_t_821; __pyx_t_822+=1) {
            __pyx_v_i = __pyx_t_822;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+699:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_823 = __pyx_v_j;
            __pyx_t_824 = 1;
            if (__pyx_t_823 &lt; 0) __pyx_t_823 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_824 &lt; 0) __pyx_t_824 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_825 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_823, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_824, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_826 = __pyx_v_i;
            if (__pyx_t_825 &lt; 0) __pyx_t_825 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_826 &lt; 0) __pyx_t_826 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_825, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_826, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+700:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_821 = __pyx_v_j;
          __pyx_t_827 = 2;
          if (__pyx_t_821 &lt; 0) __pyx_t_821 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_827 &lt; 0) __pyx_t_827 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_821, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_827, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+701:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_822 = __pyx_v_j;
            __pyx_t_828 = 2;
            if (__pyx_t_822 &lt; 0) __pyx_t_822 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_828 &lt; 0) __pyx_t_828 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_829 = __pyx_v_j;
            __pyx_t_830 = 0;
            if (__pyx_t_829 &lt; 0) __pyx_t_829 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_830 &lt; 0) __pyx_t_830 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_831 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_822, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_828, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_832 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_829, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_830, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_831 &lt; 0) __pyx_t_831 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_832 &lt; 0) __pyx_t_832 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_831, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_832, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+702:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_833 = __pyx_v_numCoreSpecies;
            for (__pyx_t_834 = 0; __pyx_t_834 &lt; __pyx_t_833; __pyx_t_834+=1) {
              __pyx_v_i = __pyx_t_834;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+703:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_835 = __pyx_v_j;
              __pyx_t_836 = 2;
              if (__pyx_t_835 &lt; 0) __pyx_t_835 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_836 &lt; 0) __pyx_t_836 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_837 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_835, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_836, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_838 = __pyx_v_i;
              if (__pyx_t_837 &lt; 0) __pyx_t_837 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_838 &lt; 0) __pyx_t_838 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_837, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_838, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L105;
          }
          __pyx_L105:;
          goto __pyx_L102;
        }
        __pyx_L102:;
        goto __pyx_L97;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;704: </pre>
<pre class='cython line score-0'>&#xA0;705:                 else:</pre>
<pre class='cython line score-0'>&#xA0;706:                     # Derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+707:                     deriv = k * C[ip[j, 1]]</pre>
<pre class='cython code score-0'>        __pyx_t_833 = __pyx_v_j;
        __pyx_t_839 = 1;
        if (__pyx_t_833 &lt; 0) __pyx_t_833 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_839 &lt; 0) __pyx_t_839 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_840 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_833, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_839, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_840 &lt; 0) __pyx_t_840 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_840, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+708:                     pd[ip[j,0], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_834 = __pyx_v_j;
        __pyx_t_841 = 0;
        if (__pyx_t_834 &lt; 0) __pyx_t_834 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_841 &lt; 0) __pyx_t_841 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_842 = __pyx_v_j;
        __pyx_t_843 = 0;
        if (__pyx_t_842 &lt; 0) __pyx_t_842 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_843 &lt; 0) __pyx_t_843 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_844 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_834, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_841, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_845 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_842, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_843, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_844 &lt; 0) __pyx_t_844 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_845 &lt; 0) __pyx_t_845 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_844, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_845, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+709:                     pd[ip[j,1], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_846 = __pyx_v_j;
        __pyx_t_847 = 1;
        if (__pyx_t_846 &lt; 0) __pyx_t_846 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_847 &lt; 0) __pyx_t_847 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_848 = __pyx_v_j;
        __pyx_t_849 = 0;
        if (__pyx_t_848 &lt; 0) __pyx_t_848 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_849 &lt; 0) __pyx_t_849 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_850 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_846, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_847, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_851 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_848, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_849, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_850 &lt; 0) __pyx_t_850 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_851 &lt; 0) __pyx_t_851 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_850, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_851, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;710: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+711:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_852 = __pyx_v_j;
        __pyx_t_853 = 0;
        if (__pyx_t_852 &lt; 0) __pyx_t_852 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_853 &lt; 0) __pyx_t_853 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_854 = __pyx_v_j;
        __pyx_t_855 = 0;
        if (__pyx_t_854 &lt; 0) __pyx_t_854 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_855 &lt; 0) __pyx_t_855 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_856 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_852, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_853, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_857 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_854, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_855, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_856 &lt; 0) __pyx_t_856 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_857 &lt; 0) __pyx_t_857 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_856, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_857, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+712:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_858 = __pyx_v_j;
        __pyx_t_859 = 1;
        if (__pyx_t_858 &lt; 0) __pyx_t_858 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_859 &lt; 0) __pyx_t_859 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_858, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_859, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+713:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_860 = __pyx_v_j;
          __pyx_t_861 = 1;
          if (__pyx_t_860 &lt; 0) __pyx_t_860 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_861 &lt; 0) __pyx_t_861 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_862 = __pyx_v_j;
          __pyx_t_863 = 0;
          if (__pyx_t_862 &lt; 0) __pyx_t_862 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_863 &lt; 0) __pyx_t_863 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_864 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_860, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_861, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_865 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_862, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_863, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_864 &lt; 0) __pyx_t_864 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_865 &lt; 0) __pyx_t_865 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_864, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_865, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+714:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_866 = __pyx_v_j;
          __pyx_t_867 = 2;
          if (__pyx_t_866 &lt; 0) __pyx_t_866 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_867 &lt; 0) __pyx_t_867 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_866, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_867, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+715:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_868 = __pyx_v_j;
            __pyx_t_869 = 2;
            if (__pyx_t_868 &lt; 0) __pyx_t_868 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_869 &lt; 0) __pyx_t_869 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_870 = __pyx_v_j;
            __pyx_t_871 = 0;
            if (__pyx_t_870 &lt; 0) __pyx_t_870 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_871 &lt; 0) __pyx_t_871 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_872 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_868, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_869, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_873 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_870, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_871, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_872 &lt; 0) __pyx_t_872 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_873 &lt; 0) __pyx_t_873 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_872, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_873, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L109;
          }
          __pyx_L109:;
          goto __pyx_L108;
        }
        __pyx_L108:;
</pre><pre class='cython line score-0'>&#xA0;716: </pre>
<pre class='cython line score-0'>&#xA0;717:                     # Derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+718:                     deriv = k * C[ip[j, 0]]</pre>
<pre class='cython code score-0'>        __pyx_t_874 = __pyx_v_j;
        __pyx_t_875 = 0;
        if (__pyx_t_874 &lt; 0) __pyx_t_874 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_875 &lt; 0) __pyx_t_875 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_876 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_874, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_875, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_876 &lt; 0) __pyx_t_876 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_876, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+719:                     pd[ip[j,0], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_877 = __pyx_v_j;
        __pyx_t_878 = 0;
        if (__pyx_t_877 &lt; 0) __pyx_t_877 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_878 &lt; 0) __pyx_t_878 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_879 = __pyx_v_j;
        __pyx_t_880 = 1;
        if (__pyx_t_879 &lt; 0) __pyx_t_879 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_880 &lt; 0) __pyx_t_880 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_881 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_877, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_878, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_882 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_879, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_880, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_881 &lt; 0) __pyx_t_881 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_882 &lt; 0) __pyx_t_882 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_881, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_882, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+720:                     pd[ip[j,1], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_883 = __pyx_v_j;
        __pyx_t_884 = 1;
        if (__pyx_t_883 &lt; 0) __pyx_t_883 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_884 &lt; 0) __pyx_t_884 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_885 = __pyx_v_j;
        __pyx_t_886 = 1;
        if (__pyx_t_885 &lt; 0) __pyx_t_885 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_886 &lt; 0) __pyx_t_886 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_887 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_883, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_884, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_888 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_885, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_886, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_887 &lt; 0) __pyx_t_887 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_888 &lt; 0) __pyx_t_888 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_887, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_888, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+721:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_889 = __pyx_v_numCoreSpecies;
        for (__pyx_t_890 = 0; __pyx_t_890 &lt; __pyx_t_889; __pyx_t_890+=1) {
          __pyx_v_i = __pyx_t_890;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+722:                         pd[ip[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_891 = __pyx_v_j;
          __pyx_t_892 = 0;
          if (__pyx_t_891 &lt; 0) __pyx_t_891 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_892 &lt; 0) __pyx_t_892 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_893 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_891, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_892, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_894 = __pyx_v_i;
          if (__pyx_t_893 &lt; 0) __pyx_t_893 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_894 &lt; 0) __pyx_t_894 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_893, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_894, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+723:                         pd[ip[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_895 = __pyx_v_j;
          __pyx_t_896 = 1;
          if (__pyx_t_895 &lt; 0) __pyx_t_895 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_896 &lt; 0) __pyx_t_896 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_897 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_895, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_896, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_898 = __pyx_v_i;
          if (__pyx_t_897 &lt; 0) __pyx_t_897 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_898 &lt; 0) __pyx_t_898 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_897, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_898, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;724: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+725:                     pd[ir[j,0], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_889 = __pyx_v_j;
        __pyx_t_899 = 0;
        if (__pyx_t_889 &lt; 0) __pyx_t_889 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_899 &lt; 0) __pyx_t_899 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_890 = __pyx_v_j;
        __pyx_t_900 = 1;
        if (__pyx_t_890 &lt; 0) __pyx_t_890 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_900 &lt; 0) __pyx_t_900 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_901 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_889, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_899, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_902 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_890, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_900, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_901 &lt; 0) __pyx_t_901 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_902 &lt; 0) __pyx_t_902 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_901, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_902, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+726:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_903 = __pyx_v_numCoreSpecies;
        for (__pyx_t_904 = 0; __pyx_t_904 &lt; __pyx_t_903; __pyx_t_904+=1) {
          __pyx_v_i = __pyx_t_904;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+727:                          pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_905 = __pyx_v_j;
          __pyx_t_906 = 0;
          if (__pyx_t_905 &lt; 0) __pyx_t_905 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_906 &lt; 0) __pyx_t_906 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_907 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_905, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_906, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_908 = __pyx_v_i;
          if (__pyx_t_907 &lt; 0) __pyx_t_907 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_908 &lt; 0) __pyx_t_908 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_907, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_908, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+728:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_903 = __pyx_v_j;
        __pyx_t_909 = 1;
        if (__pyx_t_903 &lt; 0) __pyx_t_903 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_909 &lt; 0) __pyx_t_909 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_903, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_909, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+729:                         pd[ir[j,1], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_904 = __pyx_v_j;
          __pyx_t_910 = 1;
          if (__pyx_t_904 &lt; 0) __pyx_t_904 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_910 &lt; 0) __pyx_t_910 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_911 = __pyx_v_j;
          __pyx_t_912 = 1;
          if (__pyx_t_911 &lt; 0) __pyx_t_911 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_912 &lt; 0) __pyx_t_912 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_913 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_904, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_910, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_914 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_911, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_912, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_913 &lt; 0) __pyx_t_913 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_914 &lt; 0) __pyx_t_914 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_913, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_914, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+730:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_915 = __pyx_v_numCoreSpecies;
          for (__pyx_t_916 = 0; __pyx_t_916 &lt; __pyx_t_915; __pyx_t_916+=1) {
            __pyx_v_i = __pyx_t_916;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+731:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_917 = __pyx_v_j;
            __pyx_t_918 = 1;
            if (__pyx_t_917 &lt; 0) __pyx_t_917 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_918 &lt; 0) __pyx_t_918 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_919 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_917, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_918, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_920 = __pyx_v_i;
            if (__pyx_t_919 &lt; 0) __pyx_t_919 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_920 &lt; 0) __pyx_t_920 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_919, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_920, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+732:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_915 = __pyx_v_j;
          __pyx_t_921 = 2;
          if (__pyx_t_915 &lt; 0) __pyx_t_915 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_921 &lt; 0) __pyx_t_921 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_223 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_915, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_921, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_223) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+733:                             pd[ir[j,2], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_916 = __pyx_v_j;
            __pyx_t_922 = 2;
            if (__pyx_t_916 &lt; 0) __pyx_t_916 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_922 &lt; 0) __pyx_t_922 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_923 = __pyx_v_j;
            __pyx_t_924 = 1;
            if (__pyx_t_923 &lt; 0) __pyx_t_923 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_924 &lt; 0) __pyx_t_924 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_925 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_916, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_922, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_926 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_923, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_924, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_925 &lt; 0) __pyx_t_925 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_926 &lt; 0) __pyx_t_926 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_925, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_926, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+734:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_927 = __pyx_v_numCoreSpecies;
            for (__pyx_t_928 = 0; __pyx_t_928 &lt; __pyx_t_927; __pyx_t_928+=1) {
              __pyx_v_i = __pyx_t_928;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+735:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_929 = __pyx_v_j;
              __pyx_t_930 = 2;
              if (__pyx_t_929 &lt; 0) __pyx_t_929 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_930 &lt; 0) __pyx_t_930 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_931 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_929, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_930, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_932 = __pyx_v_i;
              if (__pyx_t_931 &lt; 0) __pyx_t_931 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_932 &lt; 0) __pyx_t_932 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_931, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_932, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L117;
          }
          __pyx_L117:;
          goto __pyx_L114;
        }
        __pyx_L114:;
      }
      __pyx_L97:;
      goto __pyx_L94;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;736: </pre>
<pre class='cython line score-0'>&#xA0;737: </pre>
<pre class='cython line score-0'>&#xA0;738:             else: # three reactants!! (really?)</pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+739:                 corr = - 2 * k * C[ip[j,0]] * C[ip[j,1]] * C[ip[j,2]] / Ctot</pre>
<pre class='cython code score-5'>      __pyx_t_927 = __pyx_v_j;
      __pyx_t_933 = 0;
      if (__pyx_t_927 &lt; 0) __pyx_t_927 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_933 &lt; 0) __pyx_t_933 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_934 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_927, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_933, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_934 &lt; 0) __pyx_t_934 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_928 = __pyx_v_j;
      __pyx_t_935 = 1;
      if (__pyx_t_928 &lt; 0) __pyx_t_928 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_935 &lt; 0) __pyx_t_935 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_936 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_928, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_935, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_936 &lt; 0) __pyx_t_936 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_937 = __pyx_v_j;
      __pyx_t_938 = 2;
      if (__pyx_t_937 &lt; 0) __pyx_t_937 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_938 &lt; 0) __pyx_t_938 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_939 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_937, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_938, __pyx_pybuffernd_ip.diminfo[1].strides));
      if (__pyx_t_939 &lt; 0) __pyx_t_939 += __pyx_pybuffernd_C.diminfo[0].shape;
      __pyx_t_18 = ((((-2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_934, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_936, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_939, __pyx_pybuffernd_C.diminfo[0].strides)));
      if (unlikely(__pyx_v_Ctot == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_corr = (__pyx_t_18 / __pyx_v_Ctot);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+740:                 if (ip[j,0] == ip[j,1] &amp; ip[j,0] == ip[j,2]):</pre>
<pre class='cython code score-0'>      __pyx_t_940 = __pyx_v_j;
      __pyx_t_941 = 0;
      if (__pyx_t_940 &lt; 0) __pyx_t_940 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_941 &lt; 0) __pyx_t_941 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_942 = __pyx_v_j;
      __pyx_t_943 = 1;
      if (__pyx_t_942 &lt; 0) __pyx_t_942 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_943 &lt; 0) __pyx_t_943 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_944 = __pyx_v_j;
      __pyx_t_945 = 0;
      if (__pyx_t_944 &lt; 0) __pyx_t_944 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_945 &lt; 0) __pyx_t_945 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_946 = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_942, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_943, __pyx_pybuffernd_ip.diminfo[1].strides)) &amp; (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_944, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_945, __pyx_pybuffernd_ip.diminfo[1].strides)));
      __pyx_t_223 = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_940, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_941, __pyx_pybuffernd_ip.diminfo[1].strides)) == __pyx_t_946);
      if (__pyx_t_223) {
        __pyx_t_947 = __pyx_v_j;
        __pyx_t_948 = 2;
        if (__pyx_t_947 &lt; 0) __pyx_t_947 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_948 &lt; 0) __pyx_t_948 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_223 = (__pyx_t_946 == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_947, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_948, __pyx_pybuffernd_ip.diminfo[1].strides)));
      }
      __pyx_t_23 = (__pyx_t_223 != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+741:                     deriv = 3 * k * C[ip[j,0]] * C[ip[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_949 = __pyx_v_j;
        __pyx_t_950 = 0;
        if (__pyx_t_949 &lt; 0) __pyx_t_949 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_950 &lt; 0) __pyx_t_950 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_946 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_949, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_950, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_946 &lt; 0) __pyx_t_946 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_951 = __pyx_v_j;
        __pyx_t_952 = 0;
        if (__pyx_t_951 &lt; 0) __pyx_t_951 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_952 &lt; 0) __pyx_t_952 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_953 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_951, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_952, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_953 &lt; 0) __pyx_t_953 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((3.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_946, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_953, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+742:                     pd[ip[j,0], ip[j,0]] -= 3 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_954 = __pyx_v_j;
        __pyx_t_955 = 0;
        if (__pyx_t_954 &lt; 0) __pyx_t_954 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_955 &lt; 0) __pyx_t_955 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_956 = __pyx_v_j;
        __pyx_t_957 = 0;
        if (__pyx_t_956 &lt; 0) __pyx_t_956 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_957 &lt; 0) __pyx_t_957 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_958 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_954, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_955, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_959 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_956, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_957, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_958 &lt; 0) __pyx_t_958 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_959 &lt; 0) __pyx_t_959 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_958, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_959, __pyx_pybuffernd_pd.diminfo[1].strides) -= (3.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+743:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_960 = __pyx_v_numCoreSpecies;
        for (__pyx_t_961 = 0; __pyx_t_961 &lt; __pyx_t_960; __pyx_t_961+=1) {
          __pyx_v_i = __pyx_t_961;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+744:                         pd[ip[j,0], i] -= 3 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_962 = __pyx_v_j;
          __pyx_t_963 = 0;
          if (__pyx_t_962 &lt; 0) __pyx_t_962 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_963 &lt; 0) __pyx_t_963 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_964 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_962, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_963, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_965 = __pyx_v_i;
          if (__pyx_t_964 &lt; 0) __pyx_t_964 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_965 &lt; 0) __pyx_t_965 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_964, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_965, __pyx_pybuffernd_pd.diminfo[1].strides) -= (3.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;745: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+746:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_960 = __pyx_v_j;
        __pyx_t_966 = 0;
        if (__pyx_t_960 &lt; 0) __pyx_t_960 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_966 &lt; 0) __pyx_t_966 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_961 = __pyx_v_j;
        __pyx_t_967 = 0;
        if (__pyx_t_961 &lt; 0) __pyx_t_961 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_967 &lt; 0) __pyx_t_967 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_968 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_960, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_966, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_969 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_961, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_967, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_968 &lt; 0) __pyx_t_968 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_969 &lt; 0) __pyx_t_969 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_968, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_969, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+747:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_970 = __pyx_v_numCoreSpecies;
        for (__pyx_t_971 = 0; __pyx_t_971 &lt; __pyx_t_970; __pyx_t_971+=1) {
          __pyx_v_i = __pyx_t_971;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+748:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_972 = __pyx_v_j;
          __pyx_t_973 = 0;
          if (__pyx_t_972 &lt; 0) __pyx_t_972 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_973 &lt; 0) __pyx_t_973 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_974 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_972, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_973, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_975 = __pyx_v_i;
          if (__pyx_t_974 &lt; 0) __pyx_t_974 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_975 &lt; 0) __pyx_t_975 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_974, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_975, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+749:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_970 = __pyx_v_j;
        __pyx_t_976 = 1;
        if (__pyx_t_970 &lt; 0) __pyx_t_970 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_976 &lt; 0) __pyx_t_976 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_970, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_976, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+750:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_971 = __pyx_v_j;
          __pyx_t_977 = 1;
          if (__pyx_t_971 &lt; 0) __pyx_t_971 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_977 &lt; 0) __pyx_t_977 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_978 = __pyx_v_j;
          __pyx_t_979 = 0;
          if (__pyx_t_978 &lt; 0) __pyx_t_978 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_979 &lt; 0) __pyx_t_979 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_980 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_971, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_977, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_981 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_978, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_979, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_980 &lt; 0) __pyx_t_980 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_981 &lt; 0) __pyx_t_981 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_980, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_981, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+751:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_982 = __pyx_v_numCoreSpecies;
          for (__pyx_t_983 = 0; __pyx_t_983 &lt; __pyx_t_982; __pyx_t_983+=1) {
            __pyx_v_i = __pyx_t_983;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+752:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_984 = __pyx_v_j;
            __pyx_t_985 = 1;
            if (__pyx_t_984 &lt; 0) __pyx_t_984 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_985 &lt; 0) __pyx_t_985 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_986 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_984, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_985, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_987 = __pyx_v_i;
            if (__pyx_t_986 &lt; 0) __pyx_t_986 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_987 &lt; 0) __pyx_t_987 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_986, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_987, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+753:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_982 = __pyx_v_j;
          __pyx_t_988 = 2;
          if (__pyx_t_982 &lt; 0) __pyx_t_982 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_988 &lt; 0) __pyx_t_988 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_982, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_988, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+754:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_983 = __pyx_v_j;
            __pyx_t_989 = 2;
            if (__pyx_t_983 &lt; 0) __pyx_t_983 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_989 &lt; 0) __pyx_t_989 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_990 = __pyx_v_j;
            __pyx_t_991 = 0;
            if (__pyx_t_990 &lt; 0) __pyx_t_990 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_991 &lt; 0) __pyx_t_991 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_992 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_983, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_989, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_993 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_990, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_991, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_992 &lt; 0) __pyx_t_992 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_993 &lt; 0) __pyx_t_993 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_992, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_993, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+755:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_994 = __pyx_v_numCoreSpecies;
            for (__pyx_t_995 = 0; __pyx_t_995 &lt; __pyx_t_994; __pyx_t_995+=1) {
              __pyx_v_i = __pyx_t_995;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+756:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_996 = __pyx_v_j;
              __pyx_t_997 = 2;
              if (__pyx_t_996 &lt; 0) __pyx_t_996 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_997 &lt; 0) __pyx_t_997 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_998 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_996, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_997, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_999 = __pyx_v_i;
              if (__pyx_t_998 &lt; 0) __pyx_t_998 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_999 &lt; 0) __pyx_t_999 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_998, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_999, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L128;
          }
          __pyx_L128:;
          goto __pyx_L125;
        }
        __pyx_L125:;
        goto __pyx_L120;
      }
</pre><pre class='cython line score-0'>&#xA0;757: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+758:                 elif ip[j,0] == ip[j,1]:</pre>
<pre class='cython code score-0'>      __pyx_t_994 = __pyx_v_j;
      __pyx_t_1000 = 0;
      if (__pyx_t_994 &lt; 0) __pyx_t_994 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1000 &lt; 0) __pyx_t_1000 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_995 = __pyx_v_j;
      __pyx_t_1001 = 1;
      if (__pyx_t_995 &lt; 0) __pyx_t_995 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1001 &lt; 0) __pyx_t_1001 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_994, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1000, __pyx_pybuffernd_ip.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_995, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1001, __pyx_pybuffernd_ip.diminfo[1].strides))) != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0'>&#xA0;759:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+760:                     deriv = 2 * k * C[ip[j,0]] * C[ip[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_1002 = __pyx_v_j;
        __pyx_t_1003 = 0;
        if (__pyx_t_1002 &lt; 0) __pyx_t_1002 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1003 &lt; 0) __pyx_t_1003 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1004 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1002, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1003, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1004 &lt; 0) __pyx_t_1004 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1005 = __pyx_v_j;
        __pyx_t_1006 = 2;
        if (__pyx_t_1005 &lt; 0) __pyx_t_1005 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1006 &lt; 0) __pyx_t_1006 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1007 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1005, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1006, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1007 &lt; 0) __pyx_t_1007 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1004, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1007, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+761:                     pd[ip[j,0], ip[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1008 = __pyx_v_j;
        __pyx_t_1009 = 0;
        if (__pyx_t_1008 &lt; 0) __pyx_t_1008 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1009 &lt; 0) __pyx_t_1009 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1010 = __pyx_v_j;
        __pyx_t_1011 = 0;
        if (__pyx_t_1010 &lt; 0) __pyx_t_1010 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1011 &lt; 0) __pyx_t_1011 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1012 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1008, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1009, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1013 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1010, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1011, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1012 &lt; 0) __pyx_t_1012 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1013 &lt; 0) __pyx_t_1013 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1012, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1013, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+762:                     pd[ip[j,2], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1014 = __pyx_v_j;
        __pyx_t_1015 = 2;
        if (__pyx_t_1014 &lt; 0) __pyx_t_1014 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1015 &lt; 0) __pyx_t_1015 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1016 = __pyx_v_j;
        __pyx_t_1017 = 0;
        if (__pyx_t_1016 &lt; 0) __pyx_t_1016 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1017 &lt; 0) __pyx_t_1017 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1018 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1014, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1015, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1019 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1016, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1017, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1018 &lt; 0) __pyx_t_1018 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1019 &lt; 0) __pyx_t_1019 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1018, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1019, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;763: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+764:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1020 = __pyx_v_j;
        __pyx_t_1021 = 0;
        if (__pyx_t_1020 &lt; 0) __pyx_t_1020 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1021 &lt; 0) __pyx_t_1021 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1022 = __pyx_v_j;
        __pyx_t_1023 = 0;
        if (__pyx_t_1022 &lt; 0) __pyx_t_1022 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1023 &lt; 0) __pyx_t_1023 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1024 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1020, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1021, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1025 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1022, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1023, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1024 &lt; 0) __pyx_t_1024 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1025 &lt; 0) __pyx_t_1025 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1024, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1025, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+765:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1026 = __pyx_v_j;
        __pyx_t_1027 = 1;
        if (__pyx_t_1026 &lt; 0) __pyx_t_1026 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1027 &lt; 0) __pyx_t_1027 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1026, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1027, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+766:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1028 = __pyx_v_j;
          __pyx_t_1029 = 1;
          if (__pyx_t_1028 &lt; 0) __pyx_t_1028 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1029 &lt; 0) __pyx_t_1029 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1030 = __pyx_v_j;
          __pyx_t_1031 = 0;
          if (__pyx_t_1030 &lt; 0) __pyx_t_1030 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1031 &lt; 0) __pyx_t_1031 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1032 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1028, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1029, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1033 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1030, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1031, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1032 &lt; 0) __pyx_t_1032 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1033 &lt; 0) __pyx_t_1033 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1032, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1033, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+767:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1034 = __pyx_v_j;
          __pyx_t_1035 = 2;
          if (__pyx_t_1034 &lt; 0) __pyx_t_1034 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1035 &lt; 0) __pyx_t_1035 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1034, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1035, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+768:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1036 = __pyx_v_j;
            __pyx_t_1037 = 2;
            if (__pyx_t_1036 &lt; 0) __pyx_t_1036 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1037 &lt; 0) __pyx_t_1037 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1038 = __pyx_v_j;
            __pyx_t_1039 = 0;
            if (__pyx_t_1038 &lt; 0) __pyx_t_1038 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1039 &lt; 0) __pyx_t_1039 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1040 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1036, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1037, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1041 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1038, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1039, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1040 &lt; 0) __pyx_t_1040 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1041 &lt; 0) __pyx_t_1041 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1040, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1041, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L132;
          }
          __pyx_L132:;
          goto __pyx_L131;
        }
        __pyx_L131:;
</pre><pre class='cython line score-0'>&#xA0;769:                     # derivative with respect to reactant 3</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+770:                     deriv = k * C[ip[j,0]] * C[ip[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_1042 = __pyx_v_j;
        __pyx_t_1043 = 0;
        if (__pyx_t_1042 &lt; 0) __pyx_t_1042 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1043 &lt; 0) __pyx_t_1043 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1044 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1042, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1043, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1044 &lt; 0) __pyx_t_1044 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1045 = __pyx_v_j;
        __pyx_t_1046 = 0;
        if (__pyx_t_1045 &lt; 0) __pyx_t_1045 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1046 &lt; 0) __pyx_t_1046 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1047 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1045, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1046, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1047 &lt; 0) __pyx_t_1047 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1044, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1047, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+771:                     pd[ip[j,0], ip[j,2]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1048 = __pyx_v_j;
        __pyx_t_1049 = 0;
        if (__pyx_t_1048 &lt; 0) __pyx_t_1048 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1049 &lt; 0) __pyx_t_1049 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1050 = __pyx_v_j;
        __pyx_t_1051 = 2;
        if (__pyx_t_1050 &lt; 0) __pyx_t_1050 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1051 &lt; 0) __pyx_t_1051 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1052 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1048, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1049, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1053 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1050, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1051, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1052 &lt; 0) __pyx_t_1052 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1053 &lt; 0) __pyx_t_1053 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1052, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1053, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+772:                     pd[ip[j,2], ip[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1054 = __pyx_v_j;
        __pyx_t_1055 = 2;
        if (__pyx_t_1054 &lt; 0) __pyx_t_1054 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1055 &lt; 0) __pyx_t_1055 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1056 = __pyx_v_j;
        __pyx_t_1057 = 2;
        if (__pyx_t_1056 &lt; 0) __pyx_t_1056 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1057 &lt; 0) __pyx_t_1057 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1058 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1054, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1055, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1059 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1056, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1057, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1058 &lt; 0) __pyx_t_1058 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1059 &lt; 0) __pyx_t_1059 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1058, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1059, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+773:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1060 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1061 = 0; __pyx_t_1061 &lt; __pyx_t_1060; __pyx_t_1061+=1) {
          __pyx_v_i = __pyx_t_1061;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+774:                         pd[ip[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_1062 = __pyx_v_j;
          __pyx_t_1063 = 0;
          if (__pyx_t_1062 &lt; 0) __pyx_t_1062 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1063 &lt; 0) __pyx_t_1063 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1064 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1062, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1063, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1065 = __pyx_v_i;
          if (__pyx_t_1064 &lt; 0) __pyx_t_1064 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1065 &lt; 0) __pyx_t_1065 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1064, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1065, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+775:                         pd[ip[j,2], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1066 = __pyx_v_j;
          __pyx_t_1067 = 2;
          if (__pyx_t_1066 &lt; 0) __pyx_t_1066 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1067 &lt; 0) __pyx_t_1067 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1068 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1066, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1067, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1069 = __pyx_v_i;
          if (__pyx_t_1068 &lt; 0) __pyx_t_1068 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1069 &lt; 0) __pyx_t_1069 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1068, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1069, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;776: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+777:                     pd[ir[j,0], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1060 = __pyx_v_j;
        __pyx_t_1070 = 0;
        if (__pyx_t_1060 &lt; 0) __pyx_t_1060 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1070 &lt; 0) __pyx_t_1070 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1061 = __pyx_v_j;
        __pyx_t_1071 = 2;
        if (__pyx_t_1061 &lt; 0) __pyx_t_1061 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1071 &lt; 0) __pyx_t_1071 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1072 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1060, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1070, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1073 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1061, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1071, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1072 &lt; 0) __pyx_t_1072 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1073 &lt; 0) __pyx_t_1073 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1072, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1073, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+778:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1074 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1075 = 0; __pyx_t_1075 &lt; __pyx_t_1074; __pyx_t_1075+=1) {
          __pyx_v_i = __pyx_t_1075;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+779:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_1076 = __pyx_v_j;
          __pyx_t_1077 = 0;
          if (__pyx_t_1076 &lt; 0) __pyx_t_1076 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1077 &lt; 0) __pyx_t_1077 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1078 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1076, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1077, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1079 = __pyx_v_i;
          if (__pyx_t_1078 &lt; 0) __pyx_t_1078 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1079 &lt; 0) __pyx_t_1079 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1078, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1079, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+780:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1074 = __pyx_v_j;
        __pyx_t_1080 = 1;
        if (__pyx_t_1074 &lt; 0) __pyx_t_1074 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1080 &lt; 0) __pyx_t_1080 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1074, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1080, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+781:                         pd[ir[j,1], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1075 = __pyx_v_j;
          __pyx_t_1081 = 1;
          if (__pyx_t_1075 &lt; 0) __pyx_t_1075 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1081 &lt; 0) __pyx_t_1081 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1082 = __pyx_v_j;
          __pyx_t_1083 = 2;
          if (__pyx_t_1082 &lt; 0) __pyx_t_1082 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1083 &lt; 0) __pyx_t_1083 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1084 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1075, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1081, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1085 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1082, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1083, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1084 &lt; 0) __pyx_t_1084 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1085 &lt; 0) __pyx_t_1085 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1084, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1085, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+782:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_1086 = __pyx_v_numCoreSpecies;
          for (__pyx_t_1087 = 0; __pyx_t_1087 &lt; __pyx_t_1086; __pyx_t_1087+=1) {
            __pyx_v_i = __pyx_t_1087;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+783:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_1088 = __pyx_v_j;
            __pyx_t_1089 = 1;
            if (__pyx_t_1088 &lt; 0) __pyx_t_1088 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1089 &lt; 0) __pyx_t_1089 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1090 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1088, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1089, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1091 = __pyx_v_i;
            if (__pyx_t_1090 &lt; 0) __pyx_t_1090 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1091 &lt; 0) __pyx_t_1091 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1090, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1091, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+784:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1086 = __pyx_v_j;
          __pyx_t_1092 = 2;
          if (__pyx_t_1086 &lt; 0) __pyx_t_1086 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1092 &lt; 0) __pyx_t_1092 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1086, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1092, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+785:                             pd[ir[j,2], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1087 = __pyx_v_j;
            __pyx_t_1093 = 2;
            if (__pyx_t_1087 &lt; 0) __pyx_t_1087 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1093 &lt; 0) __pyx_t_1093 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1094 = __pyx_v_j;
            __pyx_t_1095 = 2;
            if (__pyx_t_1094 &lt; 0) __pyx_t_1094 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1095 &lt; 0) __pyx_t_1095 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1096 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1087, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1093, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1097 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1094, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1095, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1096 &lt; 0) __pyx_t_1096 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1097 &lt; 0) __pyx_t_1097 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1096, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1097, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+786:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_1098 = __pyx_v_numCoreSpecies;
            for (__pyx_t_1099 = 0; __pyx_t_1099 &lt; __pyx_t_1098; __pyx_t_1099+=1) {
              __pyx_v_i = __pyx_t_1099;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+787:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_1100 = __pyx_v_j;
              __pyx_t_1101 = 2;
              if (__pyx_t_1100 &lt; 0) __pyx_t_1100 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_1101 &lt; 0) __pyx_t_1101 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_1102 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1100, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1101, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_1103 = __pyx_v_i;
              if (__pyx_t_1102 &lt; 0) __pyx_t_1102 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_1103 &lt; 0) __pyx_t_1103 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1102, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1103, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L140;
          }
          __pyx_L140:;
          goto __pyx_L137;
        }
        __pyx_L137:;
        goto __pyx_L120;
      }
</pre><pre class='cython line score-0'>&#xA0;788: </pre>
<pre class='cython line score-0'>&#xA0;789: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+790:                 elif ip[j,1] == ip[j,2]:</pre>
<pre class='cython code score-0'>      __pyx_t_1098 = __pyx_v_j;
      __pyx_t_1104 = 1;
      if (__pyx_t_1098 &lt; 0) __pyx_t_1098 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1104 &lt; 0) __pyx_t_1104 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_1099 = __pyx_v_j;
      __pyx_t_1105 = 2;
      if (__pyx_t_1099 &lt; 0) __pyx_t_1099 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1105 &lt; 0) __pyx_t_1105 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1098, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1104, __pyx_pybuffernd_ip.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1099, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1105, __pyx_pybuffernd_ip.diminfo[1].strides))) != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0'>&#xA0;791:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+792:                     deriv = k * C[ip[j,1]] * C[ip[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_1106 = __pyx_v_j;
        __pyx_t_1107 = 1;
        if (__pyx_t_1106 &lt; 0) __pyx_t_1106 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1107 &lt; 0) __pyx_t_1107 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1108 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1106, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1107, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1108 &lt; 0) __pyx_t_1108 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1109 = __pyx_v_j;
        __pyx_t_1110 = 1;
        if (__pyx_t_1109 &lt; 0) __pyx_t_1109 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1110 &lt; 0) __pyx_t_1110 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1111 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1109, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1110, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1111 &lt; 0) __pyx_t_1111 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1108, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1111, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+793:                     pd[ip[j,0], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1112 = __pyx_v_j;
        __pyx_t_1113 = 0;
        if (__pyx_t_1112 &lt; 0) __pyx_t_1112 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1113 &lt; 0) __pyx_t_1113 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1114 = __pyx_v_j;
        __pyx_t_1115 = 0;
        if (__pyx_t_1114 &lt; 0) __pyx_t_1114 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1115 &lt; 0) __pyx_t_1115 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1116 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1112, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1113, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1117 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1114, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1115, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1116 &lt; 0) __pyx_t_1116 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1117 &lt; 0) __pyx_t_1117 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1116, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1117, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+794:                     pd[ip[j,1], ip[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1118 = __pyx_v_j;
        __pyx_t_1119 = 1;
        if (__pyx_t_1118 &lt; 0) __pyx_t_1118 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1119 &lt; 0) __pyx_t_1119 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1120 = __pyx_v_j;
        __pyx_t_1121 = 0;
        if (__pyx_t_1120 &lt; 0) __pyx_t_1120 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1121 &lt; 0) __pyx_t_1121 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1122 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1118, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1119, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1123 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1120, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1121, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1122 &lt; 0) __pyx_t_1122 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1123 &lt; 0) __pyx_t_1123 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1122, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1123, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0'>&#xA0;795: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+796:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1124 = __pyx_v_j;
        __pyx_t_1125 = 0;
        if (__pyx_t_1124 &lt; 0) __pyx_t_1124 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1125 &lt; 0) __pyx_t_1125 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1126 = __pyx_v_j;
        __pyx_t_1127 = 0;
        if (__pyx_t_1126 &lt; 0) __pyx_t_1126 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1127 &lt; 0) __pyx_t_1127 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1128 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1124, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1125, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1129 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1126, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1127, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1128 &lt; 0) __pyx_t_1128 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1129 &lt; 0) __pyx_t_1129 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1128, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1129, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+797:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1130 = __pyx_v_j;
        __pyx_t_1131 = 1;
        if (__pyx_t_1130 &lt; 0) __pyx_t_1130 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1131 &lt; 0) __pyx_t_1131 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1130, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1131, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+798:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1132 = __pyx_v_j;
          __pyx_t_1133 = 1;
          if (__pyx_t_1132 &lt; 0) __pyx_t_1132 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1133 &lt; 0) __pyx_t_1133 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1134 = __pyx_v_j;
          __pyx_t_1135 = 0;
          if (__pyx_t_1134 &lt; 0) __pyx_t_1134 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1135 &lt; 0) __pyx_t_1135 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1136 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1132, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1133, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1137 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1134, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1135, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1136 &lt; 0) __pyx_t_1136 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1137 &lt; 0) __pyx_t_1137 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1136, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1137, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+799:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1138 = __pyx_v_j;
          __pyx_t_1139 = 2;
          if (__pyx_t_1138 &lt; 0) __pyx_t_1138 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1139 &lt; 0) __pyx_t_1139 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1138, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1139, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+800:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1140 = __pyx_v_j;
            __pyx_t_1141 = 2;
            if (__pyx_t_1140 &lt; 0) __pyx_t_1140 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1141 &lt; 0) __pyx_t_1141 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1142 = __pyx_v_j;
            __pyx_t_1143 = 0;
            if (__pyx_t_1142 &lt; 0) __pyx_t_1142 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1143 &lt; 0) __pyx_t_1143 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1144 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1140, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1141, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1145 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1142, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1143, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1144 &lt; 0) __pyx_t_1144 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1145 &lt; 0) __pyx_t_1145 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1144, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1145, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L144;
          }
          __pyx_L144:;
          goto __pyx_L143;
        }
        __pyx_L143:;
</pre><pre class='cython line score-0'>&#xA0;801: </pre>
<pre class='cython line score-0'>&#xA0;802:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+803:                     deriv = 2 * k * C[ip[j,0]] * C[ip[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_1146 = __pyx_v_j;
        __pyx_t_1147 = 0;
        if (__pyx_t_1146 &lt; 0) __pyx_t_1146 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1147 &lt; 0) __pyx_t_1147 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1148 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1146, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1147, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1148 &lt; 0) __pyx_t_1148 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1149 = __pyx_v_j;
        __pyx_t_1150 = 1;
        if (__pyx_t_1149 &lt; 0) __pyx_t_1149 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1150 &lt; 0) __pyx_t_1150 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1151 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1149, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1150, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1151 &lt; 0) __pyx_t_1151 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1148, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1151, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+804:                     pd[ip[j,0], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1152 = __pyx_v_j;
        __pyx_t_1153 = 0;
        if (__pyx_t_1152 &lt; 0) __pyx_t_1152 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1153 &lt; 0) __pyx_t_1153 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1154 = __pyx_v_j;
        __pyx_t_1155 = 1;
        if (__pyx_t_1154 &lt; 0) __pyx_t_1154 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1155 &lt; 0) __pyx_t_1155 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1156 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1152, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1153, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1157 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1154, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1155, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1156 &lt; 0) __pyx_t_1156 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1157 &lt; 0) __pyx_t_1157 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1156, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1157, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+805:                     pd[ip[j,1], ip[j,1]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1158 = __pyx_v_j;
        __pyx_t_1159 = 1;
        if (__pyx_t_1158 &lt; 0) __pyx_t_1158 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1159 &lt; 0) __pyx_t_1159 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1160 = __pyx_v_j;
        __pyx_t_1161 = 1;
        if (__pyx_t_1160 &lt; 0) __pyx_t_1160 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1161 &lt; 0) __pyx_t_1161 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1162 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1158, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1159, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1163 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1160, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1161, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1162 &lt; 0) __pyx_t_1162 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1163 &lt; 0) __pyx_t_1163 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1162, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1163, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+806:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1164 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1165 = 0; __pyx_t_1165 &lt; __pyx_t_1164; __pyx_t_1165+=1) {
          __pyx_v_i = __pyx_t_1165;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+807:                         pd[ip[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1166 = __pyx_v_j;
          __pyx_t_1167 = 0;
          if (__pyx_t_1166 &lt; 0) __pyx_t_1166 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1167 &lt; 0) __pyx_t_1167 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1168 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1166, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1167, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1169 = __pyx_v_i;
          if (__pyx_t_1168 &lt; 0) __pyx_t_1168 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1169 &lt; 0) __pyx_t_1169 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1168, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1169, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+808:                         pd[ip[j,1], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_1170 = __pyx_v_j;
          __pyx_t_1171 = 1;
          if (__pyx_t_1170 &lt; 0) __pyx_t_1170 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1171 &lt; 0) __pyx_t_1171 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1172 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1170, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1171, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1173 = __pyx_v_i;
          if (__pyx_t_1172 &lt; 0) __pyx_t_1172 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1173 &lt; 0) __pyx_t_1173 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1172, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1173, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
        }
</pre><pre class='cython line score-0'>&#xA0;809: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+810:                     pd[ir[j,0], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1164 = __pyx_v_j;
        __pyx_t_1174 = 0;
        if (__pyx_t_1164 &lt; 0) __pyx_t_1164 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1174 &lt; 0) __pyx_t_1174 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1165 = __pyx_v_j;
        __pyx_t_1175 = 1;
        if (__pyx_t_1165 &lt; 0) __pyx_t_1165 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1175 &lt; 0) __pyx_t_1175 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1176 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1164, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1174, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1177 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1165, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1175, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1176 &lt; 0) __pyx_t_1176 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1177 &lt; 0) __pyx_t_1177 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1176, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1177, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+811:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1178 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1179 = 0; __pyx_t_1179 &lt; __pyx_t_1178; __pyx_t_1179+=1) {
          __pyx_v_i = __pyx_t_1179;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+812:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_1180 = __pyx_v_j;
          __pyx_t_1181 = 0;
          if (__pyx_t_1180 &lt; 0) __pyx_t_1180 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1181 &lt; 0) __pyx_t_1181 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1182 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1180, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1181, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1183 = __pyx_v_i;
          if (__pyx_t_1182 &lt; 0) __pyx_t_1182 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1183 &lt; 0) __pyx_t_1183 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1182, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1183, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+813:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1178 = __pyx_v_j;
        __pyx_t_1184 = 1;
        if (__pyx_t_1178 &lt; 0) __pyx_t_1178 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1184 &lt; 0) __pyx_t_1184 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1178, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1184, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+814:                         pd[ir[j,1], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1179 = __pyx_v_j;
          __pyx_t_1185 = 1;
          if (__pyx_t_1179 &lt; 0) __pyx_t_1179 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1185 &lt; 0) __pyx_t_1185 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1186 = __pyx_v_j;
          __pyx_t_1187 = 1;
          if (__pyx_t_1186 &lt; 0) __pyx_t_1186 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1187 &lt; 0) __pyx_t_1187 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1188 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1179, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1185, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1189 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1186, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1187, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1188 &lt; 0) __pyx_t_1188 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1189 &lt; 0) __pyx_t_1189 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1188, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1189, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+815:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_1190 = __pyx_v_numCoreSpecies;
          for (__pyx_t_1191 = 0; __pyx_t_1191 &lt; __pyx_t_1190; __pyx_t_1191+=1) {
            __pyx_v_i = __pyx_t_1191;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+816:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_1192 = __pyx_v_j;
            __pyx_t_1193 = 1;
            if (__pyx_t_1192 &lt; 0) __pyx_t_1192 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1193 &lt; 0) __pyx_t_1193 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1194 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1192, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1193, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1195 = __pyx_v_i;
            if (__pyx_t_1194 &lt; 0) __pyx_t_1194 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1195 &lt; 0) __pyx_t_1195 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1194, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1195, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+817:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1190 = __pyx_v_j;
          __pyx_t_1196 = 2;
          if (__pyx_t_1190 &lt; 0) __pyx_t_1190 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1196 &lt; 0) __pyx_t_1196 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1190, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1196, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+818:                             pd[ir[j,2], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1191 = __pyx_v_j;
            __pyx_t_1197 = 2;
            if (__pyx_t_1191 &lt; 0) __pyx_t_1191 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1197 &lt; 0) __pyx_t_1197 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1198 = __pyx_v_j;
            __pyx_t_1199 = 1;
            if (__pyx_t_1198 &lt; 0) __pyx_t_1198 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1199 &lt; 0) __pyx_t_1199 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1200 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1191, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1197, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1201 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1198, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1199, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1200 &lt; 0) __pyx_t_1200 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1201 &lt; 0) __pyx_t_1201 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1200, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1201, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+819:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_1202 = __pyx_v_numCoreSpecies;
            for (__pyx_t_1203 = 0; __pyx_t_1203 &lt; __pyx_t_1202; __pyx_t_1203+=1) {
              __pyx_v_i = __pyx_t_1203;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+820:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_1204 = __pyx_v_j;
              __pyx_t_1205 = 2;
              if (__pyx_t_1204 &lt; 0) __pyx_t_1204 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_1205 &lt; 0) __pyx_t_1205 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_1206 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1204, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1205, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_1207 = __pyx_v_i;
              if (__pyx_t_1206 &lt; 0) __pyx_t_1206 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_1207 &lt; 0) __pyx_t_1207 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1206, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1207, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L152;
          }
          __pyx_L152:;
          goto __pyx_L149;
        }
        __pyx_L149:;
        goto __pyx_L120;
      }
</pre><pre class='cython line score-0'>&#xA0;821: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+822:                 elif ip[j,0] == ip[j,2]:</pre>
<pre class='cython code score-0'>      __pyx_t_1202 = __pyx_v_j;
      __pyx_t_1208 = 0;
      if (__pyx_t_1202 &lt; 0) __pyx_t_1202 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1208 &lt; 0) __pyx_t_1208 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_1203 = __pyx_v_j;
      __pyx_t_1209 = 2;
      if (__pyx_t_1203 &lt; 0) __pyx_t_1203 += __pyx_pybuffernd_ip.diminfo[0].shape;
      if (__pyx_t_1209 &lt; 0) __pyx_t_1209 += __pyx_pybuffernd_ip.diminfo[1].shape;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1202, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1208, __pyx_pybuffernd_ip.diminfo[1].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1203, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1209, __pyx_pybuffernd_ip.diminfo[1].strides))) != 0);
      if (__pyx_t_23) {
</pre><pre class='cython line score-0'>&#xA0;823:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+824:                     deriv = 2 * k * C[ip[j,0]] * C[ip[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_1210 = __pyx_v_j;
        __pyx_t_1211 = 0;
        if (__pyx_t_1210 &lt; 0) __pyx_t_1210 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1211 &lt; 0) __pyx_t_1211 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1212 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1210, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1211, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1212 &lt; 0) __pyx_t_1212 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1213 = __pyx_v_j;
        __pyx_t_1214 = 1;
        if (__pyx_t_1213 &lt; 0) __pyx_t_1213 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1214 &lt; 0) __pyx_t_1214 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1215 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1213, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1214, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1215 &lt; 0) __pyx_t_1215 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = (((2.0 * __pyx_v_k) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1212, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1215, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+825:                     pd[ip[j,0], ip[j,0]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1216 = __pyx_v_j;
        __pyx_t_1217 = 0;
        if (__pyx_t_1216 &lt; 0) __pyx_t_1216 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1217 &lt; 0) __pyx_t_1217 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1218 = __pyx_v_j;
        __pyx_t_1219 = 0;
        if (__pyx_t_1218 &lt; 0) __pyx_t_1218 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1219 &lt; 0) __pyx_t_1219 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1220 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1216, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1217, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1221 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1218, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1219, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1220 &lt; 0) __pyx_t_1220 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1221 &lt; 0) __pyx_t_1221 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1220, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1221, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+826:                     pd[ip[j,1], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1222 = __pyx_v_j;
        __pyx_t_1223 = 1;
        if (__pyx_t_1222 &lt; 0) __pyx_t_1222 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1223 &lt; 0) __pyx_t_1223 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1224 = __pyx_v_j;
        __pyx_t_1225 = 0;
        if (__pyx_t_1224 &lt; 0) __pyx_t_1224 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1225 &lt; 0) __pyx_t_1225 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1226 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1222, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1223, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1227 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1224, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1225, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1226 &lt; 0) __pyx_t_1226 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1227 &lt; 0) __pyx_t_1227 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1226, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1227, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;827: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+828:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1228 = __pyx_v_j;
        __pyx_t_1229 = 0;
        if (__pyx_t_1228 &lt; 0) __pyx_t_1228 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1229 &lt; 0) __pyx_t_1229 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1230 = __pyx_v_j;
        __pyx_t_1231 = 0;
        if (__pyx_t_1230 &lt; 0) __pyx_t_1230 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1231 &lt; 0) __pyx_t_1231 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1232 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1228, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1229, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1233 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1230, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1231, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1232 &lt; 0) __pyx_t_1232 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1233 &lt; 0) __pyx_t_1233 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1232, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1233, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+829:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1234 = __pyx_v_j;
        __pyx_t_1235 = 1;
        if (__pyx_t_1234 &lt; 0) __pyx_t_1234 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1235 &lt; 0) __pyx_t_1235 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1234, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1235, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+830:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1236 = __pyx_v_j;
          __pyx_t_1237 = 1;
          if (__pyx_t_1236 &lt; 0) __pyx_t_1236 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1237 &lt; 0) __pyx_t_1237 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1238 = __pyx_v_j;
          __pyx_t_1239 = 0;
          if (__pyx_t_1238 &lt; 0) __pyx_t_1238 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1239 &lt; 0) __pyx_t_1239 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1240 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1236, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1237, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1241 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1238, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1239, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1240 &lt; 0) __pyx_t_1240 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1241 &lt; 0) __pyx_t_1241 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1240, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1241, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+831:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1242 = __pyx_v_j;
          __pyx_t_1243 = 2;
          if (__pyx_t_1242 &lt; 0) __pyx_t_1242 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1243 &lt; 0) __pyx_t_1243 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1242, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1243, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+832:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1244 = __pyx_v_j;
            __pyx_t_1245 = 2;
            if (__pyx_t_1244 &lt; 0) __pyx_t_1244 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1245 &lt; 0) __pyx_t_1245 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1246 = __pyx_v_j;
            __pyx_t_1247 = 0;
            if (__pyx_t_1246 &lt; 0) __pyx_t_1246 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1247 &lt; 0) __pyx_t_1247 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1248 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1244, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1245, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1249 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1246, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1247, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1248 &lt; 0) __pyx_t_1248 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1249 &lt; 0) __pyx_t_1249 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1248, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1249, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L156;
          }
          __pyx_L156:;
          goto __pyx_L155;
        }
        __pyx_L155:;
</pre><pre class='cython line score-0'>&#xA0;833:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+834:                     deriv = k * C[ip[j,0]] * C[ip[j,0]]</pre>
<pre class='cython code score-0'>        __pyx_t_1250 = __pyx_v_j;
        __pyx_t_1251 = 0;
        if (__pyx_t_1250 &lt; 0) __pyx_t_1250 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1251 &lt; 0) __pyx_t_1251 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1252 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1250, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1251, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1252 &lt; 0) __pyx_t_1252 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1253 = __pyx_v_j;
        __pyx_t_1254 = 0;
        if (__pyx_t_1253 &lt; 0) __pyx_t_1253 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1254 &lt; 0) __pyx_t_1254 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1255 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1253, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1254, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1255 &lt; 0) __pyx_t_1255 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1252, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1255, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+835:                     pd[ip[j,0], ip[j,1]] -= 2 * deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1256 = __pyx_v_j;
        __pyx_t_1257 = 0;
        if (__pyx_t_1256 &lt; 0) __pyx_t_1256 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1257 &lt; 0) __pyx_t_1257 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1258 = __pyx_v_j;
        __pyx_t_1259 = 1;
        if (__pyx_t_1258 &lt; 0) __pyx_t_1258 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1259 &lt; 0) __pyx_t_1259 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1260 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1256, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1257, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1261 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1258, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1259, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1260 &lt; 0) __pyx_t_1260 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1261 &lt; 0) __pyx_t_1261 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1260, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1261, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_deriv);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+836:                     pd[ip[j,1], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1262 = __pyx_v_j;
        __pyx_t_1263 = 1;
        if (__pyx_t_1262 &lt; 0) __pyx_t_1262 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1263 &lt; 0) __pyx_t_1263 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1264 = __pyx_v_j;
        __pyx_t_1265 = 1;
        if (__pyx_t_1264 &lt; 0) __pyx_t_1264 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1265 &lt; 0) __pyx_t_1265 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1266 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1262, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1263, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1267 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1264, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1265, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1266 &lt; 0) __pyx_t_1266 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1267 &lt; 0) __pyx_t_1267 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1266, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1267, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+837:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1268 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1269 = 0; __pyx_t_1269 &lt; __pyx_t_1268; __pyx_t_1269+=1) {
          __pyx_v_i = __pyx_t_1269;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+838:                         pd[ip[j,0], i] -= 2 * corr</pre>
<pre class='cython code score-0'>          __pyx_t_1270 = __pyx_v_j;
          __pyx_t_1271 = 0;
          if (__pyx_t_1270 &lt; 0) __pyx_t_1270 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1271 &lt; 0) __pyx_t_1271 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1272 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1270, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1271, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1273 = __pyx_v_i;
          if (__pyx_t_1272 &lt; 0) __pyx_t_1272 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1273 &lt; 0) __pyx_t_1273 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1272, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1273, __pyx_pybuffernd_pd.diminfo[1].strides) -= (2.0 * __pyx_v_corr);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+839:                         pd[ip[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1274 = __pyx_v_j;
          __pyx_t_1275 = 1;
          if (__pyx_t_1274 &lt; 0) __pyx_t_1274 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1275 &lt; 0) __pyx_t_1275 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1276 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1274, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1275, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1277 = __pyx_v_i;
          if (__pyx_t_1276 &lt; 0) __pyx_t_1276 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1277 &lt; 0) __pyx_t_1277 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1276, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1277, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;840: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+841:                     pd[ir[j,0], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1268 = __pyx_v_j;
        __pyx_t_1278 = 0;
        if (__pyx_t_1268 &lt; 0) __pyx_t_1268 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1278 &lt; 0) __pyx_t_1278 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1269 = __pyx_v_j;
        __pyx_t_1279 = 1;
        if (__pyx_t_1269 &lt; 0) __pyx_t_1269 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1279 &lt; 0) __pyx_t_1279 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1280 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1268, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1278, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1281 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1269, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1279, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1280 &lt; 0) __pyx_t_1280 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1281 &lt; 0) __pyx_t_1281 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1280, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1281, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+842:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1282 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1283 = 0; __pyx_t_1283 &lt; __pyx_t_1282; __pyx_t_1283+=1) {
          __pyx_v_i = __pyx_t_1283;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+843:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_1284 = __pyx_v_j;
          __pyx_t_1285 = 0;
          if (__pyx_t_1284 &lt; 0) __pyx_t_1284 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1285 &lt; 0) __pyx_t_1285 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1286 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1284, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1285, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1287 = __pyx_v_i;
          if (__pyx_t_1286 &lt; 0) __pyx_t_1286 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1287 &lt; 0) __pyx_t_1287 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1286, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1287, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+844:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1282 = __pyx_v_j;
        __pyx_t_1288 = 1;
        if (__pyx_t_1282 &lt; 0) __pyx_t_1282 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1288 &lt; 0) __pyx_t_1288 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1282, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1288, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+845:                         pd[ir[j,1], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1283 = __pyx_v_j;
          __pyx_t_1289 = 1;
          if (__pyx_t_1283 &lt; 0) __pyx_t_1283 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1289 &lt; 0) __pyx_t_1289 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1290 = __pyx_v_j;
          __pyx_t_1291 = 1;
          if (__pyx_t_1290 &lt; 0) __pyx_t_1290 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1291 &lt; 0) __pyx_t_1291 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1292 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1283, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1289, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1293 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1290, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1291, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1292 &lt; 0) __pyx_t_1292 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1293 &lt; 0) __pyx_t_1293 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1292, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1293, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+846:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_1294 = __pyx_v_numCoreSpecies;
          for (__pyx_t_1295 = 0; __pyx_t_1295 &lt; __pyx_t_1294; __pyx_t_1295+=1) {
            __pyx_v_i = __pyx_t_1295;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+847:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_1296 = __pyx_v_j;
            __pyx_t_1297 = 1;
            if (__pyx_t_1296 &lt; 0) __pyx_t_1296 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1297 &lt; 0) __pyx_t_1297 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1298 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1296, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1297, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1299 = __pyx_v_i;
            if (__pyx_t_1298 &lt; 0) __pyx_t_1298 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1299 &lt; 0) __pyx_t_1299 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1298, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1299, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+848:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1294 = __pyx_v_j;
          __pyx_t_1300 = 2;
          if (__pyx_t_1294 &lt; 0) __pyx_t_1294 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1300 &lt; 0) __pyx_t_1300 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1294, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1300, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+849:                             pd[ir[j,2], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1295 = __pyx_v_j;
            __pyx_t_1301 = 2;
            if (__pyx_t_1295 &lt; 0) __pyx_t_1295 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1301 &lt; 0) __pyx_t_1301 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1302 = __pyx_v_j;
            __pyx_t_1303 = 1;
            if (__pyx_t_1302 &lt; 0) __pyx_t_1302 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1303 &lt; 0) __pyx_t_1303 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1304 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1295, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1301, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1305 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1302, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1303, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1304 &lt; 0) __pyx_t_1304 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1305 &lt; 0) __pyx_t_1305 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1304, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1305, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+850:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_1306 = __pyx_v_numCoreSpecies;
            for (__pyx_t_1307 = 0; __pyx_t_1307 &lt; __pyx_t_1306; __pyx_t_1307+=1) {
              __pyx_v_i = __pyx_t_1307;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+851:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_1308 = __pyx_v_j;
              __pyx_t_1309 = 2;
              if (__pyx_t_1308 &lt; 0) __pyx_t_1308 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_1309 &lt; 0) __pyx_t_1309 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_1310 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1308, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1309, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_1311 = __pyx_v_i;
              if (__pyx_t_1310 &lt; 0) __pyx_t_1310 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_1311 &lt; 0) __pyx_t_1311 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1310, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1311, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L164;
          }
          __pyx_L164:;
          goto __pyx_L161;
        }
        __pyx_L161:;
        goto __pyx_L120;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;852: </pre>
<pre class='cython line score-0'>&#xA0;853:                 else:</pre>
<pre class='cython line score-0'>&#xA0;854:                     # derivative with respect to reactant 1</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+855:                     deriv = k * C[ip[j,1]] * C[ip[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_1306 = __pyx_v_j;
        __pyx_t_1312 = 1;
        if (__pyx_t_1306 &lt; 0) __pyx_t_1306 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1312 &lt; 0) __pyx_t_1312 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1313 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1306, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1312, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1313 &lt; 0) __pyx_t_1313 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1307 = __pyx_v_j;
        __pyx_t_1314 = 2;
        if (__pyx_t_1307 &lt; 0) __pyx_t_1307 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1314 &lt; 0) __pyx_t_1314 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1315 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1307, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1314, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1315 &lt; 0) __pyx_t_1315 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1313, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1315, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+856:                     pd[ip[j,0], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1316 = __pyx_v_j;
        __pyx_t_1317 = 0;
        if (__pyx_t_1316 &lt; 0) __pyx_t_1316 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1317 &lt; 0) __pyx_t_1317 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1318 = __pyx_v_j;
        __pyx_t_1319 = 0;
        if (__pyx_t_1318 &lt; 0) __pyx_t_1318 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1319 &lt; 0) __pyx_t_1319 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1320 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1316, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1317, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1321 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1318, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1319, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1320 &lt; 0) __pyx_t_1320 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1321 &lt; 0) __pyx_t_1321 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1320, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1321, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+857:                     pd[ip[j,1], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1322 = __pyx_v_j;
        __pyx_t_1323 = 1;
        if (__pyx_t_1322 &lt; 0) __pyx_t_1322 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1323 &lt; 0) __pyx_t_1323 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1324 = __pyx_v_j;
        __pyx_t_1325 = 0;
        if (__pyx_t_1324 &lt; 0) __pyx_t_1324 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1325 &lt; 0) __pyx_t_1325 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1326 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1322, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1323, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1327 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1324, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1325, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1326 &lt; 0) __pyx_t_1326 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1327 &lt; 0) __pyx_t_1327 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1326, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1327, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+858:                     pd[ip[j,2], ip[j,0]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1328 = __pyx_v_j;
        __pyx_t_1329 = 2;
        if (__pyx_t_1328 &lt; 0) __pyx_t_1328 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1329 &lt; 0) __pyx_t_1329 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1330 = __pyx_v_j;
        __pyx_t_1331 = 0;
        if (__pyx_t_1330 &lt; 0) __pyx_t_1330 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1331 &lt; 0) __pyx_t_1331 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1332 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1328, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1329, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1333 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1330, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1331, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1332 &lt; 0) __pyx_t_1332 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1333 &lt; 0) __pyx_t_1333 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1332, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1333, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;859: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+860:                     pd[ir[j,0], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1334 = __pyx_v_j;
        __pyx_t_1335 = 0;
        if (__pyx_t_1334 &lt; 0) __pyx_t_1334 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1335 &lt; 0) __pyx_t_1335 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1336 = __pyx_v_j;
        __pyx_t_1337 = 0;
        if (__pyx_t_1336 &lt; 0) __pyx_t_1336 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1337 &lt; 0) __pyx_t_1337 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1338 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1334, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1335, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1339 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1336, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1337, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1338 &lt; 0) __pyx_t_1338 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1339 &lt; 0) __pyx_t_1339 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1338, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1339, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+861:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1340 = __pyx_v_j;
        __pyx_t_1341 = 1;
        if (__pyx_t_1340 &lt; 0) __pyx_t_1340 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1341 &lt; 0) __pyx_t_1341 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1340, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1341, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+862:                         pd[ir[j,1], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1342 = __pyx_v_j;
          __pyx_t_1343 = 1;
          if (__pyx_t_1342 &lt; 0) __pyx_t_1342 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1343 &lt; 0) __pyx_t_1343 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1344 = __pyx_v_j;
          __pyx_t_1345 = 0;
          if (__pyx_t_1344 &lt; 0) __pyx_t_1344 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1345 &lt; 0) __pyx_t_1345 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1346 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1342, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1343, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1347 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1344, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1345, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1346 &lt; 0) __pyx_t_1346 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1347 &lt; 0) __pyx_t_1347 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1346, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1347, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+863:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1348 = __pyx_v_j;
          __pyx_t_1349 = 2;
          if (__pyx_t_1348 &lt; 0) __pyx_t_1348 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1349 &lt; 0) __pyx_t_1349 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1348, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1349, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+864:                             pd[ir[j,2], ip[j,0]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1350 = __pyx_v_j;
            __pyx_t_1351 = 2;
            if (__pyx_t_1350 &lt; 0) __pyx_t_1350 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1351 &lt; 0) __pyx_t_1351 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1352 = __pyx_v_j;
            __pyx_t_1353 = 0;
            if (__pyx_t_1352 &lt; 0) __pyx_t_1352 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1353 &lt; 0) __pyx_t_1353 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1354 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1350, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1351, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1355 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1352, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1353, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1354 &lt; 0) __pyx_t_1354 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1355 &lt; 0) __pyx_t_1355 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1354, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1355, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L168;
          }
          __pyx_L168:;
          goto __pyx_L167;
        }
        __pyx_L167:;
</pre><pre class='cython line score-0'>&#xA0;865: </pre>
<pre class='cython line score-0'>&#xA0;866:                     # derivative with respect to reactant 2</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+867:                     deriv = k * C[ip[j,0]] * C[ip[j,2]]</pre>
<pre class='cython code score-0'>        __pyx_t_1356 = __pyx_v_j;
        __pyx_t_1357 = 0;
        if (__pyx_t_1356 &lt; 0) __pyx_t_1356 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1357 &lt; 0) __pyx_t_1357 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1358 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1356, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1357, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1358 &lt; 0) __pyx_t_1358 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1359 = __pyx_v_j;
        __pyx_t_1360 = 2;
        if (__pyx_t_1359 &lt; 0) __pyx_t_1359 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1360 &lt; 0) __pyx_t_1360 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1361 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1359, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1360, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1361 &lt; 0) __pyx_t_1361 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1358, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1361, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+868:                     pd[ip[j,0], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1362 = __pyx_v_j;
        __pyx_t_1363 = 0;
        if (__pyx_t_1362 &lt; 0) __pyx_t_1362 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1363 &lt; 0) __pyx_t_1363 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1364 = __pyx_v_j;
        __pyx_t_1365 = 1;
        if (__pyx_t_1364 &lt; 0) __pyx_t_1364 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1365 &lt; 0) __pyx_t_1365 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1366 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1362, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1363, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1367 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1364, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1365, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1366 &lt; 0) __pyx_t_1366 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1367 &lt; 0) __pyx_t_1367 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1366, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1367, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+869:                     pd[ip[j,1], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1368 = __pyx_v_j;
        __pyx_t_1369 = 1;
        if (__pyx_t_1368 &lt; 0) __pyx_t_1368 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1369 &lt; 0) __pyx_t_1369 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1370 = __pyx_v_j;
        __pyx_t_1371 = 1;
        if (__pyx_t_1370 &lt; 0) __pyx_t_1370 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1371 &lt; 0) __pyx_t_1371 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1372 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1368, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1369, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1373 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1370, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1371, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1372 &lt; 0) __pyx_t_1372 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1373 &lt; 0) __pyx_t_1373 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1372, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1373, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+870:                     pd[ip[j,2], ip[j,1]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1374 = __pyx_v_j;
        __pyx_t_1375 = 2;
        if (__pyx_t_1374 &lt; 0) __pyx_t_1374 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1375 &lt; 0) __pyx_t_1375 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1376 = __pyx_v_j;
        __pyx_t_1377 = 1;
        if (__pyx_t_1376 &lt; 0) __pyx_t_1376 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1377 &lt; 0) __pyx_t_1377 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1378 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1374, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1375, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1379 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1376, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1377, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1378 &lt; 0) __pyx_t_1378 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1379 &lt; 0) __pyx_t_1379 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1378, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1379, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0'>&#xA0;871: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+872:                     pd[ir[j,0], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1380 = __pyx_v_j;
        __pyx_t_1381 = 0;
        if (__pyx_t_1380 &lt; 0) __pyx_t_1380 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1381 &lt; 0) __pyx_t_1381 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1382 = __pyx_v_j;
        __pyx_t_1383 = 1;
        if (__pyx_t_1382 &lt; 0) __pyx_t_1382 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1383 &lt; 0) __pyx_t_1383 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1384 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1380, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1381, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1385 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1382, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1383, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1384 &lt; 0) __pyx_t_1384 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1385 &lt; 0) __pyx_t_1385 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1384, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1385, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+873:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1386 = __pyx_v_j;
        __pyx_t_1387 = 1;
        if (__pyx_t_1386 &lt; 0) __pyx_t_1386 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1387 &lt; 0) __pyx_t_1387 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1386, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1387, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+874:                         pd[ir[j,1], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1388 = __pyx_v_j;
          __pyx_t_1389 = 1;
          if (__pyx_t_1388 &lt; 0) __pyx_t_1388 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1389 &lt; 0) __pyx_t_1389 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1390 = __pyx_v_j;
          __pyx_t_1391 = 1;
          if (__pyx_t_1390 &lt; 0) __pyx_t_1390 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1391 &lt; 0) __pyx_t_1391 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1392 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1388, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1389, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1393 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1390, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1391, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1392 &lt; 0) __pyx_t_1392 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1393 &lt; 0) __pyx_t_1393 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1392, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1393, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+875:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1394 = __pyx_v_j;
          __pyx_t_1395 = 2;
          if (__pyx_t_1394 &lt; 0) __pyx_t_1394 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1395 &lt; 0) __pyx_t_1395 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1394, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1395, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+876:                             pd[ir[j,2], ip[j,1]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1396 = __pyx_v_j;
            __pyx_t_1397 = 2;
            if (__pyx_t_1396 &lt; 0) __pyx_t_1396 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1397 &lt; 0) __pyx_t_1397 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1398 = __pyx_v_j;
            __pyx_t_1399 = 1;
            if (__pyx_t_1398 &lt; 0) __pyx_t_1398 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1399 &lt; 0) __pyx_t_1399 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1400 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1396, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1397, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1401 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1398, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1399, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1400 &lt; 0) __pyx_t_1400 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1401 &lt; 0) __pyx_t_1401 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1400, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1401, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
            goto __pyx_L170;
          }
          __pyx_L170:;
          goto __pyx_L169;
        }
        __pyx_L169:;
</pre><pre class='cython line score-0'>&#xA0;877: </pre>
<pre class='cython line score-0'>&#xA0;878:                     # derivative with respect to reactant 3</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+879:                     deriv = k * C[ip[j,0]] * C[ip[j,1]]</pre>
<pre class='cython code score-0'>        __pyx_t_1402 = __pyx_v_j;
        __pyx_t_1403 = 0;
        if (__pyx_t_1402 &lt; 0) __pyx_t_1402 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1403 &lt; 0) __pyx_t_1403 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1404 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1402, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1403, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1404 &lt; 0) __pyx_t_1404 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_t_1405 = __pyx_v_j;
        __pyx_t_1406 = 1;
        if (__pyx_t_1405 &lt; 0) __pyx_t_1405 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1406 &lt; 0) __pyx_t_1406 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1407 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1405, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1406, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1407 &lt; 0) __pyx_t_1407 += __pyx_pybuffernd_C.diminfo[0].shape;
        __pyx_v_deriv = ((__pyx_v_k * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1404, __pyx_pybuffernd_C.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_C.rcbuffer-&gt;pybuffer.buf, __pyx_t_1407, __pyx_pybuffernd_C.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+880:                     pd[ip[j,0], ip[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1408 = __pyx_v_j;
        __pyx_t_1409 = 0;
        if (__pyx_t_1408 &lt; 0) __pyx_t_1408 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1409 &lt; 0) __pyx_t_1409 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1410 = __pyx_v_j;
        __pyx_t_1411 = 2;
        if (__pyx_t_1410 &lt; 0) __pyx_t_1410 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1411 &lt; 0) __pyx_t_1411 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1412 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1408, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1409, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1413 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1410, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1411, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1412 &lt; 0) __pyx_t_1412 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1413 &lt; 0) __pyx_t_1413 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1412, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1413, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+881:                     pd[ip[j,1], ip[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1414 = __pyx_v_j;
        __pyx_t_1415 = 1;
        if (__pyx_t_1414 &lt; 0) __pyx_t_1414 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1415 &lt; 0) __pyx_t_1415 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1416 = __pyx_v_j;
        __pyx_t_1417 = 2;
        if (__pyx_t_1416 &lt; 0) __pyx_t_1416 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1417 &lt; 0) __pyx_t_1417 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1418 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1414, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1415, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1419 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1416, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1417, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1418 &lt; 0) __pyx_t_1418 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1419 &lt; 0) __pyx_t_1419 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1418, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1419, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+882:                     pd[ip[j,2], ip[j,2]] -= deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1420 = __pyx_v_j;
        __pyx_t_1421 = 2;
        if (__pyx_t_1420 &lt; 0) __pyx_t_1420 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1421 &lt; 0) __pyx_t_1421 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1422 = __pyx_v_j;
        __pyx_t_1423 = 2;
        if (__pyx_t_1422 &lt; 0) __pyx_t_1422 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1423 &lt; 0) __pyx_t_1423 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1424 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1420, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1421, __pyx_pybuffernd_ip.diminfo[1].strides));
        __pyx_t_1425 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1422, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1423, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1424 &lt; 0) __pyx_t_1424 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1425 &lt; 0) __pyx_t_1425 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1424, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1425, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+883:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1426 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1427 = 0; __pyx_t_1427 &lt; __pyx_t_1426; __pyx_t_1427+=1) {
          __pyx_v_i = __pyx_t_1427;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+884:                         pd[ip[j,0], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1428 = __pyx_v_j;
          __pyx_t_1429 = 0;
          if (__pyx_t_1428 &lt; 0) __pyx_t_1428 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1429 &lt; 0) __pyx_t_1429 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1430 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1428, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1429, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1431 = __pyx_v_i;
          if (__pyx_t_1430 &lt; 0) __pyx_t_1430 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1431 &lt; 0) __pyx_t_1431 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1430, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1431, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+885:                         pd[ip[j,1], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1432 = __pyx_v_j;
          __pyx_t_1433 = 1;
          if (__pyx_t_1432 &lt; 0) __pyx_t_1432 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1433 &lt; 0) __pyx_t_1433 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1434 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1432, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1433, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1435 = __pyx_v_i;
          if (__pyx_t_1434 &lt; 0) __pyx_t_1434 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1435 &lt; 0) __pyx_t_1435 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1434, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1435, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+886:                         pd[ip[j,2], i] -= corr</pre>
<pre class='cython code score-0'>          __pyx_t_1436 = __pyx_v_j;
          __pyx_t_1437 = 2;
          if (__pyx_t_1436 &lt; 0) __pyx_t_1436 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1437 &lt; 0) __pyx_t_1437 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1438 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1436, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1437, __pyx_pybuffernd_ip.diminfo[1].strides));
          __pyx_t_1439 = __pyx_v_i;
          if (__pyx_t_1438 &lt; 0) __pyx_t_1438 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1439 &lt; 0) __pyx_t_1439 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1438, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1439, __pyx_pybuffernd_pd.diminfo[1].strides) -= __pyx_v_corr;
        }
</pre><pre class='cython line score-0'>&#xA0;887: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+888:                     pd[ir[j,0], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>        __pyx_t_1426 = __pyx_v_j;
        __pyx_t_1440 = 0;
        if (__pyx_t_1426 &lt; 0) __pyx_t_1426 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1440 &lt; 0) __pyx_t_1440 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_1427 = __pyx_v_j;
        __pyx_t_1441 = 2;
        if (__pyx_t_1427 &lt; 0) __pyx_t_1427 += __pyx_pybuffernd_ip.diminfo[0].shape;
        if (__pyx_t_1441 &lt; 0) __pyx_t_1441 += __pyx_pybuffernd_ip.diminfo[1].shape;
        __pyx_t_1442 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1426, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1440, __pyx_pybuffernd_ir.diminfo[1].strides));
        __pyx_t_1443 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1427, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1441, __pyx_pybuffernd_ip.diminfo[1].strides));
        if (__pyx_t_1442 &lt; 0) __pyx_t_1442 += __pyx_pybuffernd_pd.diminfo[0].shape;
        if (__pyx_t_1443 &lt; 0) __pyx_t_1443 += __pyx_pybuffernd_pd.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1442, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1443, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+889:                     for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>        __pyx_t_1444 = __pyx_v_numCoreSpecies;
        for (__pyx_t_1445 = 0; __pyx_t_1445 &lt; __pyx_t_1444; __pyx_t_1445+=1) {
          __pyx_v_i = __pyx_t_1445;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+890:                         pd[ir[j,0], i] += corr</pre>
<pre class='cython code score-0'>          __pyx_t_1446 = __pyx_v_j;
          __pyx_t_1447 = 0;
          if (__pyx_t_1446 &lt; 0) __pyx_t_1446 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1447 &lt; 0) __pyx_t_1447 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1448 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1446, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1447, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1449 = __pyx_v_i;
          if (__pyx_t_1448 &lt; 0) __pyx_t_1448 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1449 &lt; 0) __pyx_t_1449 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1448, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1449, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+891:                     if ir[j,1] != -1:</pre>
<pre class='cython code score-0'>        __pyx_t_1444 = __pyx_v_j;
        __pyx_t_1450 = 1;
        if (__pyx_t_1444 &lt; 0) __pyx_t_1444 += __pyx_pybuffernd_ir.diminfo[0].shape;
        if (__pyx_t_1450 &lt; 0) __pyx_t_1450 += __pyx_pybuffernd_ir.diminfo[1].shape;
        __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1444, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1450, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
        if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+892:                         pd[ir[j,1], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>          __pyx_t_1445 = __pyx_v_j;
          __pyx_t_1451 = 1;
          if (__pyx_t_1445 &lt; 0) __pyx_t_1445 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1451 &lt; 0) __pyx_t_1451 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_1452 = __pyx_v_j;
          __pyx_t_1453 = 2;
          if (__pyx_t_1452 &lt; 0) __pyx_t_1452 += __pyx_pybuffernd_ip.diminfo[0].shape;
          if (__pyx_t_1453 &lt; 0) __pyx_t_1453 += __pyx_pybuffernd_ip.diminfo[1].shape;
          __pyx_t_1454 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1445, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1451, __pyx_pybuffernd_ir.diminfo[1].strides));
          __pyx_t_1455 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1452, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1453, __pyx_pybuffernd_ip.diminfo[1].strides));
          if (__pyx_t_1454 &lt; 0) __pyx_t_1454 += __pyx_pybuffernd_pd.diminfo[0].shape;
          if (__pyx_t_1455 &lt; 0) __pyx_t_1455 += __pyx_pybuffernd_pd.diminfo[1].shape;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1454, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1455, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+893:                         for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>          __pyx_t_1456 = __pyx_v_numCoreSpecies;
          for (__pyx_t_1457 = 0; __pyx_t_1457 &lt; __pyx_t_1456; __pyx_t_1457+=1) {
            __pyx_v_i = __pyx_t_1457;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+894:                             pd[ir[j,1], i] += corr</pre>
<pre class='cython code score-0'>            __pyx_t_1458 = __pyx_v_j;
            __pyx_t_1459 = 1;
            if (__pyx_t_1458 &lt; 0) __pyx_t_1458 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1459 &lt; 0) __pyx_t_1459 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1460 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1458, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1459, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1461 = __pyx_v_i;
            if (__pyx_t_1460 &lt; 0) __pyx_t_1460 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1461 &lt; 0) __pyx_t_1461 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1460, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1461, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+895:                         if ir[j,2] != -1:</pre>
<pre class='cython code score-0'>          __pyx_t_1456 = __pyx_v_j;
          __pyx_t_1462 = 2;
          if (__pyx_t_1456 &lt; 0) __pyx_t_1456 += __pyx_pybuffernd_ir.diminfo[0].shape;
          if (__pyx_t_1462 &lt; 0) __pyx_t_1462 += __pyx_pybuffernd_ir.diminfo[1].shape;
          __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1456, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1462, __pyx_pybuffernd_ir.diminfo[1].strides)) != -1) != 0);
          if (__pyx_t_23) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+896:                             pd[ir[j,2], ip[j,2]] += deriv</pre>
<pre class='cython code score-0'>            __pyx_t_1457 = __pyx_v_j;
            __pyx_t_1463 = 2;
            if (__pyx_t_1457 &lt; 0) __pyx_t_1457 += __pyx_pybuffernd_ir.diminfo[0].shape;
            if (__pyx_t_1463 &lt; 0) __pyx_t_1463 += __pyx_pybuffernd_ir.diminfo[1].shape;
            __pyx_t_1464 = __pyx_v_j;
            __pyx_t_1465 = 2;
            if (__pyx_t_1464 &lt; 0) __pyx_t_1464 += __pyx_pybuffernd_ip.diminfo[0].shape;
            if (__pyx_t_1465 &lt; 0) __pyx_t_1465 += __pyx_pybuffernd_ip.diminfo[1].shape;
            __pyx_t_1466 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1457, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1463, __pyx_pybuffernd_ir.diminfo[1].strides));
            __pyx_t_1467 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ip.rcbuffer-&gt;pybuffer.buf, __pyx_t_1464, __pyx_pybuffernd_ip.diminfo[0].strides, __pyx_t_1465, __pyx_pybuffernd_ip.diminfo[1].strides));
            if (__pyx_t_1466 &lt; 0) __pyx_t_1466 += __pyx_pybuffernd_pd.diminfo[0].shape;
            if (__pyx_t_1467 &lt; 0) __pyx_t_1467 += __pyx_pybuffernd_pd.diminfo[1].shape;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1466, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1467, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_deriv;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+897:                             for i in xrange(numCoreSpecies):</pre>
<pre class='cython code score-0'>            __pyx_t_1468 = __pyx_v_numCoreSpecies;
            for (__pyx_t_1469 = 0; __pyx_t_1469 &lt; __pyx_t_1468; __pyx_t_1469+=1) {
              __pyx_v_i = __pyx_t_1469;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+898:                                 pd[ir[j,2], i] += corr</pre>
<pre class='cython code score-0'>              __pyx_t_1470 = __pyx_v_j;
              __pyx_t_1471 = 2;
              if (__pyx_t_1470 &lt; 0) __pyx_t_1470 += __pyx_pybuffernd_ir.diminfo[0].shape;
              if (__pyx_t_1471 &lt; 0) __pyx_t_1471 += __pyx_pybuffernd_ir.diminfo[1].shape;
              __pyx_t_1472 = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_ir.rcbuffer-&gt;pybuffer.buf, __pyx_t_1470, __pyx_pybuffernd_ir.diminfo[0].strides, __pyx_t_1471, __pyx_pybuffernd_ir.diminfo[1].strides));
              __pyx_t_1473 = __pyx_v_i;
              if (__pyx_t_1472 &lt; 0) __pyx_t_1472 += __pyx_pybuffernd_pd.diminfo[0].shape;
              if (__pyx_t_1473 &lt; 0) __pyx_t_1473 += __pyx_pybuffernd_pd.diminfo[1].shape;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_pd.rcbuffer-&gt;pybuffer.buf, __pyx_t_1472, __pyx_pybuffernd_pd.diminfo[0].strides, __pyx_t_1473, __pyx_pybuffernd_pd.diminfo[1].strides) += __pyx_v_corr;
            }
            goto __pyx_L178;
          }
          __pyx_L178:;
          goto __pyx_L175;
        }
        __pyx_L175:;
      }
      __pyx_L120:;
    }
    __pyx_L94:;
  }
</pre><pre class='cython line score-0'>&#xA0;899: </pre>
<pre class='cython line score-55' onclick='toggleDiv(this)'>+900:         self.jacobianMatrix = pd + cj * numpy.identity(numCoreSpecies, numpy.float64)</pre>
<pre class='cython code score-55'>  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cj);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_identity);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_numCoreSpecies);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (__pyx_t_1) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_6, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_6, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  __pyx_t_8 = 0;
  __pyx_t_11 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_v_pd), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_12) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_12, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.jacobianMatrix);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.jacobianMatrix));
  __pyx_v_self-&gt;__pyx_base.jacobianMatrix = ((PyArrayObject *)__pyx_t_12);
  __pyx_t_12 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+901:         return pd</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_pd));
  __pyx_r = ((PyObject *)__pyx_v_pd);
  goto __pyx_L0;
</pre></div></body></html>
