<!DOCTYPE html>
<!-- Generated by Cython 0.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21</p>
<p>Raw output: <a href="reaction.c">reaction.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: # cython: embedsignature=True, cdivision=True</pre>
<pre class='cython code score-11'>  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: </pre>
<pre class='cython line score-0'>&#xA0;003: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;004: #</pre>
<pre class='cython line score-0'>&#xA0;005: #   RMG - Reaction Mechanism Generator</pre>
<pre class='cython line score-0'>&#xA0;006: #</pre>
<pre class='cython line score-0'>&#xA0;007: #   Copyright (c) 2002-2009 Prof. William H. Green (whgreen@mit.edu) and the</pre>
<pre class='cython line score-0'>&#xA0;008: #   RMG Team (rmg_dev@mit.edu)</pre>
<pre class='cython line score-0'>&#xA0;009: #</pre>
<pre class='cython line score-0'>&#xA0;010: #   Permission is hereby granted, free of charge, to any person obtaining a</pre>
<pre class='cython line score-0'>&#xA0;011: #   copy of this software and associated documentation files (the "Software"),</pre>
<pre class='cython line score-0'>&#xA0;012: #   to deal in the Software without restriction, including without limitation</pre>
<pre class='cython line score-0'>&#xA0;013: #   the rights to use, copy, modify, merge, publish, distribute, sublicense,</pre>
<pre class='cython line score-0'>&#xA0;014: #   and/or sell copies of the Software, and to permit persons to whom the</pre>
<pre class='cython line score-0'>&#xA0;015: #   Software is furnished to do so, subject to the following conditions:</pre>
<pre class='cython line score-0'>&#xA0;016: #</pre>
<pre class='cython line score-0'>&#xA0;017: #   The above copyright notice and this permission notice shall be included in</pre>
<pre class='cython line score-0'>&#xA0;018: #   all copies or substantial portions of the Software.</pre>
<pre class='cython line score-0'>&#xA0;019: #</pre>
<pre class='cython line score-0'>&#xA0;020: #   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</pre>
<pre class='cython line score-0'>&#xA0;021: #   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</pre>
<pre class='cython line score-0'>&#xA0;022: #   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</pre>
<pre class='cython line score-0'>&#xA0;023: #   THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;024: #   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</pre>
<pre class='cython line score-0'>&#xA0;025: #   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;026: #   DEALINGS IN THE SOFTWARE.</pre>
<pre class='cython line score-0'>&#xA0;027: #</pre>
<pre class='cython line score-0'>&#xA0;028: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;029: </pre>
<pre class='cython line score-0'>&#xA0;030: """</pre>
<pre class='cython line score-0'>&#xA0;031: This module contains functions for computing the microcanonical rate</pre>
<pre class='cython line score-0'>&#xA0;032: coefficient :math:`k(E)` using RRKM theory (the microcanonical analogue of</pre>
<pre class='cython line score-0'>&#xA0;033: TST) and the inverse Laplace transform method. The former is more accurate,</pre>
<pre class='cython line score-0'>&#xA0;034: but requires detailed information about the transition state and reactants.</pre>
<pre class='cython line score-0'>&#xA0;035: """</pre>
<pre class='cython line score-0'>&#xA0;036: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+037: import logging</pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_logging, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logging, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+038: import numpy</pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;039: cimport numpy</pre>
<pre class='cython line score-0'>&#xA0;040: cimport cython</pre>
<pre class='cython line score-0'>&#xA0;041: from libc.math cimport abs, exp, sqrt, cosh, log</pre>
<pre class='cython line score-0'>&#xA0;042: </pre>
<pre class='cython line score-0'>&#xA0;043: cimport rmgpy.constants as constants</pre>
<pre class='cython line score-0'>&#xA0;044: from rmgpy.kinetics.arrhenius cimport Arrhenius</pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+045: from rmgpy.statmech.schrodinger import convolve</pre>
<pre class='cython code score-19'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_convolve);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_convolve);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_convolve);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_statmech_schrodinger, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_convolve);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convolve, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;046: </pre>
<pre class='cython line score-0'>&#xA0;047: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;048: </pre>
<pre class='cython line score-0'>&#xA0;049: @cython.boundscheck(False)</pre>
<pre class='cython line score-0'>&#xA0;050: @cython.wraparound(False)</pre>
<pre class='cython line score-62' onclick='toggleDiv(this)'>+051: def calculateMicrocanonicalRateCoefficient(reaction,</pre>
<pre class='cython code score-62'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_1calculateMicrocanonicalRateCoefficient(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_8reaction_calculateMicrocanonicalRateCoefficient[] = "calculateMicrocanonicalRateCoefficient(reaction, ndarray Elist, ndarray Jlist, ndarray reacDensStates, ndarray prodDensStates=None, double T=0.0)\n\n    Calculate the microcanonical rate coefficient :math:`k(E)` for the reaction\n    `reaction` at the energies `Elist` in J/mol. `reacDensStates` and \n    `prodDensStates` are the densities of states of the reactant and product\n    configurations for this reaction. If the reaction is irreversible, only the\n    reactant density of states is required; if the reaction is reversible, then\n    both are required. This function will try to use the best method that it\n    can based on the input data available:\n    \n    * If detailed information has been provided for the transition state (i.e.\n      the molecular degrees of freedom), then RRKM theory will be used.\n    \n    * If the above is not possible but high-pressure limit kinetics\n      :math:`k_\\infty(T)` have been provided, then the inverse Laplace \n      transform method will be used.\n\n    The density of states for the product `prodDensStates` and the temperature\n    of interest `T` in K can also be provided. For isomerization and association\n    reactions `prodDensStates` is required; for dissociation reactions it is\n    optional. The temperature is used if provided in the detailed balance\n    expression to determine the reverse kinetics, and in certain cases in the\n    inverse Laplace transform method.\n    ";
static PyMethodDef __pyx_mdef_5rmgpy_4pdep_8reaction_1calculateMicrocanonicalRateCoefficient = {"calculateMicrocanonicalRateCoefficient", (PyCFunction)__pyx_pw_5rmgpy_4pdep_8reaction_1calculateMicrocanonicalRateCoefficient, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5rmgpy_4pdep_8reaction_calculateMicrocanonicalRateCoefficient};
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_1calculateMicrocanonicalRateCoefficient(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_reaction = 0;
  PyArrayObject *__pyx_v_Elist = 0;
  PyArrayObject *__pyx_v_Jlist = 0;
  PyArrayObject *__pyx_v_reacDensStates = 0;
  PyArrayObject *__pyx_v_prodDensStates = 0;
  double __pyx_v_T;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculateMicrocanonicalRateCoefficient (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_reaction,&amp;__pyx_n_s_Elist,&amp;__pyx_n_s_Jlist,&amp;__pyx_n_s_reacDensStates,&amp;__pyx_n_s_prodDensStates,&amp;__pyx_n_s_T,0};
    PyObject* values[6] = {0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_8reaction_calculateMicrocanonicalRateCoefficient(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_reaction, PyArrayObject *__pyx_v_Elist, PyArrayObject *__pyx_v_Jlist, PyArrayObject *__pyx_v_reacDensStates, PyArrayObject *__pyx_v_prodDensStates, double __pyx_v_T) {
  int __pyx_v_Ngrains;
  int __pyx_v_NJ;
  int __pyx_v_r;
  int __pyx_v_s;
  PyArrayObject *__pyx_v_kf = 0;
  PyArrayObject *__pyx_v_kr = 0;
  double __pyx_v_C0inv;
  CYTHON_UNUSED PyObject *__pyx_v_modes = 0;
  int __pyx_v_reactantStatesKnown;
  int __pyx_v_productStatesKnown;
  int __pyx_v_forward;
  PyObject *__pyx_v_activeJRotor = NULL;
  int __pyx_v_activeKRotor;
  PyObject *__pyx_v_kinetics = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Elist;
  __Pyx_Buffer __pyx_pybuffer_Elist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Jlist;
  __Pyx_Buffer __pyx_pybuffer_Jlist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kf;
  __Pyx_Buffer __pyx_pybuffer_kf;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_kr;
  __Pyx_Buffer __pyx_pybuffer_kr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_prodDensStates;
  __Pyx_Buffer __pyx_pybuffer_prodDensStates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_reacDensStates;
  __Pyx_Buffer __pyx_pybuffer_reacDensStates;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculateMicrocanonicalRateCoefficient", 0);
  __pyx_pybuffer_kf.pybuffer.buf = NULL;
  __pyx_pybuffer_kf.refcount = 0;
  __pyx_pybuffernd_kf.data = NULL;
  __pyx_pybuffernd_kf.rcbuffer = &amp;__pyx_pybuffer_kf;
  __pyx_pybuffer_kr.pybuffer.buf = NULL;
  __pyx_pybuffer_kr.refcount = 0;
  __pyx_pybuffernd_kr.data = NULL;
  __pyx_pybuffernd_kr.rcbuffer = &amp;__pyx_pybuffer_kr;
  __pyx_pybuffer_Elist.pybuffer.buf = NULL;
  __pyx_pybuffer_Elist.refcount = 0;
  __pyx_pybuffernd_Elist.data = NULL;
  __pyx_pybuffernd_Elist.rcbuffer = &amp;__pyx_pybuffer_Elist;
  __pyx_pybuffer_Jlist.pybuffer.buf = NULL;
  __pyx_pybuffer_Jlist.refcount = 0;
  __pyx_pybuffernd_Jlist.data = NULL;
  __pyx_pybuffernd_Jlist.rcbuffer = &amp;__pyx_pybuffer_Jlist;
  __pyx_pybuffer_reacDensStates.pybuffer.buf = NULL;
  __pyx_pybuffer_reacDensStates.refcount = 0;
  __pyx_pybuffernd_reacDensStates.data = NULL;
  __pyx_pybuffernd_reacDensStates.rcbuffer = &amp;__pyx_pybuffer_reacDensStates;
  __pyx_pybuffer_prodDensStates.pybuffer.buf = NULL;
  __pyx_pybuffer_prodDensStates.refcount = 0;
  __pyx_pybuffernd_prodDensStates.data = NULL;
  __pyx_pybuffernd_prodDensStates.rcbuffer = &amp;__pyx_pybuffer_prodDensStates;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Elist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Elist.diminfo[0].strides = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Elist.diminfo[0].shape = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Jlist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Jlist.diminfo[0].strides = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Jlist.diminfo[0].shape = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_reacDensStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_reacDensStates.diminfo[0].strides = __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_reacDensStates.diminfo[0].shape = __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_reacDensStates.diminfo[1].strides = __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_reacDensStates.diminfo[1].shape = __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_prodDensStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_prodDensStates.diminfo[0].strides = __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_prodDensStates.diminfo[0].shape = __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_prodDensStates.diminfo[1].strides = __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_prodDensStates.diminfo[1].shape = __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.calculateMicrocanonicalRateCoefficient", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_modes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_activeJRotor);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kinetics);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(20, __pyx_n_s_reaction, __pyx_n_s_Elist, __pyx_n_s_Jlist, __pyx_n_s_reacDensStates, __pyx_n_s_prodDensStates, __pyx_n_s_T, __pyx_n_s_Ngrains, __pyx_n_s_NJ, __pyx_n_s_r, __pyx_n_s_s, __pyx_n_s_kf, __pyx_n_s_kr, __pyx_n_s_C0inv, __pyx_n_s_modes, __pyx_n_s_reactantStatesKnown, __pyx_n_s_productStatesKnown, __pyx_n_s_forward, __pyx_n_s_activeJRotor, __pyx_n_s_activeKRotor, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
/* … */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_5rmgpy_4pdep_8reaction_1calculateMicrocanonicalRateCoefficient, NULL, __pyx_n_s_rmgpy_pdep_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculateMicrocanonicalRateCoeff, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 20, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_data1_ajocher_codes_RMG_RMG_par, __pyx_n_s_calculateMicrocanonicalRateCoeff, 51, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;052:     numpy.ndarray[numpy.float64_t,ndim=1] Elist,</pre>
<pre class='cython line score-0'>&#xA0;053:     numpy.ndarray[numpy.int_t,ndim=1] Jlist,</pre>
<pre class='cython line score-0'>&#xA0;054:     numpy.ndarray[numpy.float64_t,ndim=2] reacDensStates,</pre>
<pre class='cython line score-75' onclick='toggleDiv(this)'>+055:     numpy.ndarray[numpy.float64_t,ndim=2] prodDensStates=None,</pre>
<pre class='cython code score-75'>    values[4] = (PyObject *)((PyArrayObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_reaction)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Elist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateMicrocanonicalRateCoefficient", 0, 4, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Jlist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateMicrocanonicalRateCoefficient", 0, 4, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_reacDensStates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateMicrocanonicalRateCoefficient", 0, 4, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_prodDensStates);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calculateMicrocanonicalRateCoefficient") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_reaction = values[0];
    __pyx_v_Elist = ((PyArrayObject *)values[1]);
    __pyx_v_Jlist = ((PyArrayObject *)values[2]);
    __pyx_v_reacDensStates = ((PyArrayObject *)values[3]);
    __pyx_v_prodDensStates = ((PyArrayObject *)values[4]);
    if (values[5]) {
      __pyx_v_T = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_T == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_T = ((double)0.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateMicrocanonicalRateCoefficient", 0, 4, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.calculateMicrocanonicalRateCoefficient", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Elist), __pyx_ptype_5numpy_ndarray, 1, "Elist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Jlist), __pyx_ptype_5numpy_ndarray, 1, "Jlist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_reacDensStates), __pyx_ptype_5numpy_ndarray, 1, "reacDensStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_prodDensStates), __pyx_ptype_5numpy_ndarray, 1, "prodDensStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_4pdep_8reaction_calculateMicrocanonicalRateCoefficient(__pyx_self, __pyx_v_reaction, __pyx_v_Elist, __pyx_v_Jlist, __pyx_v_reacDensStates, __pyx_v_prodDensStates, __pyx_v_T);
</pre><pre class='cython line score-0'>&#xA0;056:     double T=0.0):</pre>
<pre class='cython line score-0'>&#xA0;057:     """</pre>
<pre class='cython line score-0'>&#xA0;058:     Calculate the microcanonical rate coefficient :math:`k(E)` for the reaction</pre>
<pre class='cython line score-0'>&#xA0;059:     `reaction` at the energies `Elist` in J/mol. `reacDensStates` and</pre>
<pre class='cython line score-0'>&#xA0;060:     `prodDensStates` are the densities of states of the reactant and product</pre>
<pre class='cython line score-0'>&#xA0;061:     configurations for this reaction. If the reaction is irreversible, only the</pre>
<pre class='cython line score-0'>&#xA0;062:     reactant density of states is required; if the reaction is reversible, then</pre>
<pre class='cython line score-0'>&#xA0;063:     both are required. This function will try to use the best method that it</pre>
<pre class='cython line score-0'>&#xA0;064:     can based on the input data available:</pre>
<pre class='cython line score-0'>&#xA0;065: </pre>
<pre class='cython line score-0'>&#xA0;066:     * If detailed information has been provided for the transition state (i.e.</pre>
<pre class='cython line score-0'>&#xA0;067:       the molecular degrees of freedom), then RRKM theory will be used.</pre>
<pre class='cython line score-0'>&#xA0;068: </pre>
<pre class='cython line score-0'>&#xA0;069:     * If the above is not possible but high-pressure limit kinetics</pre>
<pre class='cython line score-0'>&#xA0;070:       :math:`k_\\infty(T)` have been provided, then the inverse Laplace</pre>
<pre class='cython line score-0'>&#xA0;071:       transform method will be used.</pre>
<pre class='cython line score-0'>&#xA0;072: </pre>
<pre class='cython line score-0'>&#xA0;073:     The density of states for the product `prodDensStates` and the temperature</pre>
<pre class='cython line score-0'>&#xA0;074:     of interest `T` in K can also be provided. For isomerization and association</pre>
<pre class='cython line score-0'>&#xA0;075:     reactions `prodDensStates` is required; for dissociation reactions it is</pre>
<pre class='cython line score-0'>&#xA0;076:     optional. The temperature is used if provided in the detailed balance</pre>
<pre class='cython line score-0'>&#xA0;077:     expression to determine the reverse kinetics, and in certain cases in the</pre>
<pre class='cython line score-0'>&#xA0;078:     inverse Laplace transform method.</pre>
<pre class='cython line score-0'>&#xA0;079:     """</pre>
<pre class='cython line score-0'>&#xA0;080:     cdef int Ngrains, NJ, r, s</pre>
<pre class='cython line score-0'>&#xA0;081:     cdef numpy.ndarray[numpy.float64_t,ndim=2] kf, kr</pre>
<pre class='cython line score-0'>&#xA0;082:     cdef double C0inv</pre>
<pre class='cython line score-0'>&#xA0;083:     cdef list modes</pre>
<pre class='cython line score-0'>&#xA0;084:     cdef bint reactantStatesKnown, productStatesKnown, forward</pre>
<pre class='cython line score-0'>&#xA0;085: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+086:     Ngrains = Elist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_Ngrains = (__pyx_v_Elist-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+087:     NJ = Jlist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_NJ = (__pyx_v_Jlist-&gt;dimensions[0]);
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+088:     kf = numpy.zeros((Ngrains,NJ))</pre>
<pre class='cython code score-60'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_NJ);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
    }
    __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_kf = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+089:     kr = numpy.zeros_like(kf)</pre>
<pre class='cython code score-49'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_kf));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kf));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_kf));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kf));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
    }
    __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_kr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+090:     activeJRotor = Jlist is None</pre>
<pre class='cython code score-2'>  __pyx_t_11 = (((PyObject *)__pyx_v_Jlist) == Py_None);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_activeJRotor = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+091:     activeKRotor = False</pre>
<pre class='cython code score-0'>  __pyx_v_activeKRotor = 0;
</pre><pre class='cython line score-0'>&#xA0;092: </pre>
<pre class='cython line score-21' onclick='toggleDiv(this)'>+093:     reactantStatesKnown = reacDensStates is not None and reacDensStates.any()</pre>
<pre class='cython code score-21'>  __pyx_t_12 = (((PyObject *)__pyx_v_reacDensStates) != Py_None);
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
    goto __pyx_L4_next_and;
  } else {
    __pyx_t_11 = __pyx_t_13;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_L4_next_and:;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_reacDensStates), __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_13 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = __pyx_t_13;
  __pyx_L3_bool_binop_done:;
  __pyx_v_reactantStatesKnown = __pyx_t_11;
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+094:     productStatesKnown = prodDensStates is not None and prodDensStates.any()</pre>
<pre class='cython code score-21'>  __pyx_t_13 = (((PyObject *)__pyx_v_prodDensStates) != Py_None);
  __pyx_t_12 = (__pyx_t_13 != 0);
  if (__pyx_t_12) {
    goto __pyx_L6_next_and;
  } else {
    __pyx_t_11 = __pyx_t_12;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_L6_next_and:;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_prodDensStates), __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = __pyx_t_12;
  __pyx_L5_bool_binop_done:;
  __pyx_v_productStatesKnown = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+095:     forward = True</pre>
<pre class='cython code score-0'>  __pyx_v_forward = 1;
</pre><pre class='cython line score-0'>&#xA0;096: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+097:     C0inv = constants.R * T / 1e5</pre>
<pre class='cython code score-0'>  __pyx_v_C0inv = ((__pyx_v_5rmgpy_9constants_R * __pyx_v_T) / 1e5);
</pre><pre class='cython line score-0'>&#xA0;098: </pre>
<pre class='cython line score-21' onclick='toggleDiv(this)'>+099:     if reaction.canTST():</pre>
<pre class='cython code score-21'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_canTST);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_11 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_11) {
</pre><pre class='cython line score-0'>&#xA0;100: </pre>
<pre class='cython line score-40' onclick='toggleDiv(this)'>+101:         modes = reaction.transitionState.conformer.getActiveModes(activeJRotor=activeJRotor, activeKRotor=activeKRotor)</pre>
<pre class='cython code score-40'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_conformer);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_getActiveModes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_activeJRotor, __pyx_v_activeJRotor) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_activeKRotor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_activeKRotor, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_modes = ((PyObject*)__pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;102: </pre>
<pre class='cython line score-0'>&#xA0;103:         # We've been provided with molecular degree of freedom data for the</pre>
<pre class='cython line score-0'>&#xA0;104:         # transition state, so let's use the more accurate RRKM theory</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+105:         logging.debug('Calculating microcanonical rate coefficient using RRKM theory for {0}...'.format(reaction))</pre>
<pre class='cython code score-56'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Calculating_microcanonical_rate, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_v_reaction);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+106:         if reactantStatesKnown and (reaction.isIsomerization() or reaction.isDissociation()):</pre>
<pre class='cython code score-42'>    __pyx_t_12 = (__pyx_v_reactantStatesKnown != 0);
    if (__pyx_t_12) {
      goto __pyx_L10_next_and;
    } else {
      __pyx_t_11 = __pyx_t_12;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_L10_next_and:;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_isIsomerization);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_14 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (__pyx_t_14) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (!__pyx_t_12) {
      goto __pyx_L11_next_or;
    } else {
      __pyx_t_11 = __pyx_t_12;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_L11_next_or:;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_isDissociation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_14 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (__pyx_t_14) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_11 = __pyx_t_12;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_11) {
</pre><pre class='cython line score-52' onclick='toggleDiv(this)'>+107:             kf = applyRRKMTheory(reaction.transitionState, Elist, Jlist, reacDensStates)</pre>
<pre class='cython code score-52'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_applyRRKMTheory);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_2 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_2) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_15, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_15, ((PyObject *)__pyx_v_Elist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_15, ((PyObject *)__pyx_v_Jlist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_reacDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3+__pyx_t_15, ((PyObject *)__pyx_v_reacDensStates));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_reacDensStates));
      __pyx_t_14 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
          }
        }
        __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kf, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+108:             kf *= C0inv**(len(reaction.reactants) - 1)</pre>
<pre class='cython code score-40'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(pow(__pyx_v_C0inv, ((double)(__pyx_t_15 - 1))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_kf), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
          }
        }
        __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kf, ((PyArrayObject *)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+109:             forward = True</pre>
<pre class='cython code score-0'>      __pyx_v_forward = 1;
      goto __pyx_L8;
    }
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+110:         elif productStatesKnown and reaction.isAssociation():</pre>
<pre class='cython code score-21'>    __pyx_t_12 = (__pyx_v_productStatesKnown != 0);
    if (__pyx_t_12) {
      goto __pyx_L13_next_and;
    } else {
      __pyx_t_11 = __pyx_t_12;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_L13_next_and:;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_isAssociation);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = __pyx_t_12;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_11) {
</pre><pre class='cython line score-52' onclick='toggleDiv(this)'>+111:             kr = applyRRKMTheory(reaction.transitionState, Elist, Jlist, prodDensStates)</pre>
<pre class='cython code score-52'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_applyRRKMTheory);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (__pyx_t_14) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_15, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_15, ((PyObject *)__pyx_v_Elist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_15, ((PyObject *)__pyx_v_Jlist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_prodDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3+__pyx_t_15, ((PyObject *)__pyx_v_prodDensStates));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_prodDensStates));
      __pyx_t_3 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
          }
        }
        __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kr, ((PyArrayObject *)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+112:             kr *= C0inv**(len(reaction.products) - 1)</pre>
<pre class='cython code score-40'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_products);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(pow(__pyx_v_C0inv, ((double)(__pyx_t_15 - 1))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_kr), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
          }
        }
        __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kr, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+113:             forward = False</pre>
<pre class='cython code score-0'>      __pyx_v_forward = 0;
      goto __pyx_L8;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;114:         else:</pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+115:             raise Exception('Unable to compute k(E) values via RRKM theory for path reaction "{0}".'.format(reaction))</pre>
<pre class='cython code score-38'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unable_to_compute_k_E_values_via, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_reaction);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_Exception, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_L8:;
    goto __pyx_L7;
  }
</pre><pre class='cython line score-0'>&#xA0;116: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+117:     elif reaction.kinetics is not None:</pre>
<pre class='cython code score-3'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_11 = (__pyx_t_5 != Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = (__pyx_t_11 != 0);
  if (__pyx_t_12) {
</pre><pre class='cython line score-0'>&#xA0;118:         # We've been provided with high-pressure-limit rate coefficient data,</pre>
<pre class='cython line score-0'>&#xA0;119:         # so let's use the less accurate inverse Laplace transform method</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+120:         logging.debug('Calculating microcanonical rate coefficient using ILT method for {0}...'.format(reaction))</pre>
<pre class='cython code score-56'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Calculating_microcanonical_rate_2, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_14 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_14) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_reaction);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+121:         if reactantStatesKnown:</pre>
<pre class='cython code score-0'>    __pyx_t_12 = (__pyx_v_reactantStatesKnown != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+122:             kinetics = reaction.kinetics</pre>
<pre class='cython code score-2'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_kinetics);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_v_kinetics = __pyx_t_5;
      __pyx_t_5 = 0;
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+123:             kf = applyInverseLaplaceTransformMethod(reaction.transitionState, kinetics, Elist, Jlist, reacDensStates, T)</pre>
<pre class='cython code score-60'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_applyInverseLaplaceTransformMeth);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (__pyx_t_2) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_15, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kinetics);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_15, __pyx_v_kinetics);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kinetics);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_15, ((PyObject *)__pyx_v_Elist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 3+__pyx_t_15, ((PyObject *)__pyx_v_Jlist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_reacDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 4+__pyx_t_15, ((PyObject *)__pyx_v_reacDensStates));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_reacDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 5+__pyx_t_15, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_4 = 0;
      __pyx_t_1 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
          }
        }
        __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kf, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+124:             forward = True</pre>
<pre class='cython code score-0'>      __pyx_v_forward = 1;
      goto __pyx_L14;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+125:         elif productStatesKnown:</pre>
<pre class='cython code score-0'>    __pyx_t_12 = (__pyx_v_productStatesKnown != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-18' onclick='toggleDiv(this)'>+126:             kinetics = reaction.generateReverseRateCoefficient()</pre>
<pre class='cython code score-18'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_generateReverseRateCoefficient);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_kinetics = __pyx_t_5;
      __pyx_t_5 = 0;
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+127:             kr = applyInverseLaplaceTransformMethod(reaction.transitionState, kinetics, Elist, Jlist, prodDensStates, T)</pre>
<pre class='cython code score-60'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_applyInverseLaplaceTransformMeth);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (__pyx_t_4) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_15, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kinetics);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_15, __pyx_v_kinetics);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kinetics);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_15, ((PyObject *)__pyx_v_Elist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Elist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3+__pyx_t_15, ((PyObject *)__pyx_v_Jlist));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Jlist));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_prodDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4+__pyx_t_15, ((PyObject *)__pyx_v_prodDensStates));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_prodDensStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5+__pyx_t_15, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_14 = 0;
      __pyx_t_1 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
          }
        }
        __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kr, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+128:             forward = False</pre>
<pre class='cython code score-0'>      __pyx_v_forward = 0;
      goto __pyx_L14;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;129:         else:</pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+130:             raise Exception('Unable to compute k(E) values via ILT method for path reaction "{0}".'.format(reaction))</pre>
<pre class='cython code score-38'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unable_to_compute_k_E_values_via_2, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_reaction);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_Exception, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_L14:;
    goto __pyx_L7;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;131: </pre>
<pre class='cython line score-0'>&#xA0;132:     else:</pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+133:         raise Exception('Unable to compute k(E) values for path reaction "{0}".'.format(reaction))</pre>
<pre class='cython code score-38'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unable_to_compute_k_E_values_for, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_reaction);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_Exception, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;134: </pre>
<pre class='cython line score-0'>&#xA0;135:     # If the reaction is endothermic and barrierless, it is possible that the</pre>
<pre class='cython line score-0'>&#xA0;136:     # forward k(E) will have a nonzero value at an energy where the product</pre>
<pre class='cython line score-0'>&#xA0;137:     # density of states is zero (but the reactant density of states is not),</pre>
<pre class='cython line score-0'>&#xA0;138:     # which violates detailed balance</pre>
<pre class='cython line score-0'>&#xA0;139:     # To fix, we set the forward k(E) to zero wherever this is true</pre>
<pre class='cython line score-0'>&#xA0;140:     # (This is correct within the accuracy of discretizing the energy grains)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+141:     if reactantStatesKnown and productStatesKnown:</pre>
<pre class='cython code score-0'>  __pyx_t_11 = (__pyx_v_reactantStatesKnown != 0);
  if (__pyx_t_11) {
    goto __pyx_L17_next_and;
  } else {
    __pyx_t_12 = __pyx_t_11;
    goto __pyx_L16_bool_binop_done;
  }
  __pyx_L17_next_and:;
  __pyx_t_11 = (__pyx_v_productStatesKnown != 0);
  __pyx_t_12 = __pyx_t_11;
  __pyx_L16_bool_binop_done:;
  if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+142:         for r in range(Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_Ngrains;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_7; __pyx_t_16+=1) {
      __pyx_v_r = __pyx_t_16;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+143:             for s in range(NJ):</pre>
<pre class='cython code score-0'>      __pyx_t_17 = __pyx_v_NJ;
      for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_s = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+144:                 if reacDensStates[r,s] != 0 and prodDensStates[r,s] != 0:</pre>
<pre class='cython code score-0'>        __pyx_t_19 = __pyx_v_r;
        __pyx_t_20 = __pyx_v_s;
        __pyx_t_11 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_reacDensStates.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_reacDensStates.diminfo[1].strides)) != 0.0) != 0);
        if (__pyx_t_11) {
          goto __pyx_L24_next_and;
        } else {
          __pyx_t_12 = __pyx_t_11;
          goto __pyx_L23_bool_binop_done;
        }
        __pyx_L24_next_and:;
        __pyx_t_21 = __pyx_v_r;
        __pyx_t_22 = __pyx_v_s;
        __pyx_t_11 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_prodDensStates.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_prodDensStates.diminfo[1].strides)) != 0.0) != 0);
        __pyx_t_12 = __pyx_t_11;
        __pyx_L23_bool_binop_done:;
        if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+145:                     break</pre>
<pre class='cython code score-0'>          goto __pyx_L21_break;
        }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+146:                 kf[r,s] = 0</pre>
<pre class='cython code score-0'>        __pyx_t_23 = __pyx_v_r;
        __pyx_t_24 = __pyx_v_s;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_kf.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_kf.diminfo[1].strides) = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+147:                 kr[r,s] = 0</pre>
<pre class='cython code score-0'>        __pyx_t_25 = __pyx_v_r;
        __pyx_t_26 = __pyx_v_s;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_kr.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_kr.diminfo[1].strides) = 0.0;
      }
      __pyx_L21_break:;
    }
    goto __pyx_L15;
  }
  __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;148: </pre>
<pre class='cython line score-0'>&#xA0;149:     # Get the reverse microcanonical rate coefficient if possible</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+150:     if forward and productStatesKnown:</pre>
<pre class='cython code score-0'>  __pyx_t_11 = (__pyx_v_forward != 0);
  if (__pyx_t_11) {
    goto __pyx_L27_next_and;
  } else {
    __pyx_t_12 = __pyx_t_11;
    goto __pyx_L26_bool_binop_done;
  }
  __pyx_L27_next_and:;
  __pyx_t_11 = (__pyx_v_productStatesKnown != 0);
  __pyx_t_12 = __pyx_t_11;
  __pyx_L26_bool_binop_done:;
  if (__pyx_t_12) {
</pre><pre class='cython line score-0'>&#xA0;151:         # We computed the forward rate coefficient above</pre>
<pre class='cython line score-0'>&#xA0;152:         # Thus we need to compute the reverse rate coefficient here</pre>
<pre class='cython line score-50' onclick='toggleDiv(this)'>+153:         kr = numpy.zeros_like(kf)</pre>
<pre class='cython code score-50'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_kf));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kf));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, ((PyObject *)__pyx_v_kf));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kf));
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_7 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
        }
      }
      __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kr, ((PyArrayObject *)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+154:         for s in range(NJ):</pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_NJ;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_7; __pyx_t_16+=1) {
      __pyx_v_s = __pyx_t_16;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+155:             for r in range(Ngrains):</pre>
<pre class='cython code score-0'>      __pyx_t_17 = __pyx_v_Ngrains;
      for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_r = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+156:                 if prodDensStates[r,s] != 0:</pre>
<pre class='cython code score-0'>        __pyx_t_27 = __pyx_v_r;
        __pyx_t_28 = __pyx_v_s;
        __pyx_t_12 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_prodDensStates.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_prodDensStates.diminfo[1].strides)) != 0.0) != 0);
        if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+157:                     kr[r,s] = kf[r,s] * reacDensStates[r,s] / prodDensStates[r,s]</pre>
<pre class='cython code score-0'>          __pyx_t_29 = __pyx_v_r;
          __pyx_t_30 = __pyx_v_s;
          __pyx_t_31 = __pyx_v_r;
          __pyx_t_32 = __pyx_v_s;
          __pyx_t_33 = __pyx_v_r;
          __pyx_t_34 = __pyx_v_s;
          __pyx_t_35 = __pyx_v_r;
          __pyx_t_36 = __pyx_v_s;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_kr.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_kr.diminfo[1].strides) = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_kf.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_kf.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_reacDensStates.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_reacDensStates.diminfo[1].strides))) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_prodDensStates.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_prodDensStates.diminfo[1].strides)));
          goto __pyx_L32;
        }
        __pyx_L32:;
      }
    }
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+158:         kr *= C0inv**(len(reaction.products) - len(reaction.reactants))</pre>
<pre class='cython code score-48'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_products);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_37 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_37 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(pow(__pyx_v_C0inv, ((double)(__pyx_t_15 - __pyx_t_37))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_kr), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = ((PyArrayObject *)__pyx_t_2);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_7 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
        }
      }
      __pyx_pybuffernd_kr.diminfo[0].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kr.diminfo[0].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kr.diminfo[1].strides = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kr.diminfo[1].shape = __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kr, ((PyArrayObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    goto __pyx_L25;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+159:     elif not forward and reactantStatesKnown:</pre>
<pre class='cython code score-0'>  __pyx_t_11 = ((!(__pyx_v_forward != 0)) != 0);
  if (__pyx_t_11) {
    goto __pyx_L34_next_and;
  } else {
    __pyx_t_12 = __pyx_t_11;
    goto __pyx_L33_bool_binop_done;
  }
  __pyx_L34_next_and:;
  __pyx_t_11 = (__pyx_v_reactantStatesKnown != 0);
  __pyx_t_12 = __pyx_t_11;
  __pyx_L33_bool_binop_done:;
  if (__pyx_t_12) {
</pre><pre class='cython line score-0'>&#xA0;160:         # We computed the reverse rate coefficient above</pre>
<pre class='cython line score-0'>&#xA0;161:         # Thus we need to compute the forward rate coefficient here</pre>
<pre class='cython line score-50' onclick='toggleDiv(this)'>+162:         kf = numpy.zeros_like(kr)</pre>
<pre class='cython code score-50'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, ((PyObject *)__pyx_v_kr));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kr));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, ((PyObject *)__pyx_v_kr));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kr));
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = ((PyArrayObject *)__pyx_t_2);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_7 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
        }
      }
      __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kf, ((PyArrayObject *)__pyx_t_2));
    __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+163:         for s in range(NJ):</pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_NJ;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_7; __pyx_t_16+=1) {
      __pyx_v_s = __pyx_t_16;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+164:             for r in range(Ngrains):</pre>
<pre class='cython code score-0'>      __pyx_t_17 = __pyx_v_Ngrains;
      for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_r = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+165:                 if reacDensStates[r,s] != 0:</pre>
<pre class='cython code score-0'>        __pyx_t_38 = __pyx_v_r;
        __pyx_t_39 = __pyx_v_s;
        __pyx_t_12 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_reacDensStates.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_reacDensStates.diminfo[1].strides)) != 0.0) != 0);
        if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+166:                     kf[r,s] = kr[r,s] * prodDensStates[r,s] / reacDensStates[r,s]</pre>
<pre class='cython code score-0'>          __pyx_t_40 = __pyx_v_r;
          __pyx_t_41 = __pyx_v_s;
          __pyx_t_42 = __pyx_v_r;
          __pyx_t_43 = __pyx_v_s;
          __pyx_t_44 = __pyx_v_r;
          __pyx_t_45 = __pyx_v_s;
          __pyx_t_46 = __pyx_v_r;
          __pyx_t_47 = __pyx_v_s;
          *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_kf.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_kf.diminfo[1].strides) = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_kr.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_kr.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_kr.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_prodDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_prodDensStates.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_prodDensStates.diminfo[1].strides))) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_reacDensStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_reacDensStates.diminfo[0].strides, __pyx_t_45, __pyx_pybuffernd_reacDensStates.diminfo[1].strides)));
          goto __pyx_L39;
        }
        __pyx_L39:;
      }
    }
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+167:         kf *= C0inv**(len(reaction.reactants) - len(reaction.products))</pre>
<pre class='cython code score-48'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_37 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_37 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_products);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(pow(__pyx_v_C0inv, ((double)(__pyx_t_37 - __pyx_t_15))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_kf), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_7 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_kf, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
        }
      }
      __pyx_pybuffernd_kf.diminfo[0].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_kf.diminfo[0].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_kf.diminfo[1].strides = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_kf.diminfo[1].shape = __pyx_pybuffernd_kf.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kf, ((PyArrayObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    goto __pyx_L25;
  }
  __pyx_L25:;
</pre><pre class='cython line score-0'>&#xA0;168: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+169:     return kf, kr</pre>
<pre class='cython code score-10'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kf));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_kf));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kf));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_kr));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_kr));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_kr));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;170: </pre>
<pre class='cython line score-0'>&#xA0;171: @cython.boundscheck(False)</pre>
<pre class='cython line score-0'>&#xA0;172: @cython.wraparound(False)</pre>
<pre class='cython line score-115' onclick='toggleDiv(this)'>+173: def applyRRKMTheory(transitionState,</pre>
<pre class='cython code score-115'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_3applyRRKMTheory(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_8reaction_2applyRRKMTheory[] = "applyRRKMTheory(transitionState, ndarray Elist, ndarray Jlist, ndarray densStates)\n\n    Calculate the microcanonical rate coefficient for a reaction using RRKM\n    theory, where `transitionState` is the transition state of the reaction,\n    `Elist` is the array of energies in J/mol at which to evaluate the\n    microcanonial rate, and `densStates` is the density of states of the\n    reactant.\n    ";
static PyMethodDef __pyx_mdef_5rmgpy_4pdep_8reaction_3applyRRKMTheory = {"applyRRKMTheory", (PyCFunction)__pyx_pw_5rmgpy_4pdep_8reaction_3applyRRKMTheory, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5rmgpy_4pdep_8reaction_2applyRRKMTheory};
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_3applyRRKMTheory(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_transitionState = 0;
  PyArrayObject *__pyx_v_Elist = 0;
  PyArrayObject *__pyx_v_Jlist = 0;
  PyArrayObject *__pyx_v_densStates = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("applyRRKMTheory (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_transitionState,&amp;__pyx_n_s_Elist,&amp;__pyx_n_s_Jlist,&amp;__pyx_n_s_densStates,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_transitionState)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Elist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyRRKMTheory", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Jlist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyRRKMTheory", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_densStates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyRRKMTheory", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "applyRRKMTheory") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_transitionState = values[0];
    __pyx_v_Elist = ((PyArrayObject *)values[1]);
    __pyx_v_Jlist = ((PyArrayObject *)values[2]);
    __pyx_v_densStates = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyRRKMTheory", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.applyRRKMTheory", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Elist), __pyx_ptype_5numpy_ndarray, 1, "Elist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Jlist), __pyx_ptype_5numpy_ndarray, 1, "Jlist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_densStates), __pyx_ptype_5numpy_ndarray, 1, "densStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_4pdep_8reaction_2applyRRKMTheory(__pyx_self, __pyx_v_transitionState, __pyx_v_Elist, __pyx_v_Jlist, __pyx_v_densStates);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_8reaction_2applyRRKMTheory(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_transitionState, PyArrayObject *__pyx_v_Elist, PyArrayObject *__pyx_v_Jlist, PyArrayObject *__pyx_v_densStates) {
  PyArrayObject *__pyx_v_k0 = 0;
  PyArrayObject *__pyx_v_k = 0;
  PyArrayObject *__pyx_v_sumStates = 0;
  int __pyx_v_Ngrains;
  int __pyx_v_NJ;
  int __pyx_v_activeJRotor;
  double __pyx_v_dE;
  double __pyx_v_E0_TS;
  int __pyx_v_r;
  int __pyx_v_s;
  PyObject *__pyx_v_Configuration = NULL;
  PyObject *__pyx_v_conf = NULL;
  PyObject *__pyx_v_kappa = NULL;
  PyObject *__pyx_v_E0 = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Elist;
  __Pyx_Buffer __pyx_pybuffer_Elist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Jlist;
  __Pyx_Buffer __pyx_pybuffer_Jlist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_densStates;
  __Pyx_Buffer __pyx_pybuffer_densStates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_k;
  __Pyx_Buffer __pyx_pybuffer_k;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_k0;
  __Pyx_Buffer __pyx_pybuffer_k0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sumStates;
  __Pyx_Buffer __pyx_pybuffer_sumStates;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("applyRRKMTheory", 0);
  __pyx_pybuffer_k0.pybuffer.buf = NULL;
  __pyx_pybuffer_k0.refcount = 0;
  __pyx_pybuffernd_k0.data = NULL;
  __pyx_pybuffernd_k0.rcbuffer = &amp;__pyx_pybuffer_k0;
  __pyx_pybuffer_k.pybuffer.buf = NULL;
  __pyx_pybuffer_k.refcount = 0;
  __pyx_pybuffernd_k.data = NULL;
  __pyx_pybuffernd_k.rcbuffer = &amp;__pyx_pybuffer_k;
  __pyx_pybuffer_sumStates.pybuffer.buf = NULL;
  __pyx_pybuffer_sumStates.refcount = 0;
  __pyx_pybuffernd_sumStates.data = NULL;
  __pyx_pybuffernd_sumStates.rcbuffer = &amp;__pyx_pybuffer_sumStates;
  __pyx_pybuffer_Elist.pybuffer.buf = NULL;
  __pyx_pybuffer_Elist.refcount = 0;
  __pyx_pybuffernd_Elist.data = NULL;
  __pyx_pybuffernd_Elist.rcbuffer = &amp;__pyx_pybuffer_Elist;
  __pyx_pybuffer_Jlist.pybuffer.buf = NULL;
  __pyx_pybuffer_Jlist.refcount = 0;
  __pyx_pybuffernd_Jlist.data = NULL;
  __pyx_pybuffernd_Jlist.rcbuffer = &amp;__pyx_pybuffer_Jlist;
  __pyx_pybuffer_densStates.pybuffer.buf = NULL;
  __pyx_pybuffer_densStates.refcount = 0;
  __pyx_pybuffernd_densStates.data = NULL;
  __pyx_pybuffernd_densStates.rcbuffer = &amp;__pyx_pybuffer_densStates;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Elist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Elist.diminfo[0].strides = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Elist.diminfo[0].shape = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Jlist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Jlist.diminfo[0].strides = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Jlist.diminfo[0].shape = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_densStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_densStates.diminfo[0].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_densStates.diminfo[0].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_densStates.diminfo[1].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_densStates.diminfo[1].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.applyRRKMTheory", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_k0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sumStates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Configuration);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_conf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kappa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_E0);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_transitionState, __pyx_n_s_Elist, __pyx_n_s_Jlist, __pyx_n_s_densStates, __pyx_n_s_k0, __pyx_n_s_k, __pyx_n_s_sumStates, __pyx_n_s_Ngrains, __pyx_n_s_NJ, __pyx_n_s_activeJRotor, __pyx_n_s_dE, __pyx_n_s_E0_TS, __pyx_n_s_r, __pyx_n_s_s, __pyx_n_s_Configuration, __pyx_n_s_conf, __pyx_n_s_kappa, __pyx_n_s_E0);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
/* … */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_5rmgpy_4pdep_8reaction_3applyRRKMTheory, NULL, __pyx_n_s_rmgpy_pdep_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_applyRRKMTheory, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__13 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 18, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__12, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_data1_ajocher_codes_RMG_RMG_par, __pyx_n_s_applyRRKMTheory, 173, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;174:                     numpy.ndarray[numpy.float64_t,ndim=1] Elist,</pre>
<pre class='cython line score-0'>&#xA0;175:                     numpy.ndarray[numpy.int_t,ndim=1] Jlist,</pre>
<pre class='cython line score-0'>&#xA0;176:                     numpy.ndarray[numpy.float64_t,ndim=2] densStates):</pre>
<pre class='cython line score-0'>&#xA0;177:     """</pre>
<pre class='cython line score-0'>&#xA0;178:     Calculate the microcanonical rate coefficient for a reaction using RRKM</pre>
<pre class='cython line score-0'>&#xA0;179:     theory, where `transitionState` is the transition state of the reaction,</pre>
<pre class='cython line score-0'>&#xA0;180:     `Elist` is the array of energies in J/mol at which to evaluate the</pre>
<pre class='cython line score-0'>&#xA0;181:     microcanonial rate, and `densStates` is the density of states of the</pre>
<pre class='cython line score-0'>&#xA0;182:     reactant.</pre>
<pre class='cython line score-0'>&#xA0;183:     """</pre>
<pre class='cython line score-0'>&#xA0;184:     cdef numpy.ndarray[numpy.float64_t,ndim=2] k0, k, sumStates</pre>
<pre class='cython line score-0'>&#xA0;185:     cdef int Ngrains, NJ</pre>
<pre class='cython line score-0'>&#xA0;186:     cdef bint activeJRotor</pre>
<pre class='cython line score-0'>&#xA0;187:     cdef double dE, E0_TS</pre>
<pre class='cython line score-0'>&#xA0;188:     cdef int r, s</pre>
<pre class='cython line score-0'>&#xA0;189: </pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+190:     from rmgpy.pdep import Configuration</pre>
<pre class='cython code score-15'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Configuration);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Configuration);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Configuration);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_pdep, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Configuration);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_Configuration = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;191: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+192:     Ngrains = Elist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_Ngrains = (__pyx_v_Elist-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+193:     NJ = Jlist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_NJ = (__pyx_v_Jlist-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+194:     activeJRotor = (NJ == 1)</pre>
<pre class='cython code score-0'>  __pyx_v_activeJRotor = (__pyx_v_NJ == 1);
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+195:     k0 = numpy.zeros((Ngrains,NJ))</pre>
<pre class='cython code score-60'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_NJ);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_k0, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
    }
    __pyx_pybuffernd_k0.diminfo[0].strides = __pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_k0.diminfo[0].shape = __pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_k0.diminfo[1].strides = __pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_k0.diminfo[1].shape = __pyx_pybuffernd_k0.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_k0 = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+196:     k = numpy.zeros_like(k0)</pre>
<pre class='cython code score-49'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, ((PyObject *)__pyx_v_k0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_k0));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_k0));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_k0));
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_k, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
    }
    __pyx_pybuffernd_k.diminfo[0].strides = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_k.diminfo[0].shape = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_k.diminfo[1].strides = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_k.diminfo[1].shape = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_k = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+197:     dE = Elist[1] - Elist[0]</pre>
<pre class='cython code score-0'>  __pyx_t_11 = 1;
  __pyx_t_12 = 0;
  __pyx_v_dE = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Elist.diminfo[0].strides)));
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+198:     E0_TS = transitionState.conformer.E0.value_si</pre>
<pre class='cython code score-14'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_transitionState, __pyx_n_s_conformer);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_E0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_value_si);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_E0_TS = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;199: </pre>
<pre class='cython line score-25' onclick='toggleDiv(this)'>+200:     conf = Configuration(transitionState)</pre>
<pre class='cython code score-25'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Configuration);
  __pyx_t_1 = __pyx_v_Configuration; __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_transitionState);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transitionState);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_transitionState);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_transitionState);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_conf = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='cython line score-38' onclick='toggleDiv(this)'>+201:     conf.calculateDensityOfStates(Elist - Elist[0], activeJRotor=activeJRotor)</pre>
<pre class='cython code score-38'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_calculateDensityOfStates);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_14 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Elist.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_Elist), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_activeJRotor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_activeJRotor, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;202: </pre>
<pre class='cython line score-0'>&#xA0;203:     # Compute tunneling function</pre>
<pre class='cython line score-26' onclick='toggleDiv(this)'>+204:     kappa = transitionState.calculateTunnelingFunction(Elist)</pre>
<pre class='cython code score-26'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_transitionState, __pyx_n_s_calculateTunnelingFunction);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_Elist));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Elist));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, ((PyObject *)__pyx_v_Elist));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Elist));
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_kappa = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;205: </pre>
<pre class='cython line score-0'>&#xA0;206:     # Convolve with transition state density of states to get new transition</pre>
<pre class='cython line score-0'>&#xA0;207:     # state sum of states that includes tunneling</pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+208:     conf.sumStates = convolve(conf.densStates, kappa)</pre>
<pre class='cython code score-30'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_convolve);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_densStates);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_15 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_15 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_1) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_15, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kappa);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_15, __pyx_v_kappa);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kappa);
  __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_conf, __pyx_n_s_sumStates, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+209:     conf.Elist += Elist[0] - E0_TS</pre>
<pre class='cython code score-17'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_Elist);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Elist.diminfo[0].strides)) - __pyx_v_E0_TS));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_conf, __pyx_n_s_Elist, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;210: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+211:     for r in range(Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_7 = __pyx_v_Ngrains;
  for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_7; __pyx_t_17+=1) {
    __pyx_v_r = __pyx_t_17;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+212:         if conf.sumStates[r] &gt; 0:</pre>
<pre class='cython code score-14'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_sumStates);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_v_r, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_18 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_18) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+213:             E0 = conf.Elist[r]</pre>
<pre class='cython code score-5'>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_Elist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_v_r, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_E0 = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+214:             break</pre>
<pre class='cython code score-0'>      goto __pyx_L4_break;
    }
  }
  __pyx_L4_break:;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+215:     conf.Elist -= E0</pre>
<pre class='cython code score-13'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_Elist);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(!__pyx_v_E0)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("E0"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_3, __pyx_v_E0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_conf, __pyx_n_s_Elist, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;216: </pre>
<pre class='cython line score-52' onclick='toggleDiv(this)'>+217:     sumStates = conf.mapSumOfStates(Elist - E0, Jlist)</pre>
<pre class='cython code score-52'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_conf, __pyx_n_s_mapSumOfStates);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(!__pyx_v_E0)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("E0"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_Elist), __pyx_v_E0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = NULL;
  __pyx_t_15 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_15 = 1;
    }
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_15, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Jlist));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_15, ((PyObject *)__pyx_v_Jlist));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Jlist));
  __pyx_t_5 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sumStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
    }
    __pyx_pybuffernd_sumStates.diminfo[0].strides = __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sumStates.diminfo[0].shape = __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_sumStates.diminfo[1].strides = __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_sumStates.diminfo[1].shape = __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_sumStates = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;218: </pre>
<pre class='cython line score-0'>&#xA0;219:     # Generate k(E) using RRKM formula (with tunneling)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+220:     dE /= constants.h * constants.Na        # J/mol -&gt; s^-1</pre>
<pre class='cython code score-0'>  __pyx_v_dE = (__pyx_v_dE / (__pyx_v_5rmgpy_9constants_h * __pyx_v_5rmgpy_9constants_Na));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+221:     for s in range(NJ):</pre>
<pre class='cython code score-0'>  __pyx_t_7 = __pyx_v_NJ;
  for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_7; __pyx_t_17+=1) {
    __pyx_v_s = __pyx_t_17;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+222:         for r in range(Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_19 = __pyx_v_Ngrains;
    for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
      __pyx_v_r = __pyx_t_20;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+223:             if sumStates[r,s] &gt; 0 and densStates[r,s] &gt; 0:</pre>
<pre class='cython code score-0'>      __pyx_t_21 = __pyx_v_r;
      __pyx_t_22 = __pyx_v_s;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_sumStates.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_sumStates.diminfo[1].strides)) &gt; 0.0) != 0);
      if (__pyx_t_23) {
        goto __pyx_L12_next_and;
      } else {
        __pyx_t_18 = __pyx_t_23;
        goto __pyx_L11_bool_binop_done;
      }
      __pyx_L12_next_and:;
      __pyx_t_24 = __pyx_v_r;
      __pyx_t_25 = __pyx_v_s;
      __pyx_t_23 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_densStates.diminfo[1].strides)) &gt; 0.0) != 0);
      __pyx_t_18 = __pyx_t_23;
      __pyx_L11_bool_binop_done:;
      if (__pyx_t_18) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+224:                 k[r,s] = sumStates[r,s] / densStates[r,s] * dE</pre>
<pre class='cython code score-0'>        __pyx_t_26 = __pyx_v_r;
        __pyx_t_27 = __pyx_v_s;
        __pyx_t_28 = __pyx_v_r;
        __pyx_t_29 = __pyx_v_s;
        __pyx_t_30 = __pyx_v_r;
        __pyx_t_31 = __pyx_v_s;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_k.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_k.diminfo[1].strides) = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_sumStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_sumStates.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_sumStates.diminfo[1].strides)) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_densStates.diminfo[1].strides))) * __pyx_v_dE);
        goto __pyx_L10;
      }
      __pyx_L10:;
    }
  }
</pre><pre class='cython line score-0'>&#xA0;225: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+226:     return k</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_k));
  __pyx_r = ((PyObject *)__pyx_v_k);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;227: </pre>
<pre class='cython line score-0'>&#xA0;228: @cython.boundscheck(False)</pre>
<pre class='cython line score-0'>&#xA0;229: @cython.wraparound(False)</pre>
<pre class='cython line score-136' onclick='toggleDiv(this)'>+230: def applyInverseLaplaceTransformMethod(transitionState,</pre>
<pre class='cython code score-136'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_5applyInverseLaplaceTransformMethod(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_8reaction_4applyInverseLaplaceTransformMethod[] = "applyInverseLaplaceTransformMethod(transitionState, Arrhenius kinetics, ndarray Elist, ndarray Jlist, ndarray densStates, double T=0.0)\n\n    Calculate the microcanonical rate coefficient for a reaction using the\n    inverse Laplace transform method, where `kinetics` is the high pressure \n    limit rate coefficient, `E0` is the ground-state energy of the transition\n    state, `Elist` is the array of energies in kJ/mol at which to evaluate the\n    microcanonial rate, and `densStates` is the density of states of the\n    reactant. The temperature `T` in K is not required, and is only used when\n    the temperature exponent of the Arrhenius expression is negative (for which\n    the inverse transform is undefined).\n    ";
static PyMethodDef __pyx_mdef_5rmgpy_4pdep_8reaction_5applyInverseLaplaceTransformMethod = {"applyInverseLaplaceTransformMethod", (PyCFunction)__pyx_pw_5rmgpy_4pdep_8reaction_5applyInverseLaplaceTransformMethod, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5rmgpy_4pdep_8reaction_4applyInverseLaplaceTransformMethod};
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_5applyInverseLaplaceTransformMethod(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_transitionState = 0;
  struct __pyx_obj_5rmgpy_8kinetics_9arrhenius_Arrhenius *__pyx_v_kinetics = 0;
  PyArrayObject *__pyx_v_Elist = 0;
  PyArrayObject *__pyx_v_Jlist = 0;
  PyArrayObject *__pyx_v_densStates = 0;
  double __pyx_v_T;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("applyInverseLaplaceTransformMethod (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_transitionState,&amp;__pyx_n_s_kinetics,&amp;__pyx_n_s_Elist,&amp;__pyx_n_s_Jlist,&amp;__pyx_n_s_densStates,&amp;__pyx_n_s_T,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_transitionState)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_kinetics)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyInverseLaplaceTransformMethod", 0, 5, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Elist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyInverseLaplaceTransformMethod", 0, 5, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Jlist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyInverseLaplaceTransformMethod", 0, 5, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_densStates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyInverseLaplaceTransformMethod", 0, 5, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "applyInverseLaplaceTransformMethod") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_transitionState = values[0];
    __pyx_v_kinetics = ((struct __pyx_obj_5rmgpy_8kinetics_9arrhenius_Arrhenius *)values[1]);
    __pyx_v_Elist = ((PyArrayObject *)values[2]);
    __pyx_v_Jlist = ((PyArrayObject *)values[3]);
    __pyx_v_densStates = ((PyArrayObject *)values[4]);
    if (values[5]) {
      __pyx_v_T = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_T == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_T = ((double)0.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("applyInverseLaplaceTransformMethod", 0, 5, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.applyInverseLaplaceTransformMethod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_kinetics), __pyx_ptype_5rmgpy_8kinetics_9arrhenius_Arrhenius, 1, "kinetics", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Elist), __pyx_ptype_5numpy_ndarray, 1, "Elist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Jlist), __pyx_ptype_5numpy_ndarray, 1, "Jlist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_densStates), __pyx_ptype_5numpy_ndarray, 1, "densStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_4pdep_8reaction_4applyInverseLaplaceTransformMethod(__pyx_self, __pyx_v_transitionState, __pyx_v_kinetics, __pyx_v_Elist, __pyx_v_Jlist, __pyx_v_densStates, __pyx_v_T);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_8reaction_4applyInverseLaplaceTransformMethod(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_transitionState, struct __pyx_obj_5rmgpy_8kinetics_9arrhenius_Arrhenius *__pyx_v_kinetics, PyArrayObject *__pyx_v_Elist, PyArrayObject *__pyx_v_Jlist, PyArrayObject *__pyx_v_densStates, double __pyx_v_T) {
  PyArrayObject *__pyx_v_k = 0;
  PyArrayObject *__pyx_v_phi0 = 0;
  PyArrayObject *__pyx_v_phi = 0;
  int __pyx_v_Ngrains;
  int __pyx_v_NJ;
  double __pyx_v_dE;
  double __pyx_v_R;
  double __pyx_v_A;
  double __pyx_v_n;
  double __pyx_v_Ea;
  double __pyx_v_m0;
  double __pyx_v_rem;
  double __pyx_v_E0;
  double __pyx_v_num;
  double __pyx_v_E;
  double __pyx_v_n_crit;
  int __pyx_v_r;
  int __pyx_v_s;
  int __pyx_v_m;
  PyObject *__pyx_v_scipy = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Elist;
  __Pyx_Buffer __pyx_pybuffer_Elist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Jlist;
  __Pyx_Buffer __pyx_pybuffer_Jlist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_densStates;
  __Pyx_Buffer __pyx_pybuffer_densStates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_k;
  __Pyx_Buffer __pyx_pybuffer_k;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi0;
  __Pyx_Buffer __pyx_pybuffer_phi0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("applyInverseLaplaceTransformMethod", 0);
  __pyx_pybuffer_k.pybuffer.buf = NULL;
  __pyx_pybuffer_k.refcount = 0;
  __pyx_pybuffernd_k.data = NULL;
  __pyx_pybuffernd_k.rcbuffer = &amp;__pyx_pybuffer_k;
  __pyx_pybuffer_phi0.pybuffer.buf = NULL;
  __pyx_pybuffer_phi0.refcount = 0;
  __pyx_pybuffernd_phi0.data = NULL;
  __pyx_pybuffernd_phi0.rcbuffer = &amp;__pyx_pybuffer_phi0;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &amp;__pyx_pybuffer_phi;
  __pyx_pybuffer_Elist.pybuffer.buf = NULL;
  __pyx_pybuffer_Elist.refcount = 0;
  __pyx_pybuffernd_Elist.data = NULL;
  __pyx_pybuffernd_Elist.rcbuffer = &amp;__pyx_pybuffer_Elist;
  __pyx_pybuffer_Jlist.pybuffer.buf = NULL;
  __pyx_pybuffer_Jlist.refcount = 0;
  __pyx_pybuffernd_Jlist.data = NULL;
  __pyx_pybuffernd_Jlist.rcbuffer = &amp;__pyx_pybuffer_Jlist;
  __pyx_pybuffer_densStates.pybuffer.buf = NULL;
  __pyx_pybuffer_densStates.refcount = 0;
  __pyx_pybuffernd_densStates.data = NULL;
  __pyx_pybuffernd_densStates.rcbuffer = &amp;__pyx_pybuffer_densStates;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Elist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Elist.diminfo[0].strides = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Elist.diminfo[0].shape = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Jlist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Jlist.diminfo[0].strides = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Jlist.diminfo[0].shape = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_densStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_densStates.diminfo[0].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_densStates.diminfo[0].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_densStates.diminfo[1].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_densStates.diminfo[1].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_51);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.applyInverseLaplaceTransformMethod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_phi0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_phi);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scipy);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(27, __pyx_n_s_transitionState, __pyx_n_s_kinetics, __pyx_n_s_Elist, __pyx_n_s_Jlist, __pyx_n_s_densStates, __pyx_n_s_T, __pyx_n_s_k, __pyx_n_s_phi0, __pyx_n_s_phi, __pyx_n_s_Ngrains, __pyx_n_s_NJ, __pyx_n_s_activeJRotor, __pyx_n_s_dE, __pyx_n_s_R, __pyx_n_s_A, __pyx_n_s_n, __pyx_n_s_Ea, __pyx_n_s_m0, __pyx_n_s_rem, __pyx_n_s_E0, __pyx_n_s_num, __pyx_n_s_E, __pyx_n_s_n_crit, __pyx_n_s_r, __pyx_n_s_s, __pyx_n_s_m, __pyx_n_s_scipy);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
/* … */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_5rmgpy_4pdep_8reaction_5applyInverseLaplaceTransformMethod, NULL, __pyx_n_s_rmgpy_pdep_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_applyInverseLaplaceTransformMeth, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__15 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 27, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__14, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_data1_ajocher_codes_RMG_RMG_par, __pyx_n_s_applyInverseLaplaceTransformMeth, 230, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;231:                                        Arrhenius kinetics,</pre>
<pre class='cython line score-0'>&#xA0;232:                                        numpy.ndarray[numpy.float64_t,ndim=1] Elist,</pre>
<pre class='cython line score-0'>&#xA0;233:                                        numpy.ndarray[numpy.int_t,ndim=1] Jlist,</pre>
<pre class='cython line score-0'>&#xA0;234:                                        numpy.ndarray[numpy.float64_t,ndim=2] densStates,</pre>
<pre class='cython line score-0'>&#xA0;235:                                        double T=0.0):</pre>
<pre class='cython line score-0'>&#xA0;236:     """</pre>
<pre class='cython line score-0'>&#xA0;237:     Calculate the microcanonical rate coefficient for a reaction using the</pre>
<pre class='cython line score-0'>&#xA0;238:     inverse Laplace transform method, where `kinetics` is the high pressure</pre>
<pre class='cython line score-0'>&#xA0;239:     limit rate coefficient, `E0` is the ground-state energy of the transition</pre>
<pre class='cython line score-0'>&#xA0;240:     state, `Elist` is the array of energies in kJ/mol at which to evaluate the</pre>
<pre class='cython line score-0'>&#xA0;241:     microcanonial rate, and `densStates` is the density of states of the</pre>
<pre class='cython line score-0'>&#xA0;242:     reactant. The temperature `T` in K is not required, and is only used when</pre>
<pre class='cython line score-0'>&#xA0;243:     the temperature exponent of the Arrhenius expression is negative (for which</pre>
<pre class='cython line score-0'>&#xA0;244:     the inverse transform is undefined).</pre>
<pre class='cython line score-0'>&#xA0;245:     """</pre>
<pre class='cython line score-0'>&#xA0;246:     cdef numpy.ndarray[numpy.float64_t,ndim=2] k</pre>
<pre class='cython line score-0'>&#xA0;247:     cdef numpy.ndarray[numpy.float64_t,ndim=1] phi0, phi</pre>
<pre class='cython line score-0'>&#xA0;248:     cdef int Ngrains, NJ</pre>
<pre class='cython line score-0'>&#xA0;249:     cdef bint activeJRotor</pre>
<pre class='cython line score-0'>&#xA0;250:     cdef double dE, R, A, n, Ea, m0, rem, E0, num, E, n_crit</pre>
<pre class='cython line score-0'>&#xA0;251:     cdef int r, s, m</pre>
<pre class='cython line score-0'>&#xA0;252: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+253:     Ngrains = Elist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_Ngrains = (__pyx_v_Elist-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+254:     NJ = Jlist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_NJ = (__pyx_v_Jlist-&gt;dimensions[0]);
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+255:     k = numpy.zeros((Ngrains,NJ))</pre>
<pre class='cython code score-60'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_NJ);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_k.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_k, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
    }
    __pyx_pybuffernd_k.diminfo[0].strides = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_k.diminfo[0].shape = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_k.diminfo[1].strides = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_k.diminfo[1].shape = __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_k = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+256:     dE = Elist[1] - Elist[0]</pre>
<pre class='cython code score-0'>  __pyx_t_11 = 1;
  __pyx_t_12 = 0;
  __pyx_v_dE = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Elist.diminfo[0].strides)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+257:     R = constants.R</pre>
<pre class='cython code score-0'>  __pyx_v_R = __pyx_v_5rmgpy_9constants_R;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+258:     E0 = transitionState.conformer.E0.value_si</pre>
<pre class='cython code score-14'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_transitionState, __pyx_n_s_conformer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_E0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_value_si);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_E0 = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;259: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+260:     n = kinetics._n.value_si</pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_kinetics-&gt;_n-&gt;value_si;
  __pyx_v_n = __pyx_t_13;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+261:     A = kinetics._A.value_si / (kinetics._T0.value_si**n)</pre>
<pre class='cython code score-0'>  __pyx_v_A = (__pyx_v_kinetics-&gt;_A-&gt;value_si / pow(__pyx_v_kinetics-&gt;_T0-&gt;value_si, __pyx_v_n));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+262:     Ea = kinetics._Ea.value_si</pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_kinetics-&gt;_Ea-&gt;value_si;
  __pyx_v_Ea = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;263: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+264:     if isinstance(kinetics, Arrhenius) and (T != 0.0 or (Ea &gt;= 0 and n &gt;= 0)):</pre>
<pre class='cython code score-2'>  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(((PyObject *)__pyx_v_kinetics), ((PyObject*)__pyx_ptype_5rmgpy_8kinetics_9arrhenius_Arrhenius)); 
  __pyx_t_16 = (__pyx_t_15 != 0);
  if (__pyx_t_16) {
    goto __pyx_L5_next_and;
  } else {
    __pyx_t_14 = __pyx_t_16;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_L5_next_and:;
  __pyx_t_16 = ((__pyx_v_T != 0.0) != 0);
  if (!__pyx_t_16) {
    goto __pyx_L6_next_or;
  } else {
    __pyx_t_14 = __pyx_t_16;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_L6_next_or:;
  __pyx_t_16 = ((__pyx_v_Ea &gt;= 0.0) != 0);
  if (__pyx_t_16) {
    goto __pyx_L7_next_and;
  } else {
    __pyx_t_14 = __pyx_t_16;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_L7_next_and:;
  __pyx_t_16 = ((__pyx_v_n &gt;= 0.0) != 0);
  __pyx_t_14 = __pyx_t_16;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_14) {
</pre><pre class='cython line score-0'>&#xA0;265: </pre>
<pre class='cython line score-0'>&#xA0;266:         # The inverse Laplace transform is not defined for Ea &lt; 0 or n &lt; 0</pre>
<pre class='cython line score-0'>&#xA0;267:         # In these cases we move the offending portion into the preexponential</pre>
<pre class='cython line score-0'>&#xA0;268:         # at the temperature of interest</pre>
<pre class='cython line score-0'>&#xA0;269:         # This is an approximation, but it's not worth a more robust procedure</pre>
<pre class='cython line score-0'>&#xA0;270: </pre>
<pre class='cython line score-0'>&#xA0;271:         # Including the T^n piece explicitly also has numerical difficulties</pre>
<pre class='cython line score-0'>&#xA0;272:         # for small positive n; it turns out that using this approximation is</pre>
<pre class='cython line score-0'>&#xA0;273:         # actually more accurate than trying to handle the T^n piece "properly"</pre>
<pre class='cython line score-0'>&#xA0;274:         # For now the implementation is to use this approximation for all n</pre>
<pre class='cython line score-0'>&#xA0;275:         # below some critical value, which is purposely placed a bit above zero</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+276:         n_crit = 0.25</pre>
<pre class='cython code score-0'>    __pyx_v_n_crit = 0.25;
</pre><pre class='cython line score-0'>&#xA0;277: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+278:         if Ea &lt; 0:</pre>
<pre class='cython code score-0'>    __pyx_t_14 = ((__pyx_v_Ea &lt; 0.0) != 0);
    if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+279:             A *= exp(-Ea / R / T)</pre>
<pre class='cython code score-0'>      __pyx_v_A = (__pyx_v_A * exp((((-__pyx_v_Ea) / __pyx_v_R) / __pyx_v_T)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+280:             Ea = 0.0</pre>
<pre class='cython code score-0'>      __pyx_v_Ea = 0.0;
      goto __pyx_L8;
    }
    __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+281:         if n &lt; n_crit:</pre>
<pre class='cython code score-0'>    __pyx_t_14 = ((__pyx_v_n &lt; __pyx_v_n_crit) != 0);
    if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+282:             A *= T**n</pre>
<pre class='cython code score-0'>      __pyx_v_A = (__pyx_v_A * pow(__pyx_v_T, __pyx_v_n));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+283:             n = 0.0</pre>
<pre class='cython code score-0'>      __pyx_v_n = 0.0;
      goto __pyx_L9;
    }
    __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;284: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+285:         if n &lt; n_crit:</pre>
<pre class='cython code score-0'>    __pyx_t_14 = ((__pyx_v_n &lt; __pyx_v_n_crit) != 0);
    if (__pyx_t_14) {
</pre><pre class='cython line score-0'>&#xA0;286:             # Determine the microcanonical rate directly</pre>
<pre class='cython line score-76' onclick='toggleDiv(this)'>+287:             m0, rem = divmod(Ea, dE)</pre>
<pre class='cython code score-76'>      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Ea);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Divmod</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        PyObject* sequence = __pyx_t_2;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_17 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
        index = 0; __pyx_t_3 = __pyx_t_17(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        index = 1; __pyx_t_1 = __pyx_t_17(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_17(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_17 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        goto __pyx_L12_unpacking_done;
        __pyx_L11_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_17 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L12_unpacking_done:;
      }
      __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_18 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_18 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_m0 = __pyx_t_13;
      __pyx_v_rem = __pyx_t_18;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+288:             m = int(m0)</pre>
<pre class='cython code score-0'>      __pyx_v_m = ((int)__pyx_v_m0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+289:             if rem == 0:</pre>
<pre class='cython code score-0'>      __pyx_t_14 = ((__pyx_v_rem == 0.0) != 0);
      if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+290:                 for s in range(NJ):</pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_NJ;
        for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_7; __pyx_t_19+=1) {
          __pyx_v_s = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+291:                     for r in range(m, Ngrains):</pre>
<pre class='cython code score-0'>          __pyx_t_20 = __pyx_v_Ngrains;
          for (__pyx_t_21 = __pyx_v_m; __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
            __pyx_v_r = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+292:                         if Elist[r] &gt; E0 and densStates[r,s] != 0:</pre>
<pre class='cython code score-0'>            __pyx_t_22 = __pyx_v_r;
            __pyx_t_16 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_Elist.diminfo[0].strides)) &gt; __pyx_v_E0) != 0);
            if (__pyx_t_16) {
              goto __pyx_L20_next_and;
            } else {
              __pyx_t_14 = __pyx_t_16;
              goto __pyx_L19_bool_binop_done;
            }
            __pyx_L20_next_and:;
            __pyx_t_23 = __pyx_v_r;
            __pyx_t_24 = __pyx_v_s;
            __pyx_t_16 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_densStates.diminfo[1].strides)) != 0.0) != 0);
            __pyx_t_14 = __pyx_t_16;
            __pyx_L19_bool_binop_done:;
            if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+293:                             k[r,s] = A * densStates[r-m,s] / densStates[r,s]</pre>
<pre class='cython code score-0'>              __pyx_t_25 = (__pyx_v_r - __pyx_v_m);
              __pyx_t_26 = __pyx_v_s;
              __pyx_t_27 = __pyx_v_r;
              __pyx_t_28 = __pyx_v_s;
              __pyx_t_29 = __pyx_v_r;
              __pyx_t_30 = __pyx_v_s;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_k.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_k.diminfo[1].strides) = ((__pyx_v_A * (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_densStates.diminfo[1].strides))) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_densStates.diminfo[1].strides)));
              goto __pyx_L18;
            }
            __pyx_L18:;
          }
        }
        goto __pyx_L13;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;294:             else:</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+295:                 for s in range(NJ):</pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_NJ;
        for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_7; __pyx_t_19+=1) {
          __pyx_v_s = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+296:                     for r in range(m+1, Ngrains):</pre>
<pre class='cython code score-0'>          __pyx_t_20 = __pyx_v_Ngrains;
          for (__pyx_t_21 = (__pyx_v_m + 1); __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
            __pyx_v_r = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+297:                         if Elist[r] &gt; E0 and densStates[r,s] != 0 and abs(densStates[r-m,s]) &gt; 1e-12 and abs(densStates[r-m-1,s]) &gt; 1e-12:</pre>
<pre class='cython code score-0'>            __pyx_t_31 = __pyx_v_r;
            __pyx_t_16 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_Elist.diminfo[0].strides)) &gt; __pyx_v_E0) != 0);
            if (__pyx_t_16) {
              goto __pyx_L27_next_and;
            } else {
              __pyx_t_14 = __pyx_t_16;
              goto __pyx_L26_bool_binop_done;
            }
            __pyx_L27_next_and:;
            __pyx_t_32 = __pyx_v_r;
            __pyx_t_33 = __pyx_v_s;
            __pyx_t_16 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_densStates.diminfo[1].strides)) != 0.0) != 0);
            if (__pyx_t_16) {
              goto __pyx_L28_next_and;
            } else {
              __pyx_t_14 = __pyx_t_16;
              goto __pyx_L26_bool_binop_done;
            }
            __pyx_L28_next_and:;
            __pyx_t_34 = (__pyx_v_r - __pyx_v_m);
            __pyx_t_35 = __pyx_v_s;
            __pyx_t_16 = ((fabs((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_densStates.diminfo[1].strides))) &gt; 1e-12) != 0);
            if (__pyx_t_16) {
              goto __pyx_L29_next_and;
            } else {
              __pyx_t_14 = __pyx_t_16;
              goto __pyx_L26_bool_binop_done;
            }
            __pyx_L29_next_and:;
            __pyx_t_36 = ((__pyx_v_r - __pyx_v_m) - 1);
            __pyx_t_37 = __pyx_v_s;
            __pyx_t_16 = ((fabs((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_37, __pyx_pybuffernd_densStates.diminfo[1].strides))) &gt; 1e-12) != 0);
            __pyx_t_14 = __pyx_t_16;
            __pyx_L26_bool_binop_done:;
            if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+298:                             num = densStates[r-m,s] * (densStates[r-m-1,s] / densStates[r-m,s]) ** (-rem / (Elist[r-m-1] - Elist[r-m]))</pre>
<pre class='cython code score-0'>              __pyx_t_38 = (__pyx_v_r - __pyx_v_m);
              __pyx_t_39 = __pyx_v_s;
              __pyx_t_40 = ((__pyx_v_r - __pyx_v_m) - 1);
              __pyx_t_41 = __pyx_v_s;
              __pyx_t_42 = (__pyx_v_r - __pyx_v_m);
              __pyx_t_43 = __pyx_v_s;
              __pyx_t_44 = ((__pyx_v_r - __pyx_v_m) - 1);
              __pyx_t_45 = (__pyx_v_r - __pyx_v_m);
              __pyx_v_num = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_densStates.diminfo[1].strides)) * pow(((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_densStates.diminfo[1].strides)) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_densStates.diminfo[1].strides))), ((-__pyx_v_rem) / ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_Elist.diminfo[0].strides))))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+299:                             k[r,s] = A * num / densStates[r,s]</pre>
<pre class='cython code score-0'>              __pyx_t_46 = __pyx_v_r;
              __pyx_t_47 = __pyx_v_s;
              __pyx_t_48 = __pyx_v_r;
              __pyx_t_49 = __pyx_v_s;
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_k.diminfo[0].strides, __pyx_t_49, __pyx_pybuffernd_k.diminfo[1].strides) = ((__pyx_v_A * __pyx_v_num) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_47, __pyx_pybuffernd_densStates.diminfo[1].strides)));
              goto __pyx_L25;
            }
            __pyx_L25:;
          }
        }
      }
      __pyx_L13:;
      goto __pyx_L10;
    }
</pre><pre class='cython line score-0'>&#xA0;300: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+301:         elif n &gt;= n_crit:</pre>
<pre class='cython code score-0'>    __pyx_t_14 = ((__pyx_v_n &gt;= __pyx_v_n_crit) != 0);
    if (__pyx_t_14) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+302:             import scipy.special</pre>
<pre class='cython code score-2'>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_special, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_v_scipy = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;303:             # Evaluate the inverse Laplace transform of the T**n exp(-Ea/RT) piece, which only</pre>
<pre class='cython line score-0'>&#xA0;304:             # exists for n &gt;= 0</pre>
<pre class='cython line score-54' onclick='toggleDiv(this)'>+305:             phi0 = numpy.zeros(Ngrains, numpy.float64)</pre>
<pre class='cython code score-54'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_50 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_50 = 1;
        }
      }
      __pyx_t_51 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_50);<span class='error_goto'> if (unlikely(!__pyx_t_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_51);
      if (__pyx_t_5) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 0+__pyx_t_50, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 1+__pyx_t_50, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      __pyx_t_1 = 0;
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_51, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_51); __pyx_t_51 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_52 = ((PyArrayObject *)__pyx_t_2);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_52, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi0, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
          }
        }
        __pyx_pybuffernd_phi0.diminfo[0].strides = __pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi0.diminfo[0].shape = __pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_52 = 0;
      __pyx_v_phi0 = ((PyArrayObject *)__pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+306:             for r in range(Ngrains):</pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_Ngrains;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_7; __pyx_t_19+=1) {
        __pyx_v_r = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+307:                 E = Elist[r] - Elist[0] - Ea</pre>
<pre class='cython code score-0'>        __pyx_t_20 = __pyx_v_r;
        __pyx_t_53 = 0;
        __pyx_v_E = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_Elist.diminfo[0].strides))) - __pyx_v_Ea);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+308:                 if E &gt; 0:</pre>
<pre class='cython code score-0'>        __pyx_t_14 = ((__pyx_v_E &gt; 0.0) != 0);
        if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+309:                     phi0[r] = (E/R)**(n-1.0)</pre>
<pre class='cython code score-0'>          __pyx_t_21 = __pyx_v_r;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_phi0.diminfo[0].strides) = pow((__pyx_v_E / __pyx_v_R), (__pyx_v_n - 1.0));
          goto __pyx_L32;
        }
        __pyx_L32:;
      }
</pre><pre class='cython line score-70' onclick='toggleDiv(this)'>+310:             phi0 = phi0 * (dE / R) / scipy.special.gamma(n)</pre>
<pre class='cython code score-70'>      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_dE / __pyx_v_R));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_v_phi0), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_51 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_scipy, __pyx_n_s_special);<span class='error_goto'> if (unlikely(!__pyx_t_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_51);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_51, __pyx_n_s_gamma);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_51); __pyx_t_51 = 0;
      __pyx_t_51 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_51);
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_51);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_51); __pyx_t_51 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_51);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_51);
        __pyx_t_51 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_52 = ((PyArrayObject *)__pyx_t_4);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_52, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi0, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
          }
        }
        __pyx_pybuffernd_phi0.diminfo[0].strides = __pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi0.diminfo[0].shape = __pyx_pybuffernd_phi0.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_52 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_phi0, ((PyArrayObject *)__pyx_t_4));
      __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;311:             # Evaluate the convolution</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+312:             for s in range(NJ):</pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_NJ;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_7; __pyx_t_19+=1) {
        __pyx_v_s = __pyx_t_19;
</pre><pre class='cython line score-67' onclick='toggleDiv(this)'>+313:                 phi = convolve(phi0, densStates[:,s])</pre>
<pre class='cython code score-67'>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_convolve);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice_);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_slice_);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_densStates), __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = NULL;
        __pyx_t_50 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_50 = 1;
          }
        }
        __pyx_t_51 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_50);<span class='error_goto'> if (unlikely(!__pyx_t_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_51);
        if (__pyx_t_5) {
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_phi0));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 0+__pyx_t_50, ((PyObject *)__pyx_v_phi0));
        <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_phi0));
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_51, 1+__pyx_t_50, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_51, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_51); __pyx_t_51 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_52 = ((PyArrayObject *)__pyx_t_4);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
          __pyx_t_54 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_52, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_54 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
            }
          }
          __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.shape[0];
          if (unlikely(__pyx_t_54 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_52 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_phi, ((PyArrayObject *)__pyx_t_4));
        __pyx_t_4 = 0;
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
</pre><pre class='cython line score-0'>&#xA0;314:                 # Apply to determine the microcanonical rate</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+315:                 for r in range(Ngrains):</pre>
<pre class='cython code score-0'>        __pyx_t_54 = __pyx_v_Ngrains;
        for (__pyx_t_55 = 0; __pyx_t_55 &lt; __pyx_t_54; __pyx_t_55+=1) {
          __pyx_v_r = __pyx_t_55;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+316:                     if densStates[r,s] != 0:</pre>
<pre class='cython code score-0'>          __pyx_t_56 = __pyx_v_r;
          __pyx_t_57 = __pyx_v_s;
          __pyx_t_14 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_57, __pyx_pybuffernd_densStates.diminfo[1].strides)) != 0.0) != 0);
          if (__pyx_t_14) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+317:                         k[r,s] = A * phi[r] / densStates[r,s]</pre>
<pre class='cython code score-0'>            __pyx_t_58 = __pyx_v_r;
            __pyx_t_59 = __pyx_v_r;
            __pyx_t_60 = __pyx_v_s;
            __pyx_t_61 = __pyx_v_r;
            __pyx_t_62 = __pyx_v_s;
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_k.rcbuffer-&gt;pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_k.diminfo[0].strides, __pyx_t_62, __pyx_pybuffernd_k.diminfo[1].strides) = ((__pyx_v_A * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_phi.diminfo[0].strides))) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_60, __pyx_pybuffernd_densStates.diminfo[1].strides)));
            goto __pyx_L37;
          }
          __pyx_L37:;
        }
      }
      goto __pyx_L10;
    }
    __pyx_L10:;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;318: </pre>
<pre class='cython line score-0'>&#xA0;319:     else:</pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+320:         raise Exception('Unable to use inverse Laplace transform method for non-Arrhenius kinetics or for n &lt; 0.')</pre>
<pre class='cython code score-10'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_Exception, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L3:;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Unable_to_use_inverse_Laplace_tr);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class='cython line score-0'>&#xA0;321: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+322:     return k</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_k));
  __pyx_r = ((PyObject *)__pyx_v_k);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;323: </pre>
<pre class='cython line score-135' onclick='toggleDiv(this)'>+324: def fitInterpolationModel(reaction, Tlist, Plist, K, model, Tmin, Tmax, Pmin, Pmax, errorCheck=False):</pre>
<pre class='cython code score-135'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_7fitInterpolationModel(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_8reaction_6fitInterpolationModel[] = "fitInterpolationModel(reaction, Tlist, Plist, K, model, Tmin, Tmax, Pmin, Pmax, errorCheck=False)\n\n    For a set of phenomenological rate coefficients `K` computed at a grid of\n    temperatures `Tlist` in K and pressures `Plist` in Pa, fit a :math:`k(T,P)`\n    interpolation `model`, a tuple where the first item is a string describing\n    the type of model - either ``'chebyshev'`` or ``'pdeparrhenius'`` - and the\n    remaining elements contain parameters for that model. For Chebyshev\n    polynomials, the parameters are the number of terms to use in each of the\n    temperature and pressure dimensions. For pressure-dependent Arrhenius models\n    there are no additional parameters. `Tmin`, `Tmax`, `Pmin`, and `Pmax`\n    specify the temperature and pressure ranges in K and Pa, respectively,\n    over which the interpolation model is valid. If `errorCheck` is ``True``,\n    a check will be performed to ensure that the interpolation model does not\n    deviate too much from the data; as this is not necessarily a fast process,\n    it is optional.\n    ";
static PyMethodDef __pyx_mdef_5rmgpy_4pdep_8reaction_7fitInterpolationModel = {"fitInterpolationModel", (PyCFunction)__pyx_pw_5rmgpy_4pdep_8reaction_7fitInterpolationModel, METH_VARARGS|METH_KEYWORDS, __pyx_doc_5rmgpy_4pdep_8reaction_6fitInterpolationModel};
static PyObject *__pyx_pw_5rmgpy_4pdep_8reaction_7fitInterpolationModel(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_reaction = 0;
  PyObject *__pyx_v_Tlist = 0;
  PyObject *__pyx_v_Plist = 0;
  PyObject *__pyx_v_K = 0;
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_Tmin = 0;
  PyObject *__pyx_v_Tmax = 0;
  PyObject *__pyx_v_Pmin = 0;
  PyObject *__pyx_v_Pmax = 0;
  PyObject *__pyx_v_errorCheck = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fitInterpolationModel (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_reaction,&amp;__pyx_n_s_Tlist,&amp;__pyx_n_s_Plist,&amp;__pyx_n_s_K,&amp;__pyx_n_s_model,&amp;__pyx_n_s_Tmin,&amp;__pyx_n_s_Tmax,&amp;__pyx_n_s_Pmin,&amp;__pyx_n_s_Pmax,&amp;__pyx_n_s_errorCheck,0};
    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
    values[9] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_reaction)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Tlist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Plist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Tmin)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Tmax)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Pmin)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 7); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Pmax)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, 8); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_errorCheck);
          if (value) { values[9] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fitInterpolationModel") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_reaction = values[0];
    __pyx_v_Tlist = values[1];
    __pyx_v_Plist = values[2];
    __pyx_v_K = values[3];
    __pyx_v_model = values[4];
    __pyx_v_Tmin = values[5];
    __pyx_v_Tmax = values[6];
    __pyx_v_Pmin = values[7];
    __pyx_v_Pmax = values[8];
    __pyx_v_errorCheck = values[9];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fitInterpolationModel", 0, 9, 10, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.fitInterpolationModel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_4pdep_8reaction_6fitInterpolationModel(__pyx_self, __pyx_v_reaction, __pyx_v_Tlist, __pyx_v_Plist, __pyx_v_K, __pyx_v_model, __pyx_v_Tmin, __pyx_v_Tmax, __pyx_v_Pmin, __pyx_v_Pmax, __pyx_v_errorCheck);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_8reaction_6fitInterpolationModel(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_reaction, PyObject *__pyx_v_Tlist, PyObject *__pyx_v_Plist, PyObject *__pyx_v_K, PyObject *__pyx_v_model, PyObject *__pyx_v_Tmin, PyObject *__pyx_v_Tmax, PyObject *__pyx_v_Pmin, PyObject *__pyx_v_Pmax, PyObject *__pyx_v_errorCheck) {
  PyObject *__pyx_v_Quantity = NULL;
  PyObject *__pyx_v_PDepArrhenius = NULL;
  PyObject *__pyx_v_Chebyshev = NULL;
  PyObject *__pyx_v_kunits = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_modelType = NULL;
  PyObject *__pyx_v_degreeT = NULL;
  PyObject *__pyx_v_degreeP = NULL;
  PyObject *__pyx_v_chebyshev = NULL;
  PyObject *__pyx_v_kinetics = NULL;
  PyObject *__pyx_v_pDepArrhenius = NULL;
  double __pyx_v_logRMS;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_v_T = NULL;
  PyObject *__pyx_v_p = NULL;
  PyObject *__pyx_v_P = NULL;
  double __pyx_v_logkmodel;
  double __pyx_v_logkdata;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fitInterpolationModel", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.reaction.fitInterpolationModel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Quantity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_PDepArrhenius);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Chebyshev);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kunits);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_modelType);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_degreeT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_degreeP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chebyshev);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kinetics);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pDepArrhenius);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_P);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(27, __pyx_n_s_reaction, __pyx_n_s_Tlist, __pyx_n_s_Plist, __pyx_n_s_K, __pyx_n_s_model, __pyx_n_s_Tmin, __pyx_n_s_Tmax, __pyx_n_s_Pmin, __pyx_n_s_Pmax, __pyx_n_s_errorCheck, __pyx_n_s_Quantity, __pyx_n_s_PDepArrhenius, __pyx_n_s_Chebyshev, __pyx_n_s_kunits, __pyx_n_s_modelType, __pyx_n_s_degreeT, __pyx_n_s_degreeP, __pyx_n_s_chebyshev, __pyx_n_s_kinetics, __pyx_n_s_pDepArrhenius, __pyx_n_s_logRMS, __pyx_n_s_t, __pyx_n_s_T, __pyx_n_s_p, __pyx_n_s_P, __pyx_n_s_logkmodel, __pyx_n_s_logkdata);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
/* … */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_5rmgpy_4pdep_8reaction_7fitInterpolationModel, NULL, __pyx_n_s_rmgpy_pdep_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fitInterpolationModel, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;325:     """</pre>
<pre class='cython line score-0'>&#xA0;326:     For a set of phenomenological rate coefficients `K` computed at a grid of</pre>
<pre class='cython line score-0'>&#xA0;327:     temperatures `Tlist` in K and pressures `Plist` in Pa, fit a :math:`k(T,P)`</pre>
<pre class='cython line score-0'>&#xA0;328:     interpolation `model`, a tuple where the first item is a string describing</pre>
<pre class='cython line score-0'>&#xA0;329:     the type of model - either ``'chebyshev'`` or ``'pdeparrhenius'`` - and the</pre>
<pre class='cython line score-0'>&#xA0;330:     remaining elements contain parameters for that model. For Chebyshev</pre>
<pre class='cython line score-0'>&#xA0;331:     polynomials, the parameters are the number of terms to use in each of the</pre>
<pre class='cython line score-0'>&#xA0;332:     temperature and pressure dimensions. For pressure-dependent Arrhenius models</pre>
<pre class='cython line score-0'>&#xA0;333:     there are no additional parameters. `Tmin`, `Tmax`, `Pmin`, and `Pmax`</pre>
<pre class='cython line score-0'>&#xA0;334:     specify the temperature and pressure ranges in K and Pa, respectively,</pre>
<pre class='cython line score-0'>&#xA0;335:     over which the interpolation model is valid. If `errorCheck` is ``True``,</pre>
<pre class='cython line score-0'>&#xA0;336:     a check will be performed to ensure that the interpolation model does not</pre>
<pre class='cython line score-0'>&#xA0;337:     deviate too much from the data; as this is not necessarily a fast process,</pre>
<pre class='cython line score-0'>&#xA0;338:     it is optional.</pre>
<pre class='cython line score-0'>&#xA0;339:     """</pre>
<pre class='cython line score-0'>&#xA0;340: </pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+341:     from rmgpy.quantity import Quantity</pre>
<pre class='cython code score-15'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Quantity);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Quantity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Quantity);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_quantity, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Quantity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_Quantity = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+342:     from rmgpy.kinetics import PDepArrhenius, Chebyshev</pre>
<pre class='cython code score-21'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_PDepArrhenius);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_PDepArrhenius);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_PDepArrhenius);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Chebyshev);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_Chebyshev);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Chebyshev);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_kinetics, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_PDepArrhenius);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_v_PDepArrhenius = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_Chebyshev);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_v_Chebyshev = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;343: </pre>
<pre class='cython line score-0'>&#xA0;344:     # Determine units for k(T,P)</pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+345:     if len(reaction.reactants) == 1:</pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = ((__pyx_t_3 == 1) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+346:         kunits = 's^-1'</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_s_1);
    __pyx_v_kunits = __pyx_kp_s_s_1;
    goto __pyx_L3;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+347:     elif len(reaction.reactants) == 2:</pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = ((__pyx_t_3 == 2) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+348:         kunits = 'm^3/(mol*s)'</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_m_3_mol_s);
    __pyx_v_kunits = __pyx_kp_s_m_3_mol_s;
    goto __pyx_L3;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+349:     elif len(reaction.reactants) == 3:</pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_reaction, __pyx_n_s_reactants);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = ((__pyx_t_3 == 3) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+350:         kunits = 'm^6/(mol^2*s)'</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_m_6_mol_2_s);
    __pyx_v_kunits = __pyx_kp_s_m_6_mol_2_s;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;351:     else:</pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+352:         kunits = ''</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s__3);
    __pyx_v_kunits = __pyx_kp_s__3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;353: </pre>
<pre class='cython line score-0'>&#xA0;354:     # Set/update the net reaction kinetics using interpolation model</pre>
<pre class='cython line score-24' onclick='toggleDiv(this)'>+355:     if model[0].lower() == 'chebyshev':</pre>
<pre class='cython code score-24'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_model, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_1, __pyx_n_s_chebyshev, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_4) {
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+356:         modelType, degreeT, degreeP = model</pre>
<pre class='cython code score-49'>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_model))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_model))) {
      PyObject* sequence = __pyx_v_model;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 3)) {
        if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_model);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = Py_TYPE(__pyx_t_6)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_5 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 2; __pyx_t_2 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_6), 3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_v_modelType = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_degreeT = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_degreeP = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+357:         chebyshev = Chebyshev()</pre>
<pre class='cython code score-17'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Chebyshev);
    __pyx_t_5 = __pyx_v_Chebyshev; __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_1) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_chebyshev = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='cython line score-43' onclick='toggleDiv(this)'>+358:         chebyshev.fitToData(Tlist, Plist, K, kunits, degreeT, degreeP, Tmin, Tmax, Pmin, Pmax)</pre>
<pre class='cython code score-43'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_chebyshev, __pyx_n_s_fitToData);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = NULL;
    __pyx_t_3 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_3 = 1;
      }
    }
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(10+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_1) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tlist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_3, __pyx_v_Tlist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tlist);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Plist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_3, __pyx_v_Plist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Plist);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_3, __pyx_v_K);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kunits);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_3, __pyx_v_kunits);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kunits);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_degreeT);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4+__pyx_t_3, __pyx_v_degreeT);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_degreeT);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_degreeP);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 5+__pyx_t_3, __pyx_v_degreeP);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_degreeP);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tmin);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 6+__pyx_t_3, __pyx_v_Tmin);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tmin);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tmax);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 7+__pyx_t_3, __pyx_v_Tmax);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tmax);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Pmin);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 8+__pyx_t_3, __pyx_v_Pmin);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Pmin);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Pmax);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 9+__pyx_t_3, __pyx_v_Pmax);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Pmax);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+359:         kinetics = chebyshev</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_chebyshev);
    __pyx_v_kinetics = __pyx_v_chebyshev;
    goto __pyx_L4;
  }
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+360:     elif model[0].lower() == 'pdeparrhenius':</pre>
<pre class='cython code score-24'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_model, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_2, __pyx_n_s_pdeparrhenius, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+361:         pDepArrhenius = PDepArrhenius()</pre>
<pre class='cython code score-17'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_PDepArrhenius);
    __pyx_t_6 = __pyx_v_PDepArrhenius; __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_pDepArrhenius = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='cython line score-34' onclick='toggleDiv(this)'>+362:         pDepArrhenius.fitToData(Tlist, Plist, K, kunits=kunits, T0=298.0)</pre>
<pre class='cython code score-34'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pDepArrhenius, __pyx_n_s_fitToData);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tlist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_Tlist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tlist);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Plist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_Plist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Plist);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_v_K);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K);
    __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_kunits, __pyx_v_kunits) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_T0, __pyx_float_298_0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+363:         kinetics = pDepArrhenius</pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pDepArrhenius);
    __pyx_v_kinetics = __pyx_v_pDepArrhenius;
    goto __pyx_L4;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;364:     else:</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+365:         return None</pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
  }
  __pyx_L4:;
</pre><pre class='cython line score-0'>&#xA0;366: </pre>
<pre class='cython line score-0'>&#xA0;367:     # Set temperature and pressure ranges explicitly (as they may be different</pre>
<pre class='cython line score-0'>&#xA0;368:     # from min(Tlist), max(Tlist), min(Plist), max(Plist))</pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+369:     kinetics.Tmin = Quantity(Tmin,"K")</pre>
<pre class='cython code score-28'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Quantity);
  __pyx_t_5 = __pyx_v_Quantity; __pyx_t_6 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_6) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tmin);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_3, __pyx_v_Tmin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tmin);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_K);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_3, __pyx_n_s_K);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_K);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_kinetics, __pyx_n_s_Tmin, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+370:     kinetics.Tmax = Quantity(Tmax,"K")</pre>
<pre class='cython code score-28'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Quantity);
  __pyx_t_5 = __pyx_v_Quantity; __pyx_t_2 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Tmax);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_3, __pyx_v_Tmax);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Tmax);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_K);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_3, __pyx_n_s_K);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_K);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_kinetics, __pyx_n_s_Tmax, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+371:     kinetics.Pmin = Quantity(Pmin/1e5,"bar")</pre>
<pre class='cython code score-29'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_Pmin, __pyx_float_1e5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Quantity);
  __pyx_t_6 = __pyx_v_Quantity; __pyx_t_2 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_2) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_3, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bar);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_3, __pyx_n_s_bar);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bar);
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_kinetics, __pyx_n_s_Pmin, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+372:     kinetics.Pmax = Quantity(Pmax/1e5,"bar")</pre>
<pre class='cython code score-29'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_Pmax, __pyx_float_1e5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Quantity);
  __pyx_t_8 = __pyx_v_Quantity; __pyx_t_5 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_5) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_3, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bar);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_3, __pyx_n_s_bar);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bar);
  __pyx_t_6 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_kinetics, __pyx_n_s_Pmax, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;373: </pre>
<pre class='cython line score-0'>&#xA0;374:     # Compute log RMS error for fit</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+375:     if errorCheck:</pre>
<pre class='cython code score-2'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_errorCheck);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+376:         logRMS = 0.0</pre>
<pre class='cython code score-0'>    __pyx_v_logRMS = 0.0;
</pre><pre class='cython line score-0'>&#xA0;377:         # Check that fit is within an order of magnitude at all points</pre>
<pre class='cython line score-56' onclick='toggleDiv(this)'>+378:         for t, T in enumerate(Tlist):</pre>
<pre class='cython code score-56'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_1 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_Tlist)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_Tlist)) {
      __pyx_t_8 = __pyx_v_Tlist; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_3 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_Tlist);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_9(__pyx_t_8);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_T, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
      __pyx_t_1 = __pyx_t_2;
      __pyx_t_2 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-56' onclick='toggleDiv(this)'>+379:             for p, P in enumerate(Plist):</pre>
<pre class='cython code score-56'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      __pyx_t_2 = __pyx_int_0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_Plist)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_Plist)) {
        __pyx_t_6 = __pyx_v_Plist; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_Plist);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_11 = Py_TYPE(__pyx_t_6)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
            if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_6)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_6, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_6, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #endif
          } else {
            if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_6)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_6, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #endif
          }
        } else {
          __pyx_t_5 = __pyx_t_11(__pyx_t_6);
          if (unlikely(!__pyx_t_5)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_P, __pyx_t_5);
        __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_p, __pyx_t_2);
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
        __pyx_t_2 = __pyx_t_5;
        __pyx_t_5 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+380:                 logkmodel = log(kinetics.getRateCoefficient(T, P))</pre>
<pre class='cython code score-32'>        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_kinetics, __pyx_n_s_getRateCoefficient);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_13 = NULL;
        __pyx_t_14 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
          __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
          if (likely(__pyx_t_13)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
            __pyx_t_14 = 1;
          }
        }
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        if (__pyx_t_13) {
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_13); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); __pyx_t_13 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_14, __pyx_v_T);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_P);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_14, __pyx_v_P);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_P);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_16 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5);<span class='error_goto'> if (unlikely((__pyx_t_16 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_v_logkmodel = log(__pyx_t_16);
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+381:                 logkdata = log(K[t,p])</pre>
<pre class='cython code score-21'>        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_t);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_p);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_p);
        __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_16 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_16 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_v_logkdata = log(__pyx_t_16);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+382:                 logRMS += (logkmodel - logkdata) * (logkmodel - logkdata)</pre>
<pre class='cython code score-0'>        __pyx_v_logRMS = (__pyx_v_logRMS + ((__pyx_v_logkmodel - __pyx_v_logkdata) * (__pyx_v_logkmodel - __pyx_v_logkdata)));
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+383:         logRMS = sqrt(logRMS / len(Tlist) / len(Plist))</pre>
<pre class='cython code score-10'>    __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_Tlist);<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_Plist);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_logRMS = sqrt(((__pyx_v_logRMS / __pyx_t_3) / __pyx_t_10));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+384:         if logRMS &gt; 0.5:</pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_logRMS &gt; 0.5) != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-60' onclick='toggleDiv(this)'>+385:             logging.warning('RMS error for k(T,P) fit = {0:g} for reaction {1}.'.format(logRMS, reaction))</pre>
<pre class='cython code score-60'>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_warning);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_RMS_error_for_k_T_P_fit_0_g_for, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_logRMS);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_5 = NULL;
      __pyx_t_10 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_10 = 1;
        }
      }
      __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      if (__pyx_t_5) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_10, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_10, __pyx_v_reaction);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reaction);
      __pyx_t_12 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L12;
    }
    __pyx_L12:;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;386: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+387:     return kinetics</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kinetics);
  __pyx_r = __pyx_v_kinetics;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;388: </pre>
</div></body></html>
