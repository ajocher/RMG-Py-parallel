<!DOCTYPE html>
<!-- Generated by Cython 0.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21</p>
<p>Raw output: <a href="collision.c">collision.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+001: # cython: embedsignature=True, cdivision=True</pre>
<pre class='cython code score-11'>  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;002: </pre>
<pre class='cython line score-0'>&#xA0;003: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;004: #</pre>
<pre class='cython line score-0'>&#xA0;005: #   RMG - Reaction Mechanism Generator</pre>
<pre class='cython line score-0'>&#xA0;006: #</pre>
<pre class='cython line score-0'>&#xA0;007: #   Copyright (c) 2002-2009 Prof. William H. Green (whgreen@mit.edu) and the</pre>
<pre class='cython line score-0'>&#xA0;008: #   RMG Team (rmg_dev@mit.edu)</pre>
<pre class='cython line score-0'>&#xA0;009: #</pre>
<pre class='cython line score-0'>&#xA0;010: #   Permission is hereby granted, free of charge, to any person obtaining a</pre>
<pre class='cython line score-0'>&#xA0;011: #   copy of this software and associated documentation files (the "Software"),</pre>
<pre class='cython line score-0'>&#xA0;012: #   to deal in the Software without restriction, including without limitation</pre>
<pre class='cython line score-0'>&#xA0;013: #   the rights to use, copy, modify, merge, publish, distribute, sublicense,</pre>
<pre class='cython line score-0'>&#xA0;014: #   and/or sell copies of the Software, and to permit persons to whom the</pre>
<pre class='cython line score-0'>&#xA0;015: #   Software is furnished to do so, subject to the following conditions:</pre>
<pre class='cython line score-0'>&#xA0;016: #</pre>
<pre class='cython line score-0'>&#xA0;017: #   The above copyright notice and this permission notice shall be included in</pre>
<pre class='cython line score-0'>&#xA0;018: #   all copies or substantial portions of the Software.</pre>
<pre class='cython line score-0'>&#xA0;019: #</pre>
<pre class='cython line score-0'>&#xA0;020: #   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</pre>
<pre class='cython line score-0'>&#xA0;021: #   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</pre>
<pre class='cython line score-0'>&#xA0;022: #   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</pre>
<pre class='cython line score-0'>&#xA0;023: #   THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;024: #   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</pre>
<pre class='cython line score-0'>&#xA0;025: #   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</pre>
<pre class='cython line score-0'>&#xA0;026: #   DEALINGS IN THE SOFTWARE.</pre>
<pre class='cython line score-0'>&#xA0;027: #</pre>
<pre class='cython line score-0'>&#xA0;028: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;029: </pre>
<pre class='cython line score-0'>&#xA0;030: """</pre>
<pre class='cython line score-0'>&#xA0;031: This module contains classes and functions for working with collision models.</pre>
<pre class='cython line score-0'>&#xA0;032: """</pre>
<pre class='cython line score-0'>&#xA0;033: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+034: import numpy</pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;035: cimport cython</pre>
<pre class='cython line score-0'>&#xA0;036: </pre>
<pre class='cython line score-0'>&#xA0;037: cimport rmgpy.constants as constants</pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+038: import rmgpy.quantity as quantity</pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__17);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__17);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_rmgpy_quantity, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_quantity, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;039: from libc.math cimport exp, sqrt</pre>
<pre class='cython line score-0'>&#xA0;040: </pre>
<pre class='cython line score-0'>&#xA0;041: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;042: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+043: def CollisionError(Exception):</pre>
<pre class='cython code score-12'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_1CollisionError(PyObject *__pyx_self, PyObject *__pyx_v_Exception); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_CollisionError[] = "CollisionError(Exception)";
static PyMethodDef __pyx_mdef_5rmgpy_4pdep_9collision_1CollisionError = {"CollisionError", (PyCFunction)__pyx_pw_5rmgpy_4pdep_9collision_1CollisionError, METH_O, __pyx_doc_5rmgpy_4pdep_9collision_CollisionError};
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_1CollisionError(PyObject *__pyx_self, PyObject *__pyx_v_Exception) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CollisionError (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_CollisionError(__pyx_self, ((PyObject *)__pyx_v_Exception));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_CollisionError(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_Exception) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("CollisionError", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_Exception);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
/* … */
  __pyx_t_4 = PyCFunction_NewEx(&amp;__pyx_mdef_5rmgpy_4pdep_9collision_1CollisionError, NULL, __pyx_n_s_rmgpy_pdep_collision);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_CollisionError, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;044:     pass</pre>
<pre class='cython line score-0'>&#xA0;045: </pre>
<pre class='cython line score-0'>&#xA0;046: ################################################################################</pre>
<pre class='cython line score-0'>&#xA0;047: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+048: cdef class SingleExponentialDown:</pre>
<pre class='cython code score-0'>struct __pyx_vtabstruct_5rmgpy_4pdep_9collision_SingleExponentialDown {
  double (*getAlpha)(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *, double, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_vtabptr_5rmgpy_4pdep_9collision_SingleExponentialDown;
</pre><pre class='cython line score-0'>&#xA0;049:     """</pre>
<pre class='cython line score-0'>&#xA0;050:     A representation of a single exponential down model of collisional energy</pre>
<pre class='cython line score-0'>&#xA0;051:     transfer. The attributes are:</pre>
<pre class='cython line score-0'>&#xA0;052: </pre>
<pre class='cython line score-0'>&#xA0;053:     =================== ========================================================</pre>
<pre class='cython line score-0'>&#xA0;054:     Attribute           Description</pre>
<pre class='cython line score-0'>&#xA0;055:     =================== ========================================================</pre>
<pre class='cython line score-0'>&#xA0;056:     `alpha0`            The average energy transferred in a deactivating collision at the reference temperature</pre>
<pre class='cython line score-0'>&#xA0;057:     `T0`                The reference temperature</pre>
<pre class='cython line score-0'>&#xA0;058:     `n`                 The temperature exponent</pre>
<pre class='cython line score-0'>&#xA0;059:     =================== ========================================================</pre>
<pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-0'>&#xA0;061:     Based around the collisional energy transfer probability function</pre>
<pre class='cython line score-0'>&#xA0;062: </pre>
<pre class='cython line score-0'>&#xA0;063:     .. math:: P(E, E^\\prime) = C(E^\\prime) \\exp \\left( -\\frac{E^\\prime - E}{\\alpha} \\right) \\hspace{40pt} E &lt; E^\\prime</pre>
<pre class='cython line score-0'>&#xA0;064: </pre>
<pre class='cython line score-0'>&#xA0;065:     where the parameter :math:`\\alpha = \\left&lt; \\Delta E_\\mathrm{d} \\right&gt;`</pre>
<pre class='cython line score-0'>&#xA0;066:     represents the average energy transferred in a deactivating collision. This</pre>
<pre class='cython line score-0'>&#xA0;067:     is the most commonly-used collision model, simply because it only has one</pre>
<pre class='cython line score-0'>&#xA0;068:     parameter to determine. The parameter :math:`\\alpha` is specified using the</pre>
<pre class='cython line score-0'>&#xA0;069:     equation</pre>
<pre class='cython line score-0'>&#xA0;070: </pre>
<pre class='cython line score-0'>&#xA0;071:     .. math:: \\alpha = \\alpha_0 \\left( \\frac{T}{T_0} \\right)^n</pre>
<pre class='cython line score-0'>&#xA0;072: </pre>
<pre class='cython line score-0'>&#xA0;073:     where :math:`\\alpha_0` is the value of :math:`\\alpha` at temperature</pre>
<pre class='cython line score-0'>&#xA0;074:     :math:`T_0` in K. Set the exponent :math:`n` to zero to obtain a</pre>
<pre class='cython line score-0'>&#xA0;075:     temperature-independent value for :math:`\\alpha`.</pre>
<pre class='cython line score-0'>&#xA0;076:     """</pre>
<pre class='cython line score-0'>&#xA0;077: </pre>
<pre class='cython line score-37' onclick='toggleDiv(this)'>+078:     def __init__(self, alpha0=None, T0=None, n=0.0):</pre>
<pre class='cython code score-37'>/* Python wrapper */
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_alpha0 = 0;
  PyObject *__pyx_v_T0 = 0;
  PyObject *__pyx_v_n = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_alpha0,&amp;__pyx_n_s_T0,&amp;__pyx_n_s_n,0};
    PyObject* values[3] = {0,0,0};
    values[0] = ((PyObject *)Py_None);
    values[1] = ((PyObject *)Py_None);
    values[2] = ((PyObject *)__pyx_float_0_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha0);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T0);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_alpha0 = values[0];
    __pyx_v_T0 = values[1];
    __pyx_v_n = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown___init__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), __pyx_v_alpha0, __pyx_v_T0, __pyx_v_n);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown___init__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, PyObject *__pyx_v_alpha0, PyObject *__pyx_v_T0, PyObject *__pyx_v_n) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+079:         self.alpha0 = alpha0</pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_alpha0, __pyx_v_alpha0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+080:         self.T0 = T0</pre>
<pre class='cython code score-2'>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_T0, __pyx_v_T0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+081:         self.n = n</pre>
<pre class='cython code score-5'>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_n);<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;n = __pyx_t_1;
</pre><pre class='cython line score-0'>&#xA0;082: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+083:     def __repr__(self):</pre>
<pre class='cython code score-9'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_3__repr__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_21SingleExponentialDown_2__repr__[] = "\n        Return a string representation that can be used to reconstruct the\n        object.\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_5rmgpy_4pdep_9collision_21SingleExponentialDown_2__repr__;
#endif
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2__repr__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2__repr__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;084:         """</pre>
<pre class='cython line score-0'>&#xA0;085:         Return a string representation that can be used to reconstruct the</pre>
<pre class='cython line score-0'>&#xA0;086:         object.</pre>
<pre class='cython line score-0'>&#xA0;087:         """</pre>
<pre class='cython line score-35' onclick='toggleDiv(this)'>+088:         return 'SingleExponentialDown(alpha0={0!r}, T0={1!r}, n={2:g})'.format(self.alpha0, self.T0, self.n)</pre>
<pre class='cython code score-35'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_SingleExponentialDown_alpha0_0_r, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_alpha0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_T0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;n);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_6) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;089: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+090:     def __reduce__(self):</pre>
<pre class='cython code score-6'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_5__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_21SingleExponentialDown_4__reduce__[] = "SingleExponentialDown.__reduce__(self)\n\n        A helper function used when pickling an object.\n        ";
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_5__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_4__reduce__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_4__reduce__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;091:         """</pre>
<pre class='cython line score-0'>&#xA0;092:         A helper function used when pickling an object.</pre>
<pre class='cython line score-0'>&#xA0;093:         """</pre>
<pre class='cython line score-26' onclick='toggleDiv(this)'>+094:         return (SingleExponentialDown, (self.alpha0, self.T0, self.n))</pre>
<pre class='cython code score-26'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_alpha0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_T0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_4pdep_9collision_SingleExponentialDown)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_4pdep_9collision_SingleExponentialDown)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)((PyObject*)__pyx_ptype_5rmgpy_4pdep_9collision_SingleExponentialDown)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;095: </pre>
<pre class='cython line score-0'>&#xA0;096:     property alpha0:</pre>
<pre class='cython line score-0'>&#xA0;097:         """The average energy transferred in a deactivating collision at the reference temperature."""</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+098:         def __get__(self):</pre>
<pre class='cython code score-0'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0___get__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0___get__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+099:             return self._alpha0</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;_alpha0));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;_alpha0);
  goto __pyx_L0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+100:         def __set__(self, value):</pre>
<pre class='cython code score-10'>/* Python wrapper */
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_2__set__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6alpha0_2__set__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.alpha0.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+101:             try:</pre>
<pre class='cython code score-0'>  {
    /*try:*/ {
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+102:                 self._alpha0 = quantity.Frequency(value)</pre>
<pre class='cython code score-32'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quantity);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_Frequency);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_value);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_alpha0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_alpha0));
      __pyx_v_self-&gt;_alpha0 = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+103:                 self._alpha0.value_si *= constants.h * constants.c * 100. * constants.Na</pre>
<pre class='cython code score-2'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;_alpha0));
      __pyx_t_8 = __pyx_v_self-&gt;_alpha0;
      __pyx_t_8-&gt;value_si = (__pyx_t_8-&gt;value_si * (((__pyx_v_5rmgpy_9constants_h * __pyx_v_5rmgpy_9constants_c) * 100.) * __pyx_v_5rmgpy_9constants_Na));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+104:                 self._alpha0.units = 'kJ/mol'</pre>
<pre class='cython code score-10'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_kJ_mol);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_kJ_mol);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_alpha0-&gt;__pyx_base.units);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;_alpha0-&gt;__pyx_base.units);
      __pyx_v_self-&gt;_alpha0-&gt;__pyx_base.units = __pyx_kp_s_kJ_mol;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L10_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
</pre><pre class='cython line score-15' onclick='toggleDiv(this)'>+105:             except quantity.QuantityError:</pre>
<pre class='cython code score-15'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quantity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_QuantityError);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_9) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.alpha0.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_6, &amp;__pyx_t_4, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+106:                 self._alpha0 = quantity.Energy(value)</pre>
<pre class='cython code score-39'>      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quantity);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_Energy);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        }
      }
      if (!__pyx_t_10) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); __pyx_t_10 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_v_value);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_alpha0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_alpha0));
      __pyx_v_self-&gt;_alpha0 = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L4_exception_handled;
    }
    goto __pyx_L5_except_error;
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    __pyx_L10_try_end:;
  }
</pre><pre class='cython line score-0'>&#xA0;107: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+108:             self._alpha0 = quantity.Energy(value)</pre>
<pre class='cython code score-32'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quantity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_Energy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_value);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_alpha0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_alpha0));
  __pyx_v_self-&gt;_alpha0 = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;109: </pre>
<pre class='cython line score-0'>&#xA0;110:     property T0:</pre>
<pre class='cython line score-0'>&#xA0;111:         """The reference temperature."""</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+112:         def __get__(self):</pre>
<pre class='cython code score-0'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0___get__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0___get__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+113:             return self._T0</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;_T0));
  __pyx_r = ((PyObject *)__pyx_v_self-&gt;_T0);
  goto __pyx_L0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+114:         def __set__(self, value):</pre>
<pre class='cython code score-6'>/* Python wrapper */
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_2__set__(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_2T0_2__set__(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.T0.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+115:             self._T0 = quantity.Temperature(value)</pre>
<pre class='cython code score-32'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quantity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Temperature);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_value);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5rmgpy_8quantity_ScalarQuantity))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_T0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_T0));
  __pyx_v_self-&gt;_T0 = ((struct __pyx_obj_5rmgpy_8quantity_ScalarQuantity *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;116: </pre>
<pre class='cython line score-64' onclick='toggleDiv(this)'>+117:     cpdef double getAlpha(self, double T) except -1000000000:</pre>
<pre class='cython code score-64'>static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_7getAlpha(PyObject *__pyx_v_self, PyObject *__pyx_arg_T); /*proto*/
static double __pyx_f_5rmgpy_4pdep_9collision_21SingleExponentialDown_getAlpha(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, double __pyx_v_T, int __pyx_skip_dispatch) {
  double __pyx_v_alpha0;
  double __pyx_v_T0;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getAlpha", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_getAlpha);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_7getAlpha)) {
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_7;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.getAlpha", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1000000000.0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_7getAlpha(PyObject *__pyx_v_self, PyObject *__pyx_arg_T); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_21SingleExponentialDown_6getAlpha[] = "SingleExponentialDown.getAlpha(self, double T) -&gt; double\n\n        Return the value of the :math:`\\alpha` parameter - the average energy\n        transferred in a deactivating collision - in J/mol at temperature `T`\n        in K.\n        ";
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_7getAlpha(PyObject *__pyx_v_self, PyObject *__pyx_arg_T) {
  double __pyx_v_T;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getAlpha (wrapper)", 0);
  assert(__pyx_arg_T); {
    __pyx_v_T = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_T);<span class='error_goto'> if (unlikely((__pyx_v_T == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.getAlpha", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6getAlpha(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), ((double)__pyx_v_T));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_6getAlpha(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, double __pyx_v_T) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("getAlpha", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_5rmgpy_4pdep_9collision_21SingleExponentialDown_getAlpha(__pyx_v_self, __pyx_v_T, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1000000000.0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.getAlpha", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;118:         """</pre>
<pre class='cython line score-0'>&#xA0;119:         Return the value of the :math:`\\alpha` parameter - the average energy</pre>
<pre class='cython line score-0'>&#xA0;120:         transferred in a deactivating collision - in J/mol at temperature `T`</pre>
<pre class='cython line score-0'>&#xA0;121:         in K.</pre>
<pre class='cython line score-0'>&#xA0;122:         """</pre>
<pre class='cython line score-0'>&#xA0;123:         cdef double alpha0, T0</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+124:         alpha0 = self._alpha0.value_si</pre>
<pre class='cython code score-0'>  __pyx_t_7 = __pyx_v_self-&gt;_alpha0-&gt;value_si;
  __pyx_v_alpha0 = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+125:         if self._T0 is None:</pre>
<pre class='cython code score-0'>  __pyx_t_8 = (((PyObject *)__pyx_v_self-&gt;_T0) == Py_None);
  __pyx_t_9 = (__pyx_t_8 != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+126:             return alpha0</pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_v_alpha0;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;127:         else:</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+128:             T0 = self._T0.value_si</pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_self-&gt;_T0-&gt;value_si;
    __pyx_v_T0 = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+129:             return alpha0 * (T / T0) ** self.n</pre>
<pre class='cython code score-0'>    __pyx_r = (__pyx_v_alpha0 * pow((__pyx_v_T / __pyx_v_T0), __pyx_v_self-&gt;n));
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;130: </pre>
<pre class='cython line score-0'>&#xA0;131:     @cython.boundscheck(False)</pre>
<pre class='cython line score-0'>&#xA0;132:     @cython.wraparound(False)</pre>
<pre class='cython line score-51' onclick='toggleDiv(this)'>+133:     def generateCollisionMatrix(self,</pre>
<pre class='cython code score-51'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_9generateCollisionMatrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_21SingleExponentialDown_8generateCollisionMatrix[] = "SingleExponentialDown.generateCollisionMatrix(self, double T, ndarray densStates, ndarray Elist, ndarray Jlist=None)\n\n        Generate and return the collision matrix\n        :math:`\\matrix{M}_\\mathrm{coll} / \\omega = \\matrix{P} - \\matrix{I}`\n        corresponding to this collision model for a given set of energies\n        `Elist` in J/mol, temperature `T` in K, and isomer density of states\n        `densStates`.\n        ";
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_9generateCollisionMatrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_T;
  PyArrayObject *__pyx_v_densStates = 0;
  PyArrayObject *__pyx_v_Elist = 0;
  PyArrayObject *__pyx_v_Jlist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateCollisionMatrix (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_T,&amp;__pyx_n_s_densStates,&amp;__pyx_n_s_Elist,&amp;__pyx_n_s_Jlist,0};
    PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_8generateCollisionMatrix(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, double __pyx_v_T, PyArrayObject *__pyx_v_densStates, PyArrayObject *__pyx_v_Elist, PyArrayObject *__pyx_v_Jlist) {
  double __pyx_v_alpha;
  double __pyx_v_beta;
  double __pyx_v_C;
  double __pyx_v_left;
  double __pyx_v_right;
  int __pyx_v_Ngrains;
  int __pyx_v_start;
  int __pyx_v_r;
  int __pyx_v_s;
  int __pyx_v_u;
  int __pyx_v_v;
  PyArrayObject *__pyx_v_rho = 0;
  PyArrayObject *__pyx_v_phi = 0;
  PyArrayObject *__pyx_v_P0 = 0;
  PyArrayObject *__pyx_v_P = 0;
  long __pyx_v_NJ;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Elist;
  __Pyx_Buffer __pyx_pybuffer_Elist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Jlist;
  __Pyx_Buffer __pyx_pybuffer_Jlist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_P;
  __Pyx_Buffer __pyx_pybuffer_P;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_P0;
  __Pyx_Buffer __pyx_pybuffer_P0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_densStates;
  __Pyx_Buffer __pyx_pybuffer_densStates;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rho;
  __Pyx_Buffer __pyx_pybuffer_rho;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("generateCollisionMatrix", 0);
  __pyx_pybuffer_rho.pybuffer.buf = NULL;
  __pyx_pybuffer_rho.refcount = 0;
  __pyx_pybuffernd_rho.data = NULL;
  __pyx_pybuffernd_rho.rcbuffer = &amp;__pyx_pybuffer_rho;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &amp;__pyx_pybuffer_phi;
  __pyx_pybuffer_P0.pybuffer.buf = NULL;
  __pyx_pybuffer_P0.refcount = 0;
  __pyx_pybuffernd_P0.data = NULL;
  __pyx_pybuffernd_P0.rcbuffer = &amp;__pyx_pybuffer_P0;
  __pyx_pybuffer_P.pybuffer.buf = NULL;
  __pyx_pybuffer_P.refcount = 0;
  __pyx_pybuffernd_P.data = NULL;
  __pyx_pybuffernd_P.rcbuffer = &amp;__pyx_pybuffer_P;
  __pyx_pybuffer_densStates.pybuffer.buf = NULL;
  __pyx_pybuffer_densStates.refcount = 0;
  __pyx_pybuffernd_densStates.data = NULL;
  __pyx_pybuffernd_densStates.rcbuffer = &amp;__pyx_pybuffer_densStates;
  __pyx_pybuffer_Elist.pybuffer.buf = NULL;
  __pyx_pybuffer_Elist.refcount = 0;
  __pyx_pybuffernd_Elist.data = NULL;
  __pyx_pybuffernd_Elist.rcbuffer = &amp;__pyx_pybuffer_Elist;
  __pyx_pybuffer_Jlist.pybuffer.buf = NULL;
  __pyx_pybuffer_Jlist.refcount = 0;
  __pyx_pybuffernd_Jlist.data = NULL;
  __pyx_pybuffernd_Jlist.rcbuffer = &amp;__pyx_pybuffer_Jlist;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_densStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_densStates.diminfo[0].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_densStates.diminfo[0].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_densStates.diminfo[1].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_densStates.diminfo[1].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Elist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Elist.diminfo[0].strides = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Elist.diminfo[0].shape = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Jlist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Jlist.diminfo[0].strides = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Jlist.diminfo[0].shape = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.generateCollisionMatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rho);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_phi);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_P0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_P);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;134:         double T,</pre>
<pre class='cython line score-0'>&#xA0;135:         numpy.ndarray[numpy.float64_t,ndim=2] densStates,</pre>
<pre class='cython line score-0'>&#xA0;136:         numpy.ndarray[numpy.float64_t,ndim=1] Elist,</pre>
<pre class='cython line score-57' onclick='toggleDiv(this)'>+137:         numpy.ndarray[numpy.int_t,ndim=1] Jlist=None):</pre>
<pre class='cython code score-57'>    values[3] = (PyObject *)((PyArrayObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_densStates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generateCollisionMatrix", 0, 3, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Elist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generateCollisionMatrix", 0, 3, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Jlist);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generateCollisionMatrix") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_T = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_T == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_densStates = ((PyArrayObject *)values[1]);
    __pyx_v_Elist = ((PyArrayObject *)values[2]);
    __pyx_v_Jlist = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generateCollisionMatrix", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.generateCollisionMatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_densStates), __pyx_ptype_5numpy_ndarray, 1, "densStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Elist), __pyx_ptype_5numpy_ndarray, 1, "Elist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Jlist), __pyx_ptype_5numpy_ndarray, 1, "Jlist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_8generateCollisionMatrix(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), __pyx_v_T, __pyx_v_densStates, __pyx_v_Elist, __pyx_v_Jlist);
</pre><pre class='cython line score-0'>&#xA0;138:         """</pre>
<pre class='cython line score-0'>&#xA0;139:         Generate and return the collision matrix</pre>
<pre class='cython line score-0'>&#xA0;140:         :math:`\\matrix{M}_\\mathrm{coll} / \\omega = \\matrix{P} - \\matrix{I}`</pre>
<pre class='cython line score-0'>&#xA0;141:         corresponding to this collision model for a given set of energies</pre>
<pre class='cython line score-0'>&#xA0;142:         `Elist` in J/mol, temperature `T` in K, and isomer density of states</pre>
<pre class='cython line score-0'>&#xA0;143:         `densStates`.</pre>
<pre class='cython line score-0'>&#xA0;144:         """</pre>
<pre class='cython line score-0'>&#xA0;145: </pre>
<pre class='cython line score-0'>&#xA0;146:         cdef double alpha, beta</pre>
<pre class='cython line score-0'>&#xA0;147:         cdef double C, left, right</pre>
<pre class='cython line score-0'>&#xA0;148:         cdef int Ngrains, start, i, r, s, u, v</pre>
<pre class='cython line score-0'>&#xA0;149:         cdef numpy.ndarray[numpy.float64_t,ndim=1] rho</pre>
<pre class='cython line score-0'>&#xA0;150:         cdef numpy.ndarray[numpy.float64_t,ndim=2] phi, P0</pre>
<pre class='cython line score-0'>&#xA0;151:         cdef numpy.ndarray[numpy.float64_t,ndim=4] P</pre>
<pre class='cython line score-0'>&#xA0;152: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+153:         Ngrains = Elist.shape[0]</pre>
<pre class='cython code score-0'>  __pyx_v_Ngrains = (__pyx_v_Elist-&gt;dimensions[0]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+154:         NJ = Jlist.shape[0] if Jlist is not None else 1</pre>
<pre class='cython code score-0'>  __pyx_t_2 = (((PyObject *)__pyx_v_Jlist) != Py_None);
  if ((__pyx_t_2 != 0)) {
    __pyx_t_1 = (__pyx_v_Jlist-&gt;dimensions[0]);
  } else {
    __pyx_t_1 = 1;
  }
  __pyx_v_NJ = __pyx_t_1;
</pre><pre class='cython line score-69' onclick='toggleDiv(this)'>+155:         P = numpy.zeros((Ngrains,NJ,Ngrains,NJ), numpy.float64)</pre>
<pre class='cython code score-69'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_NJ);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_NJ);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_4 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_8) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_10, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_10, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  __pyx_t_9 = 0;
  __pyx_t_7 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 4, 0, __pyx_stack);
    if (unlikely(__pyx_t_12 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_P.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_P, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 4, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
      }
    }
    __pyx_pybuffernd_P.diminfo[0].strides = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_P.diminfo[0].shape = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_P.diminfo[1].strides = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_P.diminfo[1].shape = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_P.diminfo[2].strides = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_P.diminfo[2].shape = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_P.diminfo[3].strides = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_P.diminfo[3].shape = __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.shape[3];
    if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_P = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-63' onclick='toggleDiv(this)'>+156:         P0 = numpy.zeros((Ngrains,Ngrains), numpy.float64)</pre>
<pre class='cython code score-63'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  __pyx_t_5 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_7) {
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
  }
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_10, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_10, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_9 = 0;
  __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_12 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_P0, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
      }
    }
    __pyx_pybuffernd_P0.diminfo[0].strides = __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_P0.diminfo[0].shape = __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_P0.diminfo[1].strides = __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_P0.diminfo[1].shape = __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_16 = 0;
  __pyx_v_P0 = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-0'>&#xA0;157: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+158:         alpha = 1.0 / self.getAlpha(T)</pre>
<pre class='cython code score-0'>  __pyx_t_17 = ((struct __pyx_vtabstruct_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self-&gt;__pyx_vtab)-&gt;getAlpha(__pyx_v_self, __pyx_v_T, 0);<span class='error_goto'> if (unlikely(__pyx_t_17 == -1000000000.0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_alpha = (1.0 / __pyx_t_17);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+159:         beta = 1.0 / (constants.R * T)</pre>
<pre class='cython code score-0'>  __pyx_v_beta = (1.0 / (__pyx_v_5rmgpy_9constants_R * __pyx_v_T));
</pre><pre class='cython line score-0'>&#xA0;160: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+161:         if NJ &gt; 1:</pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((__pyx_v_NJ &gt; 1) != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-51' onclick='toggleDiv(this)'>+162:             rho = numpy.zeros(Ngrains)</pre>
<pre class='cython code score-51'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ngrains);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_18 = ((PyArrayObject *)__pyx_t_3);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_18, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_rho, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
        }
      }
      __pyx_pybuffernd_rho.diminfo[0].strides = __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rho.diminfo[0].shape = __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_18 = 0;
    __pyx_v_rho = ((PyArrayObject *)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+163:             for r in range(Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_Ngrains;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_12; __pyx_t_19+=1) {
      __pyx_v_r = __pyx_t_19;
</pre><pre class='cython line score-74' onclick='toggleDiv(this)'>+164:                 rho[r] = numpy.sum((2*Jlist+1) * densStates[r,:])</pre>
<pre class='cython code score-74'>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, ((PyObject *)__pyx_v_Jlist));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_densStates), __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_8 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else {
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_20 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_20 == (npy_float64)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_21 = __pyx_v_r;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_rho.diminfo[0].strides) = __pyx_t_20;
    }
    goto __pyx_L3;
  }
  /*else*/ {
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
</pre><pre class='cython line score-0'>&#xA0;165:         else:</pre>
<pre class='cython line score-35' onclick='toggleDiv(this)'>+166:             rho = densStates[:,0]</pre>
<pre class='cython code score-35'>  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
/* … */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_densStates), __pyx_tuple__3);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_18 = ((PyArrayObject *)__pyx_t_3);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_18, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_13);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_rho, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_15, __pyx_t_14, __pyx_t_13);
        }
      }
      __pyx_pybuffernd_rho.diminfo[0].strides = __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rho.diminfo[0].shape = __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_18 = 0;
    __pyx_v_rho = ((PyArrayObject *)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__2, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class='cython line score-0'>&#xA0;167: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+168:         for start in range(Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_12 = __pyx_v_Ngrains;
  for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_12; __pyx_t_19+=1) {
    __pyx_v_start = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+169:             if rho[start] &gt; 0:</pre>
<pre class='cython code score-0'>    __pyx_t_22 = __pyx_v_start;
    __pyx_t_2 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_rho.diminfo[0].strides)) &gt; 0.0) != 0);
    if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+170:                 break</pre>
<pre class='cython code score-0'>      goto __pyx_L7_break;
    }
  }
  __pyx_L7_break:;
</pre><pre class='cython line score-0'>&#xA0;171: </pre>
<pre class='cython line score-0'>&#xA0;172:         # Determine unnormalized entries in collisional transfer probability matrix</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+173:         for r in range(start, Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_12 = __pyx_v_Ngrains;
  for (__pyx_t_19 = __pyx_v_start; __pyx_t_19 &lt; __pyx_t_12; __pyx_t_19+=1) {
    __pyx_v_r = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+174:             for s in range(start,r+1):</pre>
<pre class='cython code score-0'>    __pyx_t_1 = (__pyx_v_r + 1);
    for (__pyx_t_23 = __pyx_v_start; __pyx_t_23 &lt; __pyx_t_1; __pyx_t_23+=1) {
      __pyx_v_s = __pyx_t_23;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+175:                 P0[s,r] = exp(-(Elist[r] - Elist[s]) * alpha)</pre>
<pre class='cython code score-0'>      __pyx_t_24 = __pyx_v_r;
      __pyx_t_25 = __pyx_v_s;
      __pyx_t_26 = __pyx_v_s;
      __pyx_t_27 = __pyx_v_r;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_P0.diminfo[1].strides) = exp(((-((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_Elist.diminfo[0].strides)))) * __pyx_v_alpha));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+176:             for s in range(r+1,Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_Ngrains;
    for (__pyx_t_28 = (__pyx_v_r + 1); __pyx_t_28 &lt; __pyx_t_23; __pyx_t_28+=1) {
      __pyx_v_s = __pyx_t_28;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+177:                 P0[s,r] = exp(-(Elist[s] - Elist[r]) * alpha) * rho[s] / rho[r] * exp(-(Elist[s] - Elist[r]) * beta)</pre>
<pre class='cython code score-0'>      __pyx_t_29 = __pyx_v_s;
      __pyx_t_30 = __pyx_v_r;
      __pyx_t_31 = __pyx_v_s;
      __pyx_t_32 = __pyx_v_r;
      __pyx_t_33 = __pyx_v_s;
      __pyx_t_34 = __pyx_v_r;
      __pyx_t_35 = __pyx_v_s;
      __pyx_t_36 = __pyx_v_r;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_P0.diminfo[1].strides) = (((exp(((-((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_Elist.diminfo[0].strides)))) * __pyx_v_alpha)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_rho.diminfo[0].strides))) / (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_rho.diminfo[0].strides))) * exp(((-((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_Elist.diminfo[0].strides)))) * __pyx_v_beta)));
    }
  }
</pre><pre class='cython line score-0'>&#xA0;178: </pre>
<pre class='cython line score-0'>&#xA0;179:         # Normalize using detailed balance</pre>
<pre class='cython line score-0'>&#xA0;180:         # This method is much more robust, and corresponds to:</pre>
<pre class='cython line score-0'>&#xA0;181:         #    [ 1 1 1 1 ...]</pre>
<pre class='cython line score-0'>&#xA0;182:         #    [ 1 2 2 2 ...]</pre>
<pre class='cython line score-0'>&#xA0;183:         #    [ 1 2 3 3 ...]</pre>
<pre class='cython line score-0'>&#xA0;184:         #    [ 1 2 3 4 ...]</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+185:         for r in range(start, Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_12 = __pyx_v_Ngrains;
  for (__pyx_t_19 = __pyx_v_start; __pyx_t_19 &lt; __pyx_t_12; __pyx_t_19+=1) {
    __pyx_v_r = __pyx_t_19;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+186:             left = 0.0; right = 0.0</pre>
<pre class='cython code score-0'>    __pyx_v_left = 0.0;
    __pyx_v_right = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+187:             for s in range(start, r): left += P0[s,r]</pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_r;
    for (__pyx_t_28 = __pyx_v_start; __pyx_t_28 &lt; __pyx_t_23; __pyx_t_28+=1) {
      __pyx_v_s = __pyx_t_28;
      __pyx_t_37 = __pyx_v_s;
      __pyx_t_38 = __pyx_v_r;
      __pyx_v_left = (__pyx_v_left + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_P0.diminfo[1].strides)));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+188:             for s in range(r, Ngrains): right += P0[s,r]</pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_Ngrains;
    for (__pyx_t_28 = __pyx_v_r; __pyx_t_28 &lt; __pyx_t_23; __pyx_t_28+=1) {
      __pyx_v_s = __pyx_t_28;
      __pyx_t_39 = __pyx_v_s;
      __pyx_t_40 = __pyx_v_r;
      __pyx_v_right = (__pyx_v_right + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_P0.diminfo[1].strides)));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+189:             C = (1 - left) / right</pre>
<pre class='cython code score-0'>    __pyx_v_C = ((1.0 - __pyx_v_left) / __pyx_v_right);
</pre><pre class='cython line score-0'>&#xA0;190:             # Check for normalization consistency (i.e. all numbers are positive)</pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+191:             if C &lt; 0: raise CollisionError('Encountered negative normalization coefficient while normalizing collisional transfer probabilities matrix.')</pre>
<pre class='cython code score-13'>    __pyx_t_2 = ((__pyx_v_C &lt; 0.0) != 0);
    if (__pyx_t_2) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_CollisionError);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Encountered_negative_normalizati);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+192:             for s in range(r+1,Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_Ngrains;
    for (__pyx_t_28 = (__pyx_v_r + 1); __pyx_t_28 &lt; __pyx_t_23; __pyx_t_28+=1) {
      __pyx_v_s = __pyx_t_28;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+193:                 P0[r,s] *= C</pre>
<pre class='cython code score-0'>      __pyx_t_41 = __pyx_v_r;
      __pyx_t_42 = __pyx_v_s;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_P0.diminfo[1].strides) *= __pyx_v_C;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+194:                 P0[s,r] *= C</pre>
<pre class='cython code score-0'>      __pyx_t_43 = __pyx_v_s;
      __pyx_t_44 = __pyx_v_r;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_44, __pyx_pybuffernd_P0.diminfo[1].strides) *= __pyx_v_C;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+195:             P0[r,r] = P0[r,r] * C - 1</pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_r;
    __pyx_t_28 = __pyx_v_r;
    __pyx_t_45 = __pyx_v_r;
    __pyx_t_46 = __pyx_v_r;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_P0.diminfo[1].strides) = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_P0.diminfo[1].strides)) * __pyx_v_C) - 1.0);
  }
</pre><pre class='cython line score-0'>&#xA0;196:         # This method is described by Pilling and Holbrook, and corresponds to:</pre>
<pre class='cython line score-0'>&#xA0;197:         #    [ ... 4 3 2 1 ]</pre>
<pre class='cython line score-0'>&#xA0;198:         #    [ ... 3 3 2 1 ]</pre>
<pre class='cython line score-0'>&#xA0;199:         #    [ ... 2 2 2 1 ]</pre>
<pre class='cython line score-0'>&#xA0;200:         #    [ ... 1 1 1 1 ]</pre>
<pre class='cython line score-0'>&#xA0;201:         #for r in range(Ngrains, start, -1):</pre>
<pre class='cython line score-0'>&#xA0;202:             #left = 0.0; right = 0.0</pre>
<pre class='cython line score-0'>&#xA0;203:             #for s in range(start, r): left += P0[s,r]</pre>
<pre class='cython line score-0'>&#xA0;204:             #for s in range(r, Ngrains): right += P0[s,r]</pre>
<pre class='cython line score-0'>&#xA0;205:             #C = (1 - right) / left</pre>
<pre class='cython line score-0'>&#xA0;206:             ## Check for normalization consistency (i.e. all numbers are positive)</pre>
<pre class='cython line score-0'>&#xA0;207:             #if C &lt; 0: raise CollisionError('Encountered negative normalization coefficient while normalizing collisional transfer probabilities matrix.')</pre>
<pre class='cython line score-0'>&#xA0;208:             #for s in range(r-1):</pre>
<pre class='cython line score-0'>&#xA0;209:                 #P0[r,s] *= C</pre>
<pre class='cython line score-0'>&#xA0;210:                 #P0[s,r] *= C</pre>
<pre class='cython line score-0'>&#xA0;211:             #P0[r,r] = P0[r,r] * C - 1</pre>
<pre class='cython line score-0'>&#xA0;212: </pre>
<pre class='cython line score-0'>&#xA0;213:         # If solving the 2D master equation, compute P(E,J,E',J') from P(E,E')</pre>
<pre class='cython line score-0'>&#xA0;214:         # by assuming that the J distribution after the collision is independent</pre>
<pre class='cython line score-0'>&#xA0;215:         # of that before the collision (the strong collision approximation in J)</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+216:         if NJ &gt; 1:</pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((__pyx_v_NJ &gt; 1) != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-49' onclick='toggleDiv(this)'>+217:             phi = numpy.zeros_like(densStates)</pre>
<pre class='cython code score-49'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, ((PyObject *)__pyx_v_densStates));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    } else {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_densStates));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_densStates));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_densStates));
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_16 = ((PyArrayObject *)__pyx_t_9);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_12 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_phi, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
        }
      }
      __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_phi.diminfo[1].strides = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_phi.diminfo[1].shape = __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_16 = 0;
    __pyx_v_phi = ((PyArrayObject *)__pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+218:             for s in range(NJ):</pre>
<pre class='cython code score-0'>    __pyx_t_1 = __pyx_v_NJ;
    for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_1; __pyx_t_12+=1) {
      __pyx_v_s = __pyx_t_12;
</pre><pre class='cython line score-52' onclick='toggleDiv(this)'>+219:                 phi[:,s] = (2*Jlist[s]+1) * densStates[:,s]</pre>
<pre class='cython code score-52'>      __pyx_t_19 = __pyx_v_s;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((2 * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Jlist.diminfo[0].strides))) + 1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_slice__5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_densStates), __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_slice__6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_phi), __pyx_t_9, __pyx_t_5) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  __pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+220:             for r in range(start, Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_Ngrains;
    for (__pyx_t_47 = __pyx_v_start; __pyx_t_47 &lt; __pyx_t_12; __pyx_t_47+=1) {
      __pyx_v_r = __pyx_t_47;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+221:                 phi[r,:] /= rho[r]</pre>
<pre class='cython code score-36'>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_phi), __pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_48 = __pyx_v_r;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rho.rcbuffer-&gt;pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_rho.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_phi), __pyx_t_9, __pyx_t_3) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
/* … */
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+222:             for r in range(start, Ngrains):</pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_Ngrains;
    for (__pyx_t_47 = __pyx_v_start; __pyx_t_47 &lt; __pyx_t_12; __pyx_t_47+=1) {
      __pyx_v_r = __pyx_t_47;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+223:                 for s in range(NJ):</pre>
<pre class='cython code score-0'>      __pyx_t_1 = __pyx_v_NJ;
      for (__pyx_t_49 = 0; __pyx_t_49 &lt; __pyx_t_1; __pyx_t_49+=1) {
        __pyx_v_s = __pyx_t_49;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+224:                     for u in range(start, Ngrains):</pre>
<pre class='cython code score-0'>        __pyx_t_50 = __pyx_v_Ngrains;
        for (__pyx_t_51 = __pyx_v_start; __pyx_t_51 &lt; __pyx_t_50; __pyx_t_51+=1) {
          __pyx_v_u = __pyx_t_51;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+225:                         for v in range(NJ):</pre>
<pre class='cython code score-0'>          __pyx_t_52 = __pyx_v_NJ;
          for (__pyx_t_53 = 0; __pyx_t_53 &lt; __pyx_t_52; __pyx_t_53+=1) {
            __pyx_v_v = __pyx_t_53;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+226:                             P[r,s,u,v] = P0[r,u] * phi[r,s]</pre>
<pre class='cython code score-0'>            __pyx_t_54 = __pyx_v_r;
            __pyx_t_55 = __pyx_v_u;
            __pyx_t_56 = __pyx_v_r;
            __pyx_t_57 = __pyx_v_s;
            __pyx_t_58 = __pyx_v_r;
            __pyx_t_59 = __pyx_v_s;
            __pyx_t_60 = __pyx_v_u;
            __pyx_t_61 = __pyx_v_v;
            *__Pyx_BufPtrStrided4d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P.rcbuffer-&gt;pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_P.diminfo[0].strides, __pyx_t_59, __pyx_pybuffernd_P.diminfo[1].strides, __pyx_t_60, __pyx_pybuffernd_P.diminfo[2].strides, __pyx_t_61, __pyx_pybuffernd_P.diminfo[3].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_P0.rcbuffer-&gt;pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_P0.diminfo[0].strides, __pyx_t_55, __pyx_pybuffernd_P0.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi.rcbuffer-&gt;pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_phi.diminfo[0].strides, __pyx_t_57, __pyx_pybuffernd_phi.diminfo[1].strides)));
          }
        }
      }
    }
    goto __pyx_L24;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;227:         else:</pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+228:             P[:,0,:,0] = P0</pre>
<pre class='cython code score-20'>  __pyx_slice__8 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
/* … */
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_P), __pyx_tuple__10, ((PyObject *)__pyx_v_P0)) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L24:;
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_slice__8, __pyx_int_0, __pyx_slice__9, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class='cython line score-0'>&#xA0;229: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+230:         return P</pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_P));
  __pyx_r = ((PyObject *)__pyx_v_P);
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;231: </pre>
<pre class='cython line score-119' onclick='toggleDiv(this)'>+232:     def calculateCollisionEfficiency(self,</pre>
<pre class='cython code score-119'>/* Python wrapper */
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_11calculateCollisionEfficiency(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_5rmgpy_4pdep_9collision_21SingleExponentialDown_10calculateCollisionEfficiency[] = "SingleExponentialDown.calculateCollisionEfficiency(self, double T, ndarray Elist, ndarray Jlist, ndarray densStates, double E0, double Ereac)\n\n        Calculate an efficiency factor for collisions, particularly useful for the\n        modified strong collision method. The collisions involve the given \n        `species` with density of states `densStates` corresponding to energies \n        Elist` in J/mol, ground-state energy `E0` in kJ/mol, and first \n        reactive energy `Ereac` in kJ/mol. The collisions occur at temperature `T` \n        in K and are described by the average energy transferred in a deactivating\n        collision `dEdown` in kJ/mol. The algorithm here is implemented as\n        described by Chang, Bozzelli, and Dean [Chang2000]_.\n    \n        .. [Chang2000] A. Y. Chang, J. W. Bozzelli, and A. M. Dean.\n           *Z. Phys. Chem.* **214**, p. 1533-1568 (2000).\n           `doi: 10.1524/zpch.2000.214.11.1533 &lt;http://dx.doi.org/10.1524/zpch.2000.214.11.1533&gt;`_\n    \n        ";
static PyObject *__pyx_pw_5rmgpy_4pdep_9collision_21SingleExponentialDown_11calculateCollisionEfficiency(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_T;
  PyArrayObject *__pyx_v_Elist = 0;
  PyArrayObject *__pyx_v_Jlist = 0;
  PyArrayObject *__pyx_v_densStates = 0;
  double __pyx_v_E0;
  double __pyx_v_Ereac;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculateCollisionEfficiency (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_T,&amp;__pyx_n_s_Elist,&amp;__pyx_n_s_Jlist,&amp;__pyx_n_s_densStates,&amp;__pyx_n_s_E0,&amp;__pyx_n_s_Ereac,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Elist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Jlist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_densStates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_E0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Ereac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calculateCollisionEfficiency") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_T = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_T == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Elist = ((PyArrayObject *)values[1]);
    __pyx_v_Jlist = ((PyArrayObject *)values[2]);
    __pyx_v_densStates = ((PyArrayObject *)values[3]);
    __pyx_v_E0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_E0 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Ereac = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]);<span class='error_goto'> if (unlikely((__pyx_v_Ereac == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculateCollisionEfficiency", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.calculateCollisionEfficiency", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Elist), __pyx_ptype_5numpy_ndarray, 1, "Elist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_Jlist), __pyx_ptype_5numpy_ndarray, 1, "Jlist", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_densStates), __pyx_ptype_5numpy_ndarray, 1, "densStates", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_10calculateCollisionEfficiency(((struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self), __pyx_v_T, __pyx_v_Elist, __pyx_v_Jlist, __pyx_v_densStates, __pyx_v_E0, __pyx_v_Ereac);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5rmgpy_4pdep_9collision_21SingleExponentialDown_10calculateCollisionEfficiency(struct __pyx_obj_5rmgpy_4pdep_9collision_SingleExponentialDown *__pyx_v_self, double __pyx_v_T, PyArrayObject *__pyx_v_Elist, PyArrayObject *__pyx_v_Jlist, PyArrayObject *__pyx_v_densStates, double __pyx_v_E0, double __pyx_v_Ereac) {
  double __pyx_v_dEdown;
  double __pyx_v_dE;
  double __pyx_v_FeNum;
  double __pyx_v_FeDen;
  double __pyx_v_Delta1;
  double __pyx_v_Delta2;
  double __pyx_v_DeltaN;
  double __pyx_v_Delta;
  double __pyx_v_value;
  double __pyx_v_beta;
  double __pyx_v_R;
  int __pyx_v_Ngrains;
  int __pyx_v_NJ;
  int __pyx_v_r;
  int __pyx_v_s;
  double __pyx_v_Fe;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Elist;
  __Pyx_Buffer __pyx_pybuffer_Elist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Jlist;
  __Pyx_Buffer __pyx_pybuffer_Jlist;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_densStates;
  __Pyx_Buffer __pyx_pybuffer_densStates;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculateCollisionEfficiency", 0);
  __pyx_pybuffer_Elist.pybuffer.buf = NULL;
  __pyx_pybuffer_Elist.refcount = 0;
  __pyx_pybuffernd_Elist.data = NULL;
  __pyx_pybuffernd_Elist.rcbuffer = &amp;__pyx_pybuffer_Elist;
  __pyx_pybuffer_Jlist.pybuffer.buf = NULL;
  __pyx_pybuffer_Jlist.refcount = 0;
  __pyx_pybuffernd_Jlist.data = NULL;
  __pyx_pybuffernd_Jlist.rcbuffer = &amp;__pyx_pybuffer_Jlist;
  __pyx_pybuffer_densStates.pybuffer.buf = NULL;
  __pyx_pybuffer_densStates.refcount = 0;
  __pyx_pybuffernd_densStates.data = NULL;
  __pyx_pybuffernd_densStates.rcbuffer = &amp;__pyx_pybuffer_densStates;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Elist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Elist.diminfo[0].strides = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Elist.diminfo[0].shape = __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Jlist, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_Jlist.diminfo[0].strides = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Jlist.diminfo[0].shape = __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_densStates, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_densStates.diminfo[0].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_densStates.diminfo[0].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_densStates.diminfo[1].strides = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_densStates.diminfo[1].shape = __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rmgpy.pdep.collision.SingleExponentialDown.calculateCollisionEfficiency", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;233:         double T,</pre>
<pre class='cython line score-0'>&#xA0;234:         numpy.ndarray[numpy.float64_t,ndim=1] Elist,</pre>
<pre class='cython line score-0'>&#xA0;235:         numpy.ndarray[numpy.int_t,ndim=1] Jlist,</pre>
<pre class='cython line score-0'>&#xA0;236:         numpy.ndarray[numpy.float64_t,ndim=2] densStates,</pre>
<pre class='cython line score-0'>&#xA0;237:         double E0, double Ereac):</pre>
<pre class='cython line score-0'>&#xA0;238:         """</pre>
<pre class='cython line score-0'>&#xA0;239:         Calculate an efficiency factor for collisions, particularly useful for the</pre>
<pre class='cython line score-0'>&#xA0;240:         modified strong collision method. The collisions involve the given</pre>
<pre class='cython line score-0'>&#xA0;241:         `species` with density of states `densStates` corresponding to energies</pre>
<pre class='cython line score-0'>&#xA0;242:         Elist` in J/mol, ground-state energy `E0` in kJ/mol, and first</pre>
<pre class='cython line score-0'>&#xA0;243:         reactive energy `Ereac` in kJ/mol. The collisions occur at temperature `T`</pre>
<pre class='cython line score-0'>&#xA0;244:         in K and are described by the average energy transferred in a deactivating</pre>
<pre class='cython line score-0'>&#xA0;245:         collision `dEdown` in kJ/mol. The algorithm here is implemented as</pre>
<pre class='cython line score-0'>&#xA0;246:         described by Chang, Bozzelli, and Dean [Chang2000]_.</pre>
<pre class='cython line score-0'>&#xA0;247: </pre>
<pre class='cython line score-0'>&#xA0;248:         .. [Chang2000] A. Y. Chang, J. W. Bozzelli, and A. M. Dean.</pre>
<pre class='cython line score-0'>&#xA0;249:            *Z. Phys. Chem.* **214**, p. 1533-1568 (2000).</pre>
<pre class='cython line score-0'>&#xA0;250:            `doi: 10.1524/zpch.2000.214.11.1533 &lt;http://dx.doi.org/10.1524/zpch.2000.214.11.1533&gt;`_</pre>
<pre class='cython line score-0'>&#xA0;251: </pre>
<pre class='cython line score-0'>&#xA0;252:         """</pre>
<pre class='cython line score-0'>&#xA0;253: </pre>
<pre class='cython line score-0'>&#xA0;254:         cdef double dEdown, dE, FeNum, FeDen, Delta1, Delta2, DeltaN, Delta, value, beta</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+255:         cdef double R = constants.R</pre>
<pre class='cython code score-0'>  __pyx_v_R = __pyx_v_5rmgpy_9constants_R;
</pre><pre class='cython line score-0'>&#xA0;256:         cdef int Ngrains, NJ, r</pre>
<pre class='cython line score-0'>&#xA0;257: </pre>
<pre class='cython line score-0'>&#xA0;258:         # Ensure that the barrier height is sufficiently above the ground state</pre>
<pre class='cython line score-0'>&#xA0;259:         # Otherwise invalid efficiencies are observed</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+260:         if Ereac - E0 &lt; 100:</pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_Ereac - __pyx_v_E0) &lt; 100.0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+261:             Ereac = E0 + 100</pre>
<pre class='cython code score-0'>    __pyx_v_Ereac = (__pyx_v_E0 + 100.0);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;262: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+263:         dEdown = self.getAlpha(T)</pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((struct __pyx_vtabstruct_5rmgpy_4pdep_9collision_SingleExponentialDown *)__pyx_v_self-&gt;__pyx_vtab)-&gt;getAlpha(__pyx_v_self, __pyx_v_T, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1000000000.0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dEdown = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;264: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+265:         Ngrains = len(Elist)</pre>
<pre class='cython code score-5'>  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_Elist));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_Ngrains = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+266:         NJ = 1 if Jlist is None else len(Jlist)</pre>
<pre class='cython code score-5'>  __pyx_t_1 = (((PyObject *)__pyx_v_Jlist) == Py_None);
  if ((__pyx_t_1 != 0)) {
    __pyx_t_3 = 1;
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_Jlist));<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = __pyx_t_4;
  }
  __pyx_v_NJ = __pyx_t_3;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+267:         dE = Elist[1] - Elist[0]</pre>
<pre class='cython code score-4'>  __pyx_t_5 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_pybuffernd_Elist.diminfo[0].shape;
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_7 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_pybuffernd_Elist.diminfo[0].shape;
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_dE = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_Elist.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_Elist.diminfo[0].strides)));
</pre><pre class='cython line score-0'>&#xA0;268: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+269:         FeNum = 0; FeDen = 0</pre>
<pre class='cython code score-0'>  __pyx_v_FeNum = 0.0;
  __pyx_v_FeDen = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+270:         Delta1 = 0; Delta2 = 0; DeltaN = 0; Delta = 1</pre>
<pre class='cython code score-0'>  __pyx_v_Delta1 = 0.0;
  __pyx_v_Delta2 = 0.0;
  __pyx_v_DeltaN = 0.0;
  __pyx_v_Delta = 1.0;
</pre><pre class='cython line score-0'>&#xA0;271: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+272:         for r in range(Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_Ngrains;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_6; __pyx_t_8+=1) {
    __pyx_v_r = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+273:             value = 0.0</pre>
<pre class='cython code score-0'>    __pyx_v_value = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+274:             for s in range(NJ):</pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_NJ;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_s = __pyx_t_10;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+275:                 value += densStates[r,s] * (2*Jlist[s]+1) * exp(-Elist[r] / (R * T))</pre>
<pre class='cython code score-6'>      __pyx_t_11 = __pyx_v_r;
      __pyx_t_12 = __pyx_v_s;
      __pyx_t_13 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_pybuffernd_densStates.diminfo[0].shape;
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_pybuffernd_densStates.diminfo[0].shape)) __pyx_t_13 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_pybuffernd_densStates.diminfo[1].shape;
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_pybuffernd_densStates.diminfo[1].shape)) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_13 = __pyx_v_s;
      __pyx_t_14 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_pybuffernd_Jlist.diminfo[0].shape;
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_pybuffernd_Jlist.diminfo[0].shape)) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_14 = __pyx_v_r;
      __pyx_t_15 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_pybuffernd_Elist.diminfo[0].shape;
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_15 = 0;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_value = (__pyx_v_value + (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_densStates.diminfo[1].strides)) * ((2 * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Jlist.diminfo[0].strides))) + 1)) * exp(((-(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Elist.diminfo[0].strides))) / (__pyx_v_R * __pyx_v_T)))));
    }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+276:             if Elist[r] &gt; Ereac:</pre>
<pre class='cython code score-2'>    __pyx_t_9 = __pyx_v_r;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_pybuffernd_Elist.diminfo[0].shape;
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_Elist.diminfo[0].strides)) &gt; __pyx_v_Ereac) != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+277:                 FeNum += value</pre>
<pre class='cython code score-0'>      __pyx_v_FeNum = (__pyx_v_FeNum + __pyx_v_value);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+278:                 if FeDen == 0:</pre>
<pre class='cython code score-0'>      __pyx_t_1 = ((__pyx_v_FeDen == 0.0) != 0);
      if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+279:                     FeDen = value * R * T / dE</pre>
<pre class='cython code score-0'>        __pyx_v_FeDen = (((__pyx_v_value * __pyx_v_R) * __pyx_v_T) / __pyx_v_dE);
        goto __pyx_L9;
      }
      __pyx_L9:;
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+280:         if FeDen == 0: return 1.0</pre>
<pre class='cython code score-2'>  __pyx_t_1 = ((__pyx_v_FeDen == 0.0) != 0);
  if (__pyx_t_1) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1_0);
    __pyx_r = __pyx_float_1_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+281:         Fe = FeNum / FeDen</pre>
<pre class='cython code score-0'>  __pyx_v_Fe = (__pyx_v_FeNum / __pyx_v_FeDen);
</pre><pre class='cython line score-0'>&#xA0;282: </pre>
<pre class='cython line score-0'>&#xA0;283:         # Chang, Bozzelli, and Dean recommend "freezing out" Fe at values greater</pre>
<pre class='cython line score-0'>&#xA0;284:         # than 1e6 to avoid issues of roundoff error</pre>
<pre class='cython line score-0'>&#xA0;285:         # They claim that the collision efficiency isn't too temperature-dependent</pre>
<pre class='cython line score-0'>&#xA0;286:         # in this regime, so it's an okay approximation to use</pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+287:         if Fe &gt; 1e6: Fe = 1e6</pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_Fe &gt; 1e6) != 0);
  if (__pyx_t_1) {
    __pyx_v_Fe = 1e6;
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;288: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+289:         for r in range(Ngrains):</pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_Ngrains;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_6; __pyx_t_8+=1) {
    __pyx_v_r = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+290:             value = 0.0</pre>
<pre class='cython code score-0'>    __pyx_v_value = 0.0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+291:             for s in range(NJ):</pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_NJ;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_10; __pyx_t_15+=1) {
      __pyx_v_s = __pyx_t_15;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+292:                 value += densStates[r,s] * (2*Jlist[s]+1) * exp(-Elist[r] / (R * T))</pre>
<pre class='cython code score-6'>      __pyx_t_16 = __pyx_v_r;
      __pyx_t_17 = __pyx_v_s;
      __pyx_t_18 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_pybuffernd_densStates.diminfo[0].shape;
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_18 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_densStates.diminfo[0].shape)) __pyx_t_18 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_pybuffernd_densStates.diminfo[1].shape;
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_18 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_densStates.diminfo[1].shape)) __pyx_t_18 = 1;
      if (unlikely(__pyx_t_18 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_18);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_18 = __pyx_v_s;
      __pyx_t_19 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_pybuffernd_Jlist.diminfo[0].shape;
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Jlist.diminfo[0].shape)) __pyx_t_19 = 0;
      if (unlikely(__pyx_t_19 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_19 = __pyx_v_r;
      __pyx_t_20 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_pybuffernd_Elist.diminfo[0].shape;
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_20 = 0;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_value = (__pyx_v_value + (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_densStates.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_densStates.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_densStates.diminfo[1].strides)) * ((2 * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_Jlist.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Jlist.diminfo[0].strides))) + 1)) * exp(((-(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Elist.diminfo[0].strides))) / (__pyx_v_R * __pyx_v_T)))));
    }
</pre><pre class='cython line score-0'>&#xA0;293:             # Delta</pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+294:             if Elist[r] &lt; Ereac:</pre>
<pre class='cython code score-2'>    __pyx_t_10 = __pyx_v_r;
    __pyx_t_15 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_pybuffernd_Elist.diminfo[0].shape;
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_15 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_15 = 0;
    if (unlikely(__pyx_t_15 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Elist.diminfo[0].strides)) &lt; __pyx_v_Ereac) != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+295:                 Delta1 += value</pre>
<pre class='cython code score-0'>      __pyx_v_Delta1 = (__pyx_v_Delta1 + __pyx_v_value);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+296:                 Delta2 += value * exp(-(Ereac - Elist[r]) / (Fe * R * T))</pre>
<pre class='cython code score-2'>      __pyx_t_15 = __pyx_v_r;
      __pyx_t_20 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_pybuffernd_Elist.diminfo[0].shape;
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Elist.diminfo[0].shape)) __pyx_t_20 = 0;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_Delta2 = (__pyx_v_Delta2 + (__pyx_v_value * exp(((-(__pyx_v_Ereac - (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Elist.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Elist.diminfo[0].strides)))) / ((__pyx_v_Fe * __pyx_v_R) * __pyx_v_T)))));
      goto __pyx_L16;
    }
    __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+297:             DeltaN += value</pre>
<pre class='cython code score-0'>    __pyx_v_DeltaN = (__pyx_v_DeltaN + __pyx_v_value);
  }
</pre><pre class='cython line score-0'>&#xA0;298: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+299:         Delta1 /= DeltaN</pre>
<pre class='cython code score-0'>  __pyx_v_Delta1 = (__pyx_v_Delta1 / __pyx_v_DeltaN);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+300:         Delta2 /= DeltaN</pre>
<pre class='cython code score-0'>  __pyx_v_Delta2 = (__pyx_v_Delta2 / __pyx_v_DeltaN);
</pre><pre class='cython line score-0'>&#xA0;301: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+302:         Delta = Delta1 - (Fe * R * T) / (dEdown + Fe * R * T) * Delta2</pre>
<pre class='cython code score-0'>  __pyx_v_Delta = (__pyx_v_Delta1 - ((((__pyx_v_Fe * __pyx_v_R) * __pyx_v_T) / (__pyx_v_dEdown + ((__pyx_v_Fe * __pyx_v_R) * __pyx_v_T))) * __pyx_v_Delta2));
</pre><pre class='cython line score-0'>&#xA0;303: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+304:         beta = (dEdown / (dEdown + Fe * R * T))**2 / Delta</pre>
<pre class='cython code score-0'>  __pyx_v_beta = (pow((__pyx_v_dEdown / (__pyx_v_dEdown + ((__pyx_v_Fe * __pyx_v_R) * __pyx_v_T))), 2.0) / __pyx_v_Delta);
</pre><pre class='cython line score-0'>&#xA0;305: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+306:         if beta &gt; 1:</pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_beta &gt; 1.0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-37' onclick='toggleDiv(this)'>+307:             print('Warning: Collision efficiency {0:.3f} calculated at {1:g} K is greater than unity, so it will be set to unity.'.format(beta, T))</pre>
<pre class='cython code score-37'>    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Warning_Collision_efficiency_0_3, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_24 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    __pyx_t_25 = NULL;
    __pyx_t_3 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_22))) {
      __pyx_t_25 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_22);
      if (likely(__pyx_t_25)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_22);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_25);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_22, function);
        __pyx_t_3 = 1;
      }
    }
    __pyx_t_26 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
    if (__pyx_t_25) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_26, 0, __pyx_t_25); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_25); __pyx_t_25 = NULL;
    }
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_26, 0+__pyx_t_3, __pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_26, 1+__pyx_t_3, __pyx_t_24);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24);
    __pyx_t_23 = 0;
    __pyx_t_24 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_22, __pyx_t_26, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_21) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+308:             beta = 1</pre>
<pre class='cython code score-0'>    __pyx_v_beta = 1.0;
    goto __pyx_L17;
  }
  __pyx_L17:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+309:         if beta &lt; 0:</pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_beta &lt; 0.0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-63' onclick='toggleDiv(this)'>+310:             raise CollisionError('Invalid collision efficiency {0:.3f} calculated at {1:g} K.'.format(beta, T))</pre>
<pre class='cython code score-63'>    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_CollisionError);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Invalid_collision_efficiency_0_3, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_25 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_T);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
    __pyx_t_27 = NULL;
    __pyx_t_3 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_24))) {
      __pyx_t_27 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_24);
      if (likely(__pyx_t_27)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_24);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_24, function);
        __pyx_t_3 = 1;
      }
    }
    __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
    if (__pyx_t_27) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_27); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_27); __pyx_t_27 = NULL;
    }
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0+__pyx_t_3, __pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 1+__pyx_t_3, __pyx_t_25);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_25);
    __pyx_t_23 = 0;
    __pyx_t_25 = 0;
    __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_24, __pyx_t_28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    __pyx_t_24 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_22))) {
      __pyx_t_24 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_22);
      if (likely(__pyx_t_24)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_22);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_24);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_22, function);
      }
    }
    if (!__pyx_t_24) {
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_22, __pyx_t_26);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    } else {
      __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_24); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24); __pyx_t_24 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0+1, __pyx_t_26);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26);
      __pyx_t_26 = 0;
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_22, __pyx_t_28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_21, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-0'>&#xA0;311: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+312:         return beta</pre>
<pre class='cython code score-6'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_r = __pyx_t_21;
  __pyx_t_21 = 0;
  goto __pyx_L0;
</pre></div></body></html>
